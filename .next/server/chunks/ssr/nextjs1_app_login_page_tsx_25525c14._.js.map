{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/login/page.tsx"],"sourcesContent":["'use client';\n\nimport { Suspense, useState } from 'react';\nimport { useSearchParams, useRouter } from 'next/navigation';\nimport { signIn } from 'next-auth/react';\n\nexport const dynamic = 'force-dynamic';\n\nfunction LoginForm() {\n  const searchParams = useSearchParams();\n  const router = useRouter();\n  const redirectTo = searchParams.get('redirectTo') || '/learn';\n  const [email, setEmail] = useState('user@nextmail.com');\n  const [password, setPassword] = useState('123456');\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  async function onSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    const res = await signIn('credentials', {\n      email,\n      password,\n      callbackUrl: redirectTo,\n      redirect: false,\n    });\n\n    if (res?.ok) {\n      // router.push(res.url ?? redirectTo);\n            // 登录成功后，跳转并强制刷新，确保服务端读取最新 Cookie/会话\n      router.replace(redirectTo);\n      router.refresh();\n    } else {\n      setError('账号或密码不正确，请检查邮箱和密码。');\n    }\n\n    setLoading(false);\n  }\n\n  return (\n    <form\n      onSubmit={onSubmit}\n      className=\"w-full max-w-sm rounded-lg border bg-white p-6 shadow\"\n    >\n      <h1 className=\"mb-4 text-xl font-semibold\">登录</h1>\n      <label className=\"mb-2 block text-sm text-gray-600\">邮箱</label>\n      <input\n        type=\"email\"\n        value={email}\n        onChange={(e) => setEmail(e.target.value)}\n        className=\"mb-4 w-full rounded border p-2\"\n        placeholder=\"you@example.com\"\n        required\n      />\n      <label className=\"mb-2 block text-sm text-gray-600\">密码</label>\n      <input\n        type=\"password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        className=\"mb-4 w-full rounded border p-2\"\n        placeholder=\"••••••\"\n        required\n      />\n      {error && <p className=\"mb-3 text-sm text-red-600\">{error}</p>}\n      <button\n        type=\"submit\"\n        className=\"w-full rounded bg-blue-600 p-2 text-white hover:bg-blue-700 disabled:opacity-50\"\n        disabled={loading}\n      >\n        {loading ? '登录中...' : '登录'}\n      </button>\n      <p className=\"mt-3 text-xs text-gray-500\">\n        默认账户：user@nextmail.com / 123456\n      </p>\n    </form>\n  );\n}\n\nexport default function LoginPage() {\n  return (\n    <div className=\"flex min-h-screen items-center justify-center bg-gray-50 p-6\">\n      <Suspense fallback={<div className=\"text-gray-500\">加载中...</div>}>\n        <LoginForm />\n      </Suspense>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAMO,MAAM,UAAU;AAEvB,SAAS;IACP,MAAM,eAAe,IAAA,gKAAe;IACpC,MAAM,SAAS,IAAA,0JAAS;IACxB,MAAM,aAAa,aAAa,GAAG,CAAC,iBAAiB;IACrD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,4NAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,4NAAQ,EAAC;IACzC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,4NAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,4NAAQ,EAAC;IAEvC,eAAe,SAAS,CAAkB;QACxC,EAAE,cAAc;QAChB,WAAW;QACX,SAAS;QAET,MAAM,MAAM,MAAM,IAAA,0JAAM,EAAC,eAAe;YACtC;YACA;YACA,aAAa;YACb,UAAU;QACZ;QAEA,IAAI,KAAK,IAAI;YACX,sCAAsC;YAChC,oCAAoC;YAC1C,OAAO,OAAO,CAAC;YACf,OAAO,OAAO;QAChB,OAAO;YACL,SAAS;QACX;QAEA,WAAW;IACb;IAEA,qBACE,yPAAC;QACC,UAAU;QACV,WAAU;;0BAEV,yPAAC;gBAAG,WAAU;0BAA6B;;;;;;0BAC3C,yPAAC;gBAAM,WAAU;0BAAmC;;;;;;0BACpD,yPAAC;gBACC,MAAK;gBACL,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gBACxC,WAAU;gBACV,aAAY;gBACZ,QAAQ;;;;;;0BAEV,yPAAC;gBAAM,WAAU;0BAAmC;;;;;;0BACpD,yPAAC;gBACC,MAAK;gBACL,OAAO;gBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;gBAC3C,WAAU;gBACV,aAAY;gBACZ,QAAQ;;;;;;YAET,uBAAS,yPAAC;gBAAE,WAAU;0BAA6B;;;;;;0BACpD,yPAAC;gBACC,MAAK;gBACL,WAAU;gBACV,UAAU;0BAET,UAAU,WAAW;;;;;;0BAExB,yPAAC;gBAAE,WAAU;0BAA6B;;;;;;;;;;;;AAKhD;AAEe,SAAS;IACtB,qBACE,yPAAC;QAAI,WAAU;kBACb,cAAA,yPAAC,4NAAQ;YAAC,wBAAU,yPAAC;gBAAI,WAAU;0BAAgB;;;;;;sBACjD,cAAA,yPAAC;;;;;;;;;;;;;;;AAIT","debugId":null}}]
}