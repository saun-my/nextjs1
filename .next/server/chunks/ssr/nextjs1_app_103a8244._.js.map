{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\nexport function formatDate(date: Date | string): string {\n  const d = new Date(date)\n  return d.toLocaleDateString('zh-CN', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  })\n}\n\nexport function formatDuration(minutes: number): string {\n  if (minutes < 60) return `${minutes}分钟`\n  const hours = Math.floor(minutes / 60)\n  const remainingMinutes = minutes % 60\n  return remainingMinutes > 0 ? `${hours}小时${remainingMinutes}分钟` : `${hours}小时`\n}\n\nexport function formatCurrency(\n  amount: number,\n  currency: string = 'USD',\n  locale: string = 'en-US'\n): string {\n  // amounts are stored in cents; convert to currency units\n  return new Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency,\n  }).format(amount / 100);\n}\n\nexport function generateYAxis<T extends { revenue: number }>(\n  revenueData: T[] | undefined | null\n): { yAxisLabels: string[]; topLabel: number } {\n  const hasData = Array.isArray(revenueData) && revenueData.length > 0;\n  const maxRevenue = hasData ? Math.max(...revenueData.map((r) => r.revenue)) : 0;\n\n  // Round up to a nice scale (nearest 1000)\n  const topLabel = maxRevenue > 0 ? Math.ceil(maxRevenue / 1000) * 1000 : 0;\n\n  // Build 5 evenly spaced labels from top → 0\n  const steps = 4;\n  const yAxisLabels: string[] = [];\n  for (let i = steps; i >= 0; i--) {\n    const value = topLabel > 0 ? Math.round((topLabel / steps) * i) : 0;\n    yAxisLabels.push(value.toLocaleString());\n  }\n\n  return { yAxisLabels, topLabel };\n}\n\nexport function formatDateToLocal(\n  date: Date | string,\n  locale: string = 'en-US'\n): string {\n  const d = new Date(date)\n  return new Intl.DateTimeFormat(locale, {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n  }).format(d)\n}\n\nexport function generatePagination(\n  currentPage: number,\n  totalPages: number\n): Array<number | string> {\n  const pages: Array<number | string> = []\n  const delta = 2\n  const start = Math.max(1, currentPage - delta)\n  const end = Math.min(totalPages, currentPage + delta)\n  const range: number[] = []\n\n  for (let i = start; i <= end; i++) range.push(i)\n\n  if (range[0] !== 1) {\n    pages.push(1)\n    if (range[0] > 2) pages.push('...')\n  }\n\n  pages.push(...range)\n\n  if (range[range.length - 1] !== totalPages) {\n    if (range[range.length - 1] < totalPages - 1) pages.push('...')\n    pages.push(totalPages)\n  }\n\n  return pages\n}\n\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): T {\n  let timeout: NodeJS.Timeout | null = null\n  return ((...args: Parameters<T>) => {\n    if (timeout) clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }) as T\n}\n\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number\n): T {\n  let inThrottle: boolean = false\n  return ((...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args)\n      inThrottle = true\n      setTimeout(() => inThrottle = false, limit)\n    }\n  }) as T\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,iLAAO,EAAC,IAAA,wJAAI,EAAC;AACtB;AAEO,SAAS,WAAW,IAAmB;IAC5C,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,EAAE,kBAAkB,CAAC,SAAS;QACnC,MAAM;QACN,OAAO;QACP,KAAK;IACP;AACF;AAEO,SAAS,eAAe,OAAe;IAC5C,IAAI,UAAU,IAAI,OAAO,GAAG,QAAQ,EAAE,CAAC;IACvC,MAAM,QAAQ,KAAK,KAAK,CAAC,UAAU;IACnC,MAAM,mBAAmB,UAAU;IACnC,OAAO,mBAAmB,IAAI,GAAG,MAAM,EAAE,EAAE,iBAAiB,EAAE,CAAC,GAAG,GAAG,MAAM,EAAE,CAAC;AAChF;AAEO,SAAS,eACd,MAAc,EACd,WAAmB,KAAK,EACxB,SAAiB,OAAO;IAExB,yDAAyD;IACzD,OAAO,IAAI,KAAK,YAAY,CAAC,QAAQ;QACnC,OAAO;QACP;IACF,GAAG,MAAM,CAAC,SAAS;AACrB;AAEO,SAAS,cACd,WAAmC;IAEnC,MAAM,UAAU,MAAM,OAAO,CAAC,gBAAgB,YAAY,MAAM,GAAG;IACnE,MAAM,aAAa,UAAU,KAAK,GAAG,IAAI,YAAY,GAAG,CAAC,CAAC,IAAM,EAAE,OAAO,KAAK;IAE9E,0CAA0C;IAC1C,MAAM,WAAW,aAAa,IAAI,KAAK,IAAI,CAAC,aAAa,QAAQ,OAAO;IAExE,4CAA4C;IAC5C,MAAM,QAAQ;IACd,MAAM,cAAwB,EAAE;IAChC,IAAK,IAAI,IAAI,OAAO,KAAK,GAAG,IAAK;QAC/B,MAAM,QAAQ,WAAW,IAAI,KAAK,KAAK,CAAC,AAAC,WAAW,QAAS,KAAK;QAClE,YAAY,IAAI,CAAC,MAAM,cAAc;IACvC;IAEA,OAAO;QAAE;QAAa;IAAS;AACjC;AAEO,SAAS,kBACd,IAAmB,EACnB,SAAiB,OAAO;IAExB,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,IAAI,KAAK,cAAc,CAAC,QAAQ;QACrC,MAAM;QACN,OAAO;QACP,KAAK;IACP,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,mBACd,WAAmB,EACnB,UAAkB;IAElB,MAAM,QAAgC,EAAE;IACxC,MAAM,QAAQ;IACd,MAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,cAAc;IACxC,MAAM,MAAM,KAAK,GAAG,CAAC,YAAY,cAAc;IAC/C,MAAM,QAAkB,EAAE;IAE1B,IAAK,IAAI,IAAI,OAAO,KAAK,KAAK,IAAK,MAAM,IAAI,CAAC;IAE9C,IAAI,KAAK,CAAC,EAAE,KAAK,GAAG;QAClB,MAAM,IAAI,CAAC;QACX,IAAI,KAAK,CAAC,EAAE,GAAG,GAAG,MAAM,IAAI,CAAC;IAC/B;IAEA,MAAM,IAAI,IAAI;IAEd,IAAI,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE,KAAK,YAAY;QAC1C,IAAI,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE,GAAG,aAAa,GAAG,MAAM,IAAI,CAAC;QACzD,MAAM,IAAI,CAAC;IACb;IAEA,OAAO;AACT;AAEO,SAAS,SACd,IAAO,EACP,IAAY;IAEZ,IAAI,UAAiC;IACrC,OAAQ,CAAC,GAAG;QACV,IAAI,SAAS,aAAa;QAC1B,UAAU,WAAW,IAAM,QAAQ,OAAO;IAC5C;AACF;AAEO,SAAS,SACd,IAAO,EACP,KAAa;IAEb,IAAI,aAAsB;IAC1B,OAAQ,CAAC,GAAG;QACV,IAAI,CAAC,YAAY;YACf,QAAQ;YACR,aAAa;YACb,WAAW,IAAM,aAAa,OAAO;QACvC;IACF;AACF","debugId":null}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartChartWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback } from 'react';\nimport { Line, Bar, Pie, Scatter, Radar } from 'react-chartjs-2';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  BarElement,\n  ArcElement,\n  Title,\n  Tooltip,\n  Legend,\n  Filler,\n  RadialLinearScale,\n  ChartOptions\n} from 'chart.js';\nimport { RefreshCw, Download, Settings, TrendingUp } from 'lucide-react';\nimport { DashboardWidget, ChartData } from '../lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  BarElement,\n  ArcElement,\n  Title,\n  Tooltip,\n  Legend,\n  Filler,\n  RadialLinearScale\n);\n\ninterface SmartChartWidgetProps {\n  widget: DashboardWidget;\n  data: ChartData;\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'png' | 'csv' | 'json') => void;\n  onSettings?: () => void;\n  className?: string;\n}\n\nexport function SmartChartWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  className\n}: SmartChartWidgetProps) {\n  const [showSettings, setShowSettings] = useState(false);\n  const [selectedDataset, setSelectedDataset] = useState(0);\n\n  const { config } = widget;\n  const chartType = config.chartType || 'line';\n\n  // 图表配置选项\n  const getChartOptions = useCallback(() => {\n    const baseOptions = {\n      responsive: config.responsive !== false,\n      maintainAspectRatio: false,\n      // 明确限制为 false | undefined，避免被推断为 boolean\n      animation: config.animation === false ? (false as false) : undefined,\n      plugins: {\n        legend: {\n          display: config.showLegend !== false,\n          position: 'top' as const,\n        },\n        title: {\n          display: false,\n        },\n        tooltip: {\n          enabled: true,\n          backgroundColor: 'rgba(0, 0, 0, 0.8)',\n          titleColor: '#fff',\n          bodyColor: '#fff',\n          borderColor: '#374151',\n          borderWidth: 1,\n          cornerRadius: 6,\n        }\n      },\n      scales: {\n        x: {\n          display: config.showGrid !== false,\n          grid: {\n            display: config.showGrid !== false,\n            color: '#E5E7EB'\n          }\n        },\n        y: {\n          display: config.showGrid !== false,\n          grid: {\n            display: config.showGrid !== false,\n            color: '#E5E7EB'\n          }\n        }\n      }\n    };\n\n    // 根据图表类型调整配置\n    switch (chartType) {\n      case 'pie': {\n        // 移除 scales 属性以匹配 Pie 的类型\n        const { scales, ...rest } = baseOptions;\n        return rest;\n      }\n      case 'radar':\n        return {\n          ...baseOptions,\n          scales: {\n            r: {\n              beginAtZero: true,\n              grid: {\n                color: '#E5E7EB'\n              }\n            }\n          }\n        };\n      default:\n        return baseOptions;\n    }\n  }, [chartType, config]);\n\n  // 渲染图表\n  const renderChart = useCallback(() => {\n    if (loading || error || !data) {\n      return null;\n    }\n\n    const effectiveData = chartType === 'area'\n      ? { ...data, datasets: data.datasets.map((ds) => ({ ...ds, fill: true })) }\n      : data;\n\n    const options = getChartOptions();\n\n    switch (chartType) {\n      case 'line':\n        return (\n          <Line\n            data={effectiveData}\n            options={options as ChartOptions<'line'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'bar':\n        return (\n          <Bar\n            data={effectiveData}\n            options={options as ChartOptions<'bar'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'pie':\n        return (\n          <Pie\n            data={effectiveData}\n            options={options as ChartOptions<'pie'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'area':\n        return (\n          <Line\n            data={effectiveData}\n            options={options as ChartOptions<'line'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'scatter':\n        return (\n          <Scatter\n            data={effectiveData}\n            options={options as ChartOptions<'scatter'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'radar':\n        return (\n          <Radar\n            data={effectiveData}\n            options={options as ChartOptions<'radar'>}\n            className=\"w-full h-full\"\n          />\n        );\n      default:\n        return (\n          <Line\n            data={effectiveData}\n            options={options as ChartOptions<'line'>}\n            className=\"w-full h-full\"\n          />\n        );\n    }\n  }, [chartType, data, loading, error, getChartOptions]);\n\n  // 导出功能\n  const handleExport = useCallback((format: 'png' | 'csv' | 'json') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    // 默认导出逻辑\n    switch (format) {\n      case 'csv':\n        const csvData = data.datasets.map((dataset, index) => ({\n          label: dataset.label,\n          data: dataset.data.join(',')\n        }));\n        const csvContent = \"data:text/csv;charset=utf-8,\" + \n          \"Label,Data\\n\" + \n          csvData.map(row => `\"${row.label}\",\"${row.data}\"`).join(\"\\n\");\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-data-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n      \n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-data-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'png':\n        // 这里需要实现图表截图功能\n        console.log('PNG export would be implemented with canvas');\n        break;\n    }\n  }, [data, onExport, widget.id]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n          </div>\n        </div>\n        <div className=\"h-64 bg-gray-100 rounded-lg animate-pulse\" />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n        </div>\n        <div className=\"h-64 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n          <div className=\"text-center\">\n            <div className=\"text-red-500 mb-2\">⚠️</div>\n            <p className=\"text-red-700 font-medium\">{error}</p>\n            <button\n              onClick={onRefresh}\n              className=\"mt-2 px-4 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700\"\n            >\n              重试\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n          {widget.description && (\n            <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n            title=\"刷新\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n          \n          <div className=\"relative\">\n            <button\n              onClick={() => setShowSettings(!showSettings)}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"设置\"\n            >\n              <Settings className=\"h-4 w-4\" />\n            </button>\n            \n            {showSettings && (\n              <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                <div className=\"py-1\">\n                  <button\n                    onClick={() => {\n                      handleExport('csv');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出CSV\n                  </button>\n                  <button\n                    onClick={() => {\n                      handleExport('json');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出JSON\n                  </button>\n                  {onSettings && (\n                    <button\n                      onClick={() => {\n                        onSettings();\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Settings className=\"h-4 w-4 inline mr-2\" />\n                      高级设置\n                    </button>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* 内容区域 */}\n      <div className=\"p-6\">\n        <div className=\"h-80\">\n          {renderChart()}\n        </div>\n        \n        {/* 数据摘要 */}\n        {data.datasets && data.datasets.length > 0 && (\n          <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <TrendingUp className=\"h-4 w-4 text-green-600\" />\n              <span className=\"text-sm font-medium text-gray-900\">数据摘要</span>\n            </div>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n              {data.datasets.map((dataset, index) => {\n                const total = dataset.data.reduce((sum, value) => sum + (typeof value === 'number' ? value : 0), 0);\n                const average = total / dataset.data.length;\n                return (\n                  <div key={index} className=\"text-center\">\n                    <div className=\"text-lg font-semibold text-gray-900\">\n                      {dataset.label}\n                    </div>\n                    <div className=\"text-xs text-gray-600\">\n                      总计: {total.toLocaleString()}\n                    </div>\n                    <div className=\"text-xs text-gray-600\">\n                      平均: {average.toFixed(1)}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default SmartChartWidget;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 788, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartMetricWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback } from 'react';\nimport { TrendingUp, TrendingDown, Minus, RefreshCw, Download, Settings } from 'lucide-react';\nimport { DashboardWidget } from '@/app/lib/dashboard/types';\nimport { MetricData } from '@/app/lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface SmartMetricWidgetProps {\n  widget: DashboardWidget;\n  data: MetricData;\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'json' | 'csv') => void;\n  onSettings?: () => void;\n  className?: string;\n}\n\nexport function SmartMetricWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  className\n}: SmartMetricWidgetProps) {\n  const [showSettings, setShowSettings] = useState(false);\n\n  const formatValue = useCallback((value: number, format?: string, unit?: string) => {\n    let formatted = value.toString();\n    \n    switch (format) {\n      case 'currency':\n        formatted = new Intl.NumberFormat('zh-CN', {\n          style: 'currency',\n          currency: 'CNY',\n          minimumFractionDigits: 0,\n          maximumFractionDigits: 0\n        }).format(value);\n        break;\n      \n      case 'percentage':\n        formatted = `${value.toFixed(1)}%`;\n        break;\n      \n      case 'duration':\n        if (value < 60) {\n          formatted = `${value}分钟`;\n        } else {\n          const hours = Math.floor(value / 60);\n          const minutes = value % 60;\n          formatted = minutes > 0 ? `${hours}小时${minutes}分钟` : `${hours}小时`;\n        }\n        break;\n      \n      default:\n        formatted = new Intl.NumberFormat('zh-CN').format(value);\n        break;\n    }\n    \n    return formatted;\n  }, []);\n\n  const getTrendIcon = useCallback((trend: 'up' | 'down' | 'stable') => {\n    switch (trend) {\n      case 'up':\n        return <TrendingUp className=\"h-4 w-4\" />;\n      case 'down':\n        return <TrendingDown className=\"h-4 w-4\" />;\n      case 'stable':\n        return <Minus className=\"h-4 w-4\" />;\n      default:\n        return null;\n    }\n  }, []);\n\n  const getTrendColor = useCallback((trend: 'up' | 'down' | 'stable') => {\n    switch (trend) {\n      case 'up':\n        return 'text-green-600';\n      case 'down':\n        return 'text-red-600';\n      case 'stable':\n        return 'text-gray-600';\n      default:\n        return 'text-gray-600';\n    }\n  }, []);\n\n  const getProgressPercentage = useCallback((current: number, target?: number) => {\n    if (!target) return 0;\n    return Math.min((current / target) * 100, 100);\n  }, []);\n\n  const handleExport = useCallback((format: 'json' | 'csv') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    const exportData = {\n      widgetId: widget.id,\n      metric: data,\n      timestamp: new Date()\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-metric-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'csv':\n        const csvContent = \"data:text/csv;charset=utf-8,\" + \n          \"Metric,Value,Change,Trend,Target,Timestamp\\n\" +\n          `\"${data.label}\",\"${data.value}\",\"${data.change || 0}\",\"${data.trend || 'stable'}\",\"${data.target || 'N/A'}\",\"${new Date().toISOString()}\"`;\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-metric-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n    }\n  }, [data, onExport, widget.id]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"animate-pulse\">\n            <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n          </div>\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n        </div>\n        <div className=\"h-12 bg-gray-200 rounded-lg animate-pulse mb-4\"></div>\n        <div className=\"h-2 bg-gray-200 rounded-full animate-pulse\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n        </div>\n        <div className=\"h-32 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n          <div className=\"text-center\">\n            <div className=\"text-red-500 mb-2\">⚠️</div>\n            <p className=\"text-red-700 font-medium text-sm\">{error}</p>\n            <button\n              onClick={onRefresh}\n              className=\"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"\n            >\n              重试\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n          {widget.description && (\n            <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n            title=\"刷新\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n          \n          <div className=\"relative\">\n            <button\n              onClick={() => setShowSettings(!showSettings)}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"设置\"\n            >\n              <Settings className=\"h-4 w-4\" />\n            </button>\n            \n            {showSettings && (\n              <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                <div className=\"py-1\">\n                  <button\n                    onClick={() => {\n                      handleExport('csv');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出CSV\n                  </button>\n                  <button\n                    onClick={() => {\n                      handleExport('json');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出JSON\n                  </button>\n                  {onSettings && (\n                    <button\n                      onClick={() => {\n                        onSettings();\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Settings className=\"h-4 w-4 inline mr-2\" />\n                      高级设置\n                    </button>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* 内容区域 */}\n      <div className=\"p-6\">\n        <div className=\"space-y-4\">\n          {/* 主要指标 */}\n          <div className=\"text-center\">\n            <div className=\"text-3xl font-bold text-gray-900 mb-2\">\n              {formatValue(data.value, data.format, data.unit)}\n            </div>\n            <div className=\"text-sm text-gray-600\">{data.label}</div>\n          </div>\n\n          {/* 趋势信息 */}\n          {data.change !== undefined && data.trend && (\n            <div className=\"flex items-center justify-center gap-2\">\n              <div className={cn(\"flex items-center gap-1\", getTrendColor(data.trend))}>\n                {getTrendIcon(data.trend)}\n                <span className=\"text-sm font-medium\">\n                  {data.change > 0 ? '+' : ''}{data.change.toFixed(1)}%\n                </span>\n              </div>\n              <span className=\"text-xs text-gray-500\">vs 上期</span>\n            </div>\n          )}\n\n          {/* 进度条（如果有目标）*/}\n          {data.target && (\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-600\">进度</span>\n                <span className=\"text-gray-900 font-medium\">\n                  {getProgressPercentage(data.value, data.target).toFixed(0)}%\n                </span>\n              </div>\n              <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                <div \n                  className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                  style={{ width: `${getProgressPercentage(data.value, data.target)}%` }}\n                />\n              </div>\n              <div className=\"flex justify-between text-xs text-gray-500\">\n                <span>当前</span>\n                <span>目标: {formatValue(data.target, data.format, data.unit)}</span>\n              </div>\n            </div>\n          )}\n\n          {/* 额外信息 */}\n          <div className=\"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200\">\n            <div className=\"text-center\">\n              <div className=\"text-sm text-gray-600\">状态</div>\n              <div className={cn(\"text-sm font-medium\", getTrendColor(data.trend || 'stable'))}>\n                {data.trend === 'up' ? '上升' : data.trend === 'down' ? '下降' : '稳定'}\n              </div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-sm text-gray-600\">更新时间</div>\n              <div className=\"text-sm font-medium text-gray-900\">\n                {new Date().toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function SmartMetricSkeleton() {\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n          <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n        </div>\n        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n      </div>\n      <div className=\"h-12 bg-gray-200 rounded-lg animate-pulse mb-4\"></div>\n      <div className=\"h-2 bg-gray-200 rounded-full animate-pulse\"></div>\n    </div>\n  );\n}\n\nexport default SmartMetricWidget;"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AANA;;;;;AAmBO,SAAS,kBAAkB,EAChC,MAAM,EACN,IAAI,EACJ,UAAU,KAAK,EACf,QAAQ,IAAI,EACZ,SAAS,EACT,QAAQ,EACR,UAAU,EACV,SAAS,EACc;IACvB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,4NAAQ,EAAC;IAEjD,MAAM,cAAc,IAAA,+NAAW,EAAC,CAAC,OAAe,QAAiB;QAC/D,IAAI,YAAY,MAAM,QAAQ;QAE9B,OAAQ;YACN,KAAK;gBACH,YAAY,IAAI,KAAK,YAAY,CAAC,SAAS;oBACzC,OAAO;oBACP,UAAU;oBACV,uBAAuB;oBACvB,uBAAuB;gBACzB,GAAG,MAAM,CAAC;gBACV;YAEF,KAAK;gBACH,YAAY,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC;gBAClC;YAEF,KAAK;gBACH,IAAI,QAAQ,IAAI;oBACd,YAAY,GAAG,MAAM,EAAE,CAAC;gBAC1B,OAAO;oBACL,MAAM,QAAQ,KAAK,KAAK,CAAC,QAAQ;oBACjC,MAAM,UAAU,QAAQ;oBACxB,YAAY,UAAU,IAAI,GAAG,MAAM,EAAE,EAAE,QAAQ,EAAE,CAAC,GAAG,GAAG,MAAM,EAAE,CAAC;gBACnE;gBACA;YAEF;gBACE,YAAY,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;gBAClD;QACJ;QAEA,OAAO;IACT,GAAG,EAAE;IAEL,MAAM,eAAe,IAAA,+NAAW,EAAC,CAAC;QAChC,OAAQ;YACN,KAAK;gBACH,qBAAO,yPAAC,2OAAU;oBAAC,WAAU;;;;;;YAC/B,KAAK;gBACH,qBAAO,yPAAC,iPAAY;oBAAC,WAAU;;;;;;YACjC,KAAK;gBACH,qBAAO,yPAAC,wNAAK;oBAAC,WAAU;;;;;;YAC1B;gBACE,OAAO;QACX;IACF,GAAG,EAAE;IAEL,MAAM,gBAAgB,IAAA,+NAAW,EAAC,CAAC;QACjC,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF,GAAG,EAAE;IAEL,MAAM,wBAAwB,IAAA,+NAAW,EAAC,CAAC,SAAiB;QAC1D,IAAI,CAAC,QAAQ,OAAO;QACpB,OAAO,KAAK,GAAG,CAAC,AAAC,UAAU,SAAU,KAAK;IAC5C,GAAG,EAAE;IAEL,MAAM,eAAe,IAAA,+NAAW,EAAC,CAAC;QAChC,IAAI,UAAU;YACZ,SAAS;YACT;QACF;QAEA,MAAM,aAAa;YACjB,UAAU,OAAO,EAAE;YACnB,QAAQ;YACR,WAAW,IAAI;QACjB;QAEA,OAAQ;YACN,KAAK;gBACH,MAAM,WAAW,IAAI,KAAK;oBAAC,KAAK,SAAS,CAAC,YAAY,MAAM;iBAAG,EAAE;oBAAE,MAAM;gBAAmB;gBAC5F,MAAM,UAAU,IAAI,eAAe,CAAC;gBACpC,MAAM,WAAW,SAAS,aAAa,CAAC;gBACxC,SAAS,IAAI,GAAG;gBAChB,SAAS,QAAQ,GAAG,GAAG,OAAO,EAAE,CAAC,QAAQ,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC;gBAC1E,SAAS,KAAK;gBACd;YAEF,KAAK;gBACH,MAAM,aAAa,iCACjB,iDACA,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,KAAK,MAAM,IAAI,EAAE,GAAG,EAAE,KAAK,KAAK,IAAI,SAAS,GAAG,EAAE,KAAK,MAAM,IAAI,MAAM,GAAG,EAAE,IAAI,OAAO,WAAW,GAAG,CAAC,CAAC;gBAC7I,MAAM,UAAU,SAAS,aAAa,CAAC;gBACvC,QAAQ,IAAI,GAAG,UAAU;gBACzB,QAAQ,QAAQ,GAAG,GAAG,OAAO,EAAE,CAAC,QAAQ,EAAE,IAAI,OAAO,WAAW,GAAG,IAAI,CAAC;gBACxE,QAAQ,KAAK;gBACb;QACJ;IACF,GAAG;QAAC;QAAM;QAAU,OAAO,EAAE;KAAC;IAE9B,IAAI,SAAS;QACX,qBACE,yPAAC;YAAI,WAAW,IAAA,oIAAE,EAAC,4DAA4D;;8BAC7E,yPAAC;oBAAI,WAAU;;sCACb,yPAAC;4BAAI,WAAU;;8CACb,yPAAC;oCAAI,WAAU;;;;;;8CACf,yPAAC;oCAAI,WAAU;;;;;;;;;;;;sCAEjB,yPAAC;4BAAI,WAAU;;;;;;;;;;;;8BAEjB,yPAAC;oBAAI,WAAU;;;;;;8BACf,yPAAC;oBAAI,WAAU;;;;;;;;;;;;IAGrB;IAEA,IAAI,OAAO;QACT,qBACE,yPAAC;YAAI,WAAW,IAAA,oIAAE,EAAC,4DAA4D;;8BAC7E,yPAAC;oBAAI,WAAU;;sCACb,yPAAC;;8CACC,yPAAC;oCAAG,WAAU;8CAAuC,OAAO,KAAK;;;;;;gCAChE,OAAO,WAAW,kBACjB,yPAAC;oCAAE,WAAU;8CAA8B,OAAO,WAAW;;;;;;;;;;;;sCAGjE,yPAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,yPAAC,wOAAS;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAGzB,yPAAC;oBAAI,WAAU;8BACb,cAAA,yPAAC;wBAAI,WAAU;;0CACb,yPAAC;gCAAI,WAAU;0CAAoB;;;;;;0CACnC,yPAAC;gCAAE,WAAU;0CAAoC;;;;;;0CACjD,yPAAC;gCACC,SAAS;gCACT,WAAU;0CACX;;;;;;;;;;;;;;;;;;;;;;;IAOX;IAEA,qBACE,yPAAC;QAAI,WAAW,IAAA,oIAAE,EAAC,wDAAwD;;0BAEzE,yPAAC;gBAAI,WAAU;;kCACb,yPAAC;;0CACC,yPAAC;gCAAG,WAAU;0CAAuC,OAAO,KAAK;;;;;;4BAChE,OAAO,WAAW,kBACjB,yPAAC;gCAAE,WAAU;0CAA8B,OAAO,WAAW;;;;;;;;;;;;kCAGjE,yPAAC;wBAAI,WAAU;;0CACb,yPAAC;gCACC,SAAS;gCACT,WAAU;gCACV,OAAM;0CAEN,cAAA,yPAAC,wOAAS;oCAAC,WAAU;;;;;;;;;;;0CAGvB,yPAAC;gCAAI,WAAU;;kDACb,yPAAC;wCACC,SAAS,IAAM,gBAAgB,CAAC;wCAChC,WAAU;wCACV,OAAM;kDAEN,cAAA,yPAAC,iOAAQ;4CAAC,WAAU;;;;;;;;;;;oCAGrB,8BACC,yPAAC;wCAAI,WAAU;kDACb,cAAA,yPAAC;4CAAI,WAAU;;8DACb,yPAAC;oDACC,SAAS;wDACP,aAAa;wDACb,gBAAgB;oDAClB;oDACA,WAAU;;sEAEV,yPAAC,iOAAQ;4DAAC,WAAU;;;;;;wDAAwB;;;;;;;8DAG9C,yPAAC;oDACC,SAAS;wDACP,aAAa;wDACb,gBAAgB;oDAClB;oDACA,WAAU;;sEAEV,yPAAC,iOAAQ;4DAAC,WAAU;;;;;;wDAAwB;;;;;;;gDAG7C,4BACC,yPAAC;oDACC,SAAS;wDACP;wDACA,gBAAgB;oDAClB;oDACA,WAAU;;sEAEV,yPAAC,iOAAQ;4DAAC,WAAU;;;;;;wDAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAY5D,yPAAC;gBAAI,WAAU;0BACb,cAAA,yPAAC;oBAAI,WAAU;;sCAEb,yPAAC;4BAAI,WAAU;;8CACb,yPAAC;oCAAI,WAAU;8CACZ,YAAY,KAAK,KAAK,EAAE,KAAK,MAAM,EAAE,KAAK,IAAI;;;;;;8CAEjD,yPAAC;oCAAI,WAAU;8CAAyB,KAAK,KAAK;;;;;;;;;;;;wBAInD,KAAK,MAAM,KAAK,aAAa,KAAK,KAAK,kBACtC,yPAAC;4BAAI,WAAU;;8CACb,yPAAC;oCAAI,WAAW,IAAA,oIAAE,EAAC,2BAA2B,cAAc,KAAK,KAAK;;wCACnE,aAAa,KAAK,KAAK;sDACxB,yPAAC;4CAAK,WAAU;;gDACb,KAAK,MAAM,GAAG,IAAI,MAAM;gDAAI,KAAK,MAAM,CAAC,OAAO,CAAC;gDAAG;;;;;;;;;;;;;8CAGxD,yPAAC;oCAAK,WAAU;8CAAwB;;;;;;;;;;;;wBAK3C,KAAK,MAAM,kBACV,yPAAC;4BAAI,WAAU;;8CACb,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;4CAAK,WAAU;sDAAgB;;;;;;sDAChC,yPAAC;4CAAK,WAAU;;gDACb,sBAAsB,KAAK,KAAK,EAAE,KAAK,MAAM,EAAE,OAAO,CAAC;gDAAG;;;;;;;;;;;;;8CAG/D,yPAAC;oCAAI,WAAU;8CACb,cAAA,yPAAC;wCACC,WAAU;wCACV,OAAO;4CAAE,OAAO,GAAG,sBAAsB,KAAK,KAAK,EAAE,KAAK,MAAM,EAAE,CAAC,CAAC;wCAAC;;;;;;;;;;;8CAGzE,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;sDAAK;;;;;;sDACN,yPAAC;;gDAAK;gDAAK,YAAY,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,IAAI;;;;;;;;;;;;;;;;;;;sCAMhE,yPAAC;4BAAI,WAAU;;8CACb,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;4CAAI,WAAU;sDAAwB;;;;;;sDACvC,yPAAC;4CAAI,WAAW,IAAA,oIAAE,EAAC,uBAAuB,cAAc,KAAK,KAAK,IAAI;sDACnE,KAAK,KAAK,KAAK,OAAO,OAAO,KAAK,KAAK,KAAK,SAAS,OAAO;;;;;;;;;;;;8CAGjE,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;4CAAI,WAAU;sDAAwB;;;;;;sDACvC,yPAAC;4CAAI,WAAU;sDACZ,IAAI,OAAO,kBAAkB,CAAC,SAAS;gDAAE,MAAM;gDAAW,QAAQ;4CAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ7F;AAEO,SAAS;IACd,qBACE,yPAAC;QAAI,WAAU;;0BACb,yPAAC;gBAAI,WAAU;;kCACb,yPAAC;wBAAI,WAAU;;0CACb,yPAAC;gCAAI,WAAU;;;;;;0CACf,yPAAC;gCAAI,WAAU;;;;;;;;;;;;kCAEjB,yPAAC;wBAAI,WAAU;;;;;;;;;;;;0BAEjB,yPAAC;gBAAI,WAAU;;;;;;0BACf,yPAAC;gBAAI,WAAU;;;;;;;;;;;;AAGrB;uCAEe","debugId":null}},
    {"offset": {"line": 1550, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartTableWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Search, Filter, Download, RefreshCw, Settings, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { DashboardWidget } from '../lib/dashboard/types';\nimport { TableData, TableHeader, TableRow, TableAction } from '../lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface SmartTableWidgetProps {\n  widget: DashboardWidget;\n  data: TableData;\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'json' | 'csv') => void;\n  onSettings?: () => void;\n  onRowClick?: (row: TableRow) => void;\n  onActionClick?: (action: TableAction, row: TableRow) => void;\n  className?: string;\n}\n\nexport function SmartTableWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  onRowClick,\n  onActionClick,\n  className\n}: SmartTableWidgetProps) {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(10);\n  const [sortField, setSortField] = useState<string>('');\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');\n  const [showSettings, setShowSettings] = useState(false);\n  const [selectedRows, setSelectedRows] = useState<Set<string>>(new Set());\n\n  const filteredData = useMemo(() => {\n    if (!searchTerm) return data.rows;\n    \n    return data.rows.filter(row => {\n      return Object.values(row).some(value => \n        String(value).toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    });\n  }, [data.rows, searchTerm]);\n\n  const sortedData = useMemo(() => {\n    if (!sortField) return filteredData;\n    \n    return [...filteredData].sort((a, b) => {\n      const aValue = a[sortField];\n      const bValue = b[sortField];\n      \n      if (aValue < bValue) return sortOrder === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortOrder === 'asc' ? 1 : -1;\n      return 0;\n    });\n  }, [filteredData, sortField, sortOrder]);\n\n  const paginatedData = useMemo(() => {\n    const start = (currentPage - 1) * pageSize;\n    const end = start + pageSize;\n    return sortedData.slice(start, end);\n  }, [sortedData, currentPage, pageSize]);\n\n  const totalPages = Math.ceil(sortedData.length / pageSize);\n\n  const handleSort = useCallback((field: string) => {\n    if (sortField === field) {\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortOrder('asc');\n    }\n  }, [sortField, sortOrder]);\n\n  const handleExport = useCallback((format: 'json' | 'csv') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    const exportData = {\n      widgetId: widget.id,\n      headers: data.headers,\n      rows: sortedData,\n      timestamp: new Date()\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-table-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'csv':\n        const csvHeaders = data.headers.map(h => h.label).join(',');\n        const csvRows = sortedData.map(row => \n          data.headers.map(header => `\"${String(row[header.key] || '')}\"`).join(',')\n        ).join('\\n');\n        const csvContent = \"data:text/csv;charset=utf-8,\" + csvHeaders + \"\\n\" + csvRows;\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-table-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n    }\n  }, [data.headers, sortedData, widget.id, onExport]);\n\n  const handleRowSelect = useCallback((rowId: string) => {\n    const newSelected = new Set(selectedRows);\n    if (newSelected.has(rowId)) {\n      newSelected.delete(rowId);\n    } else {\n      newSelected.add(rowId);\n    }\n    setSelectedRows(newSelected);\n  }, [selectedRows]);\n\n  const handleSelectAll = useCallback(() => {\n    if (selectedRows.size === paginatedData.length) {\n      setSelectedRows(new Set());\n    } else {\n      setSelectedRows(new Set(paginatedData.map(row => String(row.id || row[data.headers[0]?.key]))));\n    }\n  }, [selectedRows, paginatedData, data.headers]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"animate-pulse\">\n              <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n              <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n            </div>\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"space-y-3\">\n            {[...Array(5)].map((_, i) => (\n              <div key={i} className=\"h-10 bg-gray-200 rounded animate-pulse\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n              {widget.description && (\n                <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n              )}\n            </div>\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"h-32 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n            <div className=\"text-center\">\n              <div className=\"text-red-500 mb-2\">⚠️</div>\n              <p className=\"text-red-700 font-medium text-sm\">{error}</p>\n              <button\n                onClick={onRefresh}\n                className=\"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"\n              >\n                重试\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"刷新\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n            \n            <div className=\"relative\">\n              <button\n                onClick={() => setShowSettings(!showSettings)}\n                className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n                title=\"设置\"\n              >\n                <Settings className=\"h-4 w-4\" />\n              </button>\n              \n              {showSettings && (\n                <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                  <div className=\"py-1\">\n                    <button\n                      onClick={() => {\n                        handleExport('csv');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出CSV\n                    </button>\n                    <button\n                      onClick={() => {\n                        handleExport('json');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出JSON\n                    </button>\n                    {onSettings && (\n                      <button\n                        onClick={() => {\n                          onSettings();\n                          setShowSettings(false);\n                        }}\n                        className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                      >\n                        <Settings className=\"h-4 w-4 inline mr-2\" />\n                        高级设置\n                      </button>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* 搜索和过滤 */}\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex-1 relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n            <input\n              type=\"text\"\n              placeholder=\"搜索数据...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n          \n          <select\n            value={pageSize}\n            onChange={(e) => {\n              setPageSize(Number(e.target.value));\n              setCurrentPage(1);\n            }}\n            className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value={5}>5条/页</option>\n            <option value={10}>10条/页</option>\n            <option value={25}>25条/页</option>\n            <option value={50}>50条/页</option>\n          </select>\n        </div>\n      </div>\n\n      {/* 表格 */}\n      <div className=\"overflow-x-auto\">\n        <table className=\"w-full\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              {data.headers.map((header: TableHeader) => (\n                <th\n                  key={header.key}\n                  className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                >\n                  <button\n                    onClick={() => handleSort(header.key)}\n                    className=\"flex items-center gap-1 hover:text-gray-700\"\n                  >\n                    {header.label}\n                    {sortField === header.key && (\n                      <span className=\"text-blue-600\">\n                        {sortOrder === 'asc' ? '↑' : '↓'}\n                      </span>\n                    )}\n                  </button>\n                </th>\n              ))}\n              {data.actions && data.actions.length > 0 && (\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  操作\n                </th>\n              )}\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {paginatedData.map((row, index) => (\n              <tr\n                key={String(row.id || index)}\n                className=\"hover:bg-gray-50\"\n                onClick={() => onRowClick && onRowClick(row)}\n              >\n                {data.headers.map((header: TableHeader) => (\n                  <td key={header.key} className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {header.render ? header.render(row[header.key], row) : String(row[header.key] || '')}\n                  </td>\n                ))}\n                {data.actions && data.actions.length > 0 && (\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      {data.actions.map((action: TableAction) => (\n                        <button\n                          key={action.id}\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            onActionClick && onActionClick(action, row);\n                          }}\n                          className={cn(\n                            \"px-3 py-1 rounded text-sm font-medium transition-colors\",\n                            action.variant === 'primary' && 'bg-blue-600 text-white hover:bg-blue-700',\n                            action.variant === 'secondary' && 'bg-gray-100 text-gray-700 hover:bg-gray-200',\n                            action.variant === 'danger' && 'bg-red-600 text-white hover:bg-red-700'\n                          )}\n                        >\n                          {action.label}\n                        </button>\n                      ))}\n                    </div>\n                  </td>\n                )}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {/* 分页 */}\n      {totalPages > 1 && (\n        <div className=\"px-6 py-4 border-t border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"text-sm text-gray-700\">\n              显示第 {(currentPage - 1) * pageSize + 1} 到 {Math.min(currentPage * pageSize, sortedData.length)} 条，\n              共 {sortedData.length} 条数据\n            </div>\n            \n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                disabled={currentPage === 1}\n                className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                <ChevronLeft className=\"h-4 w-4\" />\n              </button>\n              \n              <div className=\"flex items-center gap-1\">\n                {[...Array(Math.min(5, totalPages))].map((_, i) => {\n                  const pageNum = Math.max(1, Math.min(totalPages - 4, currentPage - 2)) + i;\n                  return (\n                    <button\n                      key={pageNum}\n                      onClick={() => setCurrentPage(pageNum)}\n                      className={cn(\n                        \"px-3 py-2 rounded-lg text-sm font-medium\",\n                        currentPage === pageNum\n                          ? \"bg-blue-600 text-white\"\n                          : \"border border-gray-300 text-gray-700 hover:bg-gray-50\"\n                      )}\n                    >\n                      {pageNum}\n                    </button>\n                  );\n                })}\n              </div>\n              \n              <button\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n                disabled={currentPage === totalPages}\n                className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                <ChevronRight className=\"h-4 w-4\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport function SmartTableSkeleton() {\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"animate-pulse\">\n            <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n          </div>\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n        </div>\n        <div className=\"h-10 bg-gray-200 rounded animate-pulse\"></div>\n      </div>\n      <div className=\"p-6\">\n        <div className=\"space-y-3\">\n          {[...Array(5)].map((_, i) => (\n            <div key={i} className=\"h-10 bg-gray-200 rounded animate-pulse\"></div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default SmartTableWidget;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2449, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartInsightWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Brain, TrendingUp, AlertTriangle, CheckCircle, Info, RefreshCw, Download, Settings } from 'lucide-react';\nimport { DashboardWidget, SmartInsight } from '../lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface SmartInsightWidgetProps {\n  widget: DashboardWidget;\n  data: SmartInsight[];\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'json' | 'csv') => void;\n  onSettings?: () => void;\n  className?: string;\n}\n\nexport function SmartInsightWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  className\n}: SmartInsightWidgetProps) {\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\n  const [selectedPriority, setSelectedPriority] = useState<string>('all');\n  const [showSettings, setShowSettings] = useState(false);\n\n  const categories = useMemo(() => {\n    const cats = new Set(data.map(insight => insight.category));\n    return Array.from(cats);\n  }, [data]);\n\n  const priorities = useMemo(() => {\n    return ['high', 'medium', 'low'];\n  }, []);\n\n  const filteredInsights = useMemo(() => {\n    return data.filter(insight => {\n      const categoryMatch = selectedCategory === 'all' || insight.category === selectedCategory;\n      const priorityMatch = selectedPriority === 'all' || insight.priority === selectedPriority;\n      return categoryMatch && priorityMatch;\n    });\n  }, [data, selectedCategory, selectedPriority]);\n\n  const getInsightIcon = useCallback((type: string) => {\n    switch (type) {\n      case 'opportunity':\n        return <TrendingUp className=\"h-5 w-5 text-green-600\" />;\n      case 'warning':\n        return <AlertTriangle className=\"h-5 w-5 text-yellow-600\" />;\n      case 'success':\n        return <CheckCircle className=\"h-5 w-5 text-green-600\" />;\n      case 'info':\n      default:\n        return <Info className=\"h-5 w-5 text-blue-600\" />;\n    }\n  }, []);\n\n  const getPriorityColor = useCallback((priority: string) => {\n    switch (priority) {\n      case 'high':\n        return 'border-red-200 bg-red-50';\n      case 'medium':\n        return 'border-yellow-200 bg-yellow-50';\n      case 'low':\n        return 'border-blue-200 bg-blue-50';\n      default:\n        return 'border-gray-200 bg-gray-50';\n    }\n  }, []);\n\n  const getPriorityBadgeColor = useCallback((priority: string) => {\n    switch (priority) {\n      case 'high':\n        return 'bg-red-100 text-red-800';\n      case 'medium':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'low':\n        return 'bg-blue-100 text-blue-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  }, []);\n\n  const handleExport = useCallback((format: 'json' | 'csv') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    const exportData = {\n      widgetId: widget.id,\n      insights: filteredInsights,\n      timestamp: new Date()\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-insights-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'csv':\n        const csvContent = \"data:text/csv;charset=utf-8,\" + \n          \"标题,描述,类型,优先级,类别,置信度,影响,建议,时间戳\\n\" +\n          filteredInsights.map(insight => \n            `\"${insight.title}\",\"${insight.description}\",\"${insight.type}\",\"${insight.priority}\",\"${insight.category}\",\"${insight.confidence}\",\"${insight.impact}\",\"${insight.recommendation}\",\"${new Date().toISOString()}\"`\n          ).join(\"\\n\");\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-insights-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n    }\n  }, [filteredInsights, widget.id, onExport]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"animate-pulse\">\n              <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n              <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n            </div>\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"space-y-4\">\n            {[...Array(3)].map((_, i) => (\n              <div key={i} className=\"h-24 bg-gray-200 rounded-lg animate-pulse\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n              {widget.description && (\n                <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n              )}\n            </div>\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"h-32 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n            <div className=\"text-center\">\n              <div className=\"text-red-500 mb-2\">⚠️</div>\n              <p className=\"text-red-700 font-medium text-sm\">{error}</p>\n              <button\n                onClick={onRefresh}\n                className=\"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"\n              >\n                重试\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center gap-3\">\n            <Brain className=\"h-6 w-6 text-blue-600\" />\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n              {widget.description && (\n                <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n              )}\n            </div>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"刷新\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n            \n            <div className=\"relative\">\n              <button\n                onClick={() => setShowSettings(!showSettings)}\n                className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n                title=\"设置\"\n              >\n                <Settings className=\"h-4 w-4\" />\n              </button>\n              \n              {showSettings && (\n                <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                  <div className=\"py-1\">\n                    <button\n                      onClick={() => {\n                        handleExport('csv');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出CSV\n                    </button>\n                    <button\n                      onClick={() => {\n                        handleExport('json');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出JSON\n                    </button>\n                    {onSettings && (\n                      <button\n                        onClick={() => {\n                          onSettings();\n                          setShowSettings(false);\n                        }}\n                        className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                      >\n                        <Settings className=\"h-4 w-4 inline mr-2\" />\n                        高级设置\n                      </button>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* 过滤器 */}\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-sm font-medium text-gray-700\">类别:</label>\n            <select\n              value={selectedCategory}\n              onChange={(e) => setSelectedCategory(e.target.value)}\n              className=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"all\">全部</option>\n              {categories.map(category => (\n                <option key={category} value={category}>{category}</option>\n              ))}\n            </select>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-sm font-medium text-gray-700\">优先级:</label>\n            <select\n              value={selectedPriority}\n              onChange={(e) => setSelectedPriority(e.target.value)}\n              className=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"all\">全部</option>\n              {priorities.map(priority => (\n                <option key={priority} value={priority}>\n                  {priority === 'high' ? '高' : priority === 'medium' ? '中' : '低'}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {/* 洞察内容 */}\n      <div className=\"p-6\">\n        {filteredInsights.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <Brain className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <p className=\"text-gray-600\">暂无相关洞察</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {filteredInsights.map((insight, index) => (\n              <div\n                key={index}\n                className={cn(\n                  \"rounded-lg border p-4\",\n                  getPriorityColor(insight.priority)\n                )}\n              >\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"flex-shrink-0 mt-1\">\n                    {getInsightIcon(insight.type)}\n                  </div>\n                  \n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <h4 className=\"text-sm font-semibold text-gray-900\">\n                        {insight.title}\n                      </h4>\n                      <div className=\"flex items-center gap-2\">\n                        <span className={cn(\n                          \"px-2 py-1 rounded-full text-xs font-medium\",\n                          getPriorityBadgeColor(insight.priority)\n                        )}>\n                          {insight.priority === 'high' ? '高' : insight.priority === 'medium' ? '中' : '低'}\n                        </span>\n                        <span className=\"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded\">\n                          {insight.category}\n                        </span>\n                      </div>\n                    </div>\n                    \n                    <p className=\"text-sm text-gray-700 mb-3\">\n                      {insight.description}\n                    </p>\n                    \n                    <div className=\"grid grid-cols-2 gap-4 mb-3\">\n                      <div>\n                        <div className=\"text-xs text-gray-500 mb-1\">置信度</div>\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                            <div\n                              className=\"bg-blue-600 h-2 rounded-full\"\n                              style={{ width: `${insight.confidence}%` }}\n                            />\n                          </div>\n                          <span className=\"text-xs font-medium text-gray-700\">\n                            {insight.confidence}%\n                          </span>\n                        </div>\n                      </div>\n                      \n                      <div>\n                        <div className=\"text-xs text-gray-500 mb-1\">影响程度</div>\n                        <div className=\"text-sm font-medium text-gray-900\">\n                          {insight.impact}\n                        </div>\n                      </div>\n                    </div>\n                    \n                    {insight.recommendation && (\n                      <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\n                        <div className=\"text-xs font-medium text-gray-700 mb-1\">建议</div>\n                        <p className=\"text-sm text-gray-600\">\n                          {insight.recommendation}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* 统计信息 */}\n      <div className=\"px-6 py-4 border-t border-gray-200 bg-gray-50\">\n        <div className=\"flex items-center justify-between text-sm text-gray-600\">\n          <div>\n            共 {filteredInsights.length} 条洞察\n          </div>\n          <div>\n            最后更新: {new Date().toLocaleString('zh-CN')}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function SmartInsightSkeleton() {\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"animate-pulse\">\n            <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n          </div>\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n      <div className=\"p-6\">\n        <div className=\"space-y-4\">\n          {[...Array(3)].map((_, i) => (\n            <div key={i} className=\"h-24 bg-gray-200 rounded-lg animate-pulse\"></div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default SmartInsightWidget;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3439, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/ModularDashboardBuilder.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Plus, Settings, Save, Eye, EyeOff, Move, Trash2, Edit3 } from 'lucide-react';\nimport { DashboardWidget, DashboardLayout, WidgetConfig } from '../lib/dashboard/types';\nimport { SmartChartWidget } from '@/app/components/SmartChartWidget';\nimport { SmartMetricWidget } from '@/app/components/SmartMetricWidget';\nimport { SmartTableWidget } from '@/app/components/SmartTableWidget';\nimport { SmartInsightWidget } from '@/app/components/SmartInsightWidget';\nimport { cn } from '@/app/lib/utils';\n\ninterface ModularDashboardBuilderProps {\n  layout: DashboardLayout;\n  widgets: DashboardWidget[];\n  onLayoutChange: (layout: DashboardLayout) => void;\n  onWidgetAdd: (widget: DashboardWidget) => void;\n  onWidgetRemove: (widgetId: string) => void;\n  onWidgetUpdate: (widgetId: string, updates: Partial<DashboardWidget>) => void;\n  className?: string;\n}\n\nexport function ModularDashboardBuilder({\n  layout,\n  // 为 widgets 设置默认值，避免父组件未传时为 undefined\n  widgets = [],\n  onLayoutChange,\n  onWidgetAdd,\n  onWidgetRemove,\n  onWidgetUpdate,\n  className\n}: ModularDashboardBuilderProps) {\n  const [isEditMode, setIsEditMode] = useState(false);\n  const [draggedWidget, setDraggedWidget] = useState<string | null>(null);\n  const [showWidgetSelector, setShowWidgetSelector] = useState(false);\n\n  // 将组件映射类型限制到实际可用键，避免索引错误\n  type WidgetComponentMap = {\n    chart: typeof SmartChartWidget;\n    metric: typeof SmartMetricWidget;\n    table: typeof SmartTableWidget;\n    insight: typeof SmartInsightWidget;\n  };\n  const widgetComponents: WidgetComponentMap = useMemo(() => {\n    return {\n      chart: SmartChartWidget,\n      metric: SmartMetricWidget,\n      table: SmartTableWidget,\n      insight: SmartInsightWidget\n    };\n  }, []);\n\n  const availableWidgetTypes = useMemo(() => {\n    return [\n      { type: 'chart', name: '图表', description: '数据可视化图表' },\n      { type: 'metric', name: '指标', description: '关键业务指标' },\n      { type: 'table', name: '表格', description: '数据表格展示' },\n      { type: 'insight', name: '洞察', description: 'AI业务洞察' }\n    ];\n  }, []);\n\n  const handleDragStart = useCallback((e: React.DragEvent, widgetId: string) => {\n    setDraggedWidget(widgetId);\n    e.dataTransfer.effectAllowed = 'move';\n  }, []);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent, targetIndex: number) => {\n    e.preventDefault();\n    if (!layout || !Array.isArray(layout.widgets)) {\n        // 没有可用的布局时不进行重排，直接退出\n        setDraggedWidget(null);\n        return;\n    }\n    if (draggedWidget) {\n      const currentIndex = layout.widgets.findIndex(w => w.id === draggedWidget);\n      if (currentIndex === -1) {\n          setDraggedWidget(null);\n          return;\n      }\n  \n      const reordered = [...layout.widgets];\n      const [moved] = reordered.splice(currentIndex, 1);\n      reordered.splice(targetIndex, 0, moved);\n  \n      const updatedWidgets = reordered.map((w, idx) => ({\n        ...w,\n        position: { ...w.position, y: idx }\n      }));\n  \n      onLayoutChange({ ...layout, widgets: updatedWidgets });\n      setDraggedWidget(null);\n    }\n  }, [draggedWidget, layout, onLayoutChange]);\n\n  const handleWidgetAdd = useCallback((type: string) => {\n    const newWidget: DashboardWidget = {\n      id: `widget-${Date.now()}`,\n      type: type as any,\n      title: `新${availableWidgetTypes.find(t => t.type === type)?.name}`,\n      description: availableWidgetTypes.find(t => t.type === type)?.description,\n      size: 'medium',\n      // 使用 widgets.length 作为默认顺序，确保不读 undefined.length\n      position: { x: 0, y: widgets.length, w: 1, h: 1 },\n      config: {} as WidgetConfig,\n      dataSource: 'demo'\n    };\n    onWidgetAdd(newWidget);\n    setShowWidgetSelector(false);\n  }, [availableWidgetTypes, widgets.length, onWidgetAdd]);\n\n  const handleWidgetRemove = useCallback((widgetId: string) => {\n    if (confirm('确定要删除这个组件吗？')) {\n      onWidgetRemove(widgetId);\n    }\n  }, [onWidgetRemove]);\n\n  const handleLayoutSave = useCallback(() => {\n    localStorage.setItem('dashboard-layout', JSON.stringify(layout));\n    alert('布局已保存！');\n  }, [layout]);\n\n  const handleLayoutReset = useCallback(() => {\n    if (confirm('确定要重置布局吗？')) {\n      localStorage.removeItem('dashboard-layout');\n      window.location.reload();\n    }\n  }, []);\n\n  const renderWidget = useCallback((widget: DashboardWidget, index: number) => {\n    const type = widget.type;\n\n    return (\n      <div\n        key={widget.id}\n        className={cn(\"relative group\", isEditMode && \"cursor-move\")}\n        draggable={isEditMode}\n        onDragStart={(e) => handleDragStart(e, widget.id)}\n        onDragOver={handleDragOver}\n        // 使用索引作为目标位置，避免把对象传入需要 number 的参数\n        onDrop={(e) => handleDrop(e, index)}\n      >\n        {isEditMode && (\n          <div className=\"absolute inset-0 bg-blue-500 bg-opacity-10 rounded-lg border-2 border-blue-500 border-dashed z-10 flex items-center justify-center\">\n            <div className=\"flex items-center gap-2 text-blue-600 font-medium\">\n              <Move className=\"h-4 w-4\" />\n              拖拽移动\n            </div>\n          </div>\n        )}\n\n        <div className=\"relative\">\n          {type === 'chart' && (\n            <SmartChartWidget\n              widget={widget}\n              data={generateChartData(widget.config.chartType as any ?? 'line')}\n              loading={false}\n              error={null}\n              className=\"h-full\"\n            />\n          )}\n          {type === 'metric' && (\n            <SmartMetricWidget\n              widget={widget}\n              data={generateMetricData()}\n              loading={false}\n              error={null}\n              className=\"h-full\"\n            />\n          )}\n          {type === 'table' && (\n            <SmartTableWidget\n              widget={widget}\n              data={generateTableData()}\n              loading={false}\n              error={null}\n              className=\"h-full\"\n            />\n          )}\n          {type === 'insight' && (\n            <SmartInsightWidget\n              widget={widget}\n              data={generateSmartInsights(5)}\n              loading={false}\n              error={null}\n              className=\"h-full\"\n            />\n          )}\n\n          {isEditMode && (\n            <div className=\"absolute top-2 right-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n              <button\n                onClick={() => handleWidgetRemove(widget.id)}\n                className=\"p-1 bg-red-600 text-white rounded hover:bg-red-700\"\n                title=\"删除\"\n              >\n                <Trash2 className=\"h-3 w-3\" />\n              </button>\n              <button\n                onClick={() => {\n                  const newTitle = prompt('修改标题:', widget.title);\n                  if (newTitle) {\n                    onWidgetUpdate(widget.id, { title: newTitle });\n                  }\n                }}\n                className=\"p-1 bg-blue-600 text-white rounded hover:bg-blue-700\"\n                title=\"编辑\"\n              >\n                <Edit3 className=\"h-3 w-3\" />\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }, [isEditMode, handleDragStart, handleDragOver, handleDrop, handleWidgetRemove, onWidgetUpdate]);\n\n  const generateMockData = useCallback((type: string) => {\n    switch (type) {\n      case 'chart':\n        return {\n          labels: ['1月', '2月', '3月', '4月', '5月', '6月'],\n          datasets: [{\n            label: '销售额',\n            data: [12000, 19000, 15000, 25000, 22000, 30000],\n            borderColor: 'rgb(59, 130, 246)',\n            backgroundColor: 'rgba(59, 130, 246, 0.1)',\n          }]\n        };\n      \n      case 'metric':\n        return {\n          label: '本月销售额',\n          value: 125000,\n          format: 'currency',\n          unit: 'CNY',\n          change: 15.2,\n          trend: 'up' as const,\n          target: 150000\n        };\n      \n      case 'table':\n        return {\n          headers: [\n            { key: 'name', label: '姓名' },\n            { key: 'email', label: '邮箱' },\n            { key: 'status', label: '状态' },\n            { key: 'createdAt', label: '创建时间' }\n          ],\n          rows: [\n            { id: 1, name: '张三', email: 'zhang@example.com', status: '活跃', createdAt: '2024-01-15' },\n            { id: 2, name: '李四', email: 'li@example.com', status: '待激活', createdAt: '2024-01-14' },\n            { id: 3, name: '王五', email: 'wang@example.com', status: '活跃', createdAt: '2024-01-13' }\n          ],\n          actions: [\n            { id: 'view', label: '查看', variant: 'primary' },\n            { id: 'edit', label: '编辑', variant: 'secondary' }\n          ]\n        };\n      \n      case 'insight':\n        return [\n          {\n            id: '1',\n            title: '销售增长机会',\n            description: '本月销售额相比上月增长15.2%，建议加大营销投入以维持增长势头。',\n            type: 'opportunity',\n            priority: 'high',\n            category: '销售',\n            confidence: 85,\n            impact: '高',\n            recommendation: '建议增加营销预算20%，重点关注高转化率的渠道。'\n          },\n          {\n            id: '2',\n            title: '用户活跃度下降',\n            description: '最近7天用户活跃度下降8%，需要关注用户体验。',\n            type: 'warning',\n            priority: 'medium',\n            category: '用户',\n            confidence: 72,\n            impact: '中',\n            recommendation: '建议优化用户界面，增加互动功能。'\n          }\n        ];\n      \n      default:\n        return {};\n    }\n  }, []);\n\n  return (\n    <div className={cn(\"relative\", className)}>\n      {/* 工具栏 */}\n      <div className=\"flex items-center justify-between mb-6 p-4 bg-white rounded-lg shadow-sm border border-gray-200\">\n        <div className=\"flex items-center gap-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">模块化仪表板</h2>\n          <div className=\"text-sm text-gray-600\">\n            共 {widgets.length} 个组件\n          </div>\n        </div>\n        \n        <div className=\"flex items-center gap-2\">\n          {isEditMode && (\n            <>\n              <button\n                onClick={() => setShowWidgetSelector(true)}\n                className=\"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\n              >\n                <Plus className=\"h-4 w-4\" />\n                添加组件\n              </button>\n              \n              <button\n                onClick={handleLayoutSave}\n                className=\"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n              >\n                <Save className=\"h-4 w-4\" />\n                保存布局\n              </button>\n              \n              <button\n                onClick={handleLayoutReset}\n                className=\"px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\n              >\n                重置\n              </button>\n            </>\n          )}\n          \n          <button\n            onClick={() => setIsEditMode(!isEditMode)}\n            className={cn(\n              \"flex items-center gap-2 px-3 py-2 rounded-lg transition-colors\",\n              isEditMode\n                ? \"bg-red-600 text-white hover:bg-red-700\"\n                : \"bg-blue-600 text-white hover:bg-blue-700\"\n            )}\n          >\n            {isEditMode ? (\n              <>\n                <Eye className=\"h-4 w-4\" />\n                退出编辑\n              </>\n            ) : (\n              <>\n                <Settings className=\"h-4 w-4\" />\n                编辑模式\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* 组件选择器 */}\n      {showWidgetSelector && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">添加组件</h3>\n            <div className=\"space-y-2\">\n              {availableWidgetTypes.map(type => (\n                <button\n                  key={type.type}\n                  onClick={() => handleWidgetAdd(type.type)}\n                  className=\"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors\"\n                >\n                  <div className=\"font-medium text-gray-900\">{type.name}</div>\n                  <div className=\"text-sm text-gray-600\">{type.description}</div>\n                </button>\n              ))}\n            </div>\n            <div className=\"flex justify-end gap-2 mt-4\">\n              <button\n                onClick={() => setShowWidgetSelector(false)}\n                className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\n              >\n                取消\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 仪表板网格 */}\n      <div className={cn(\n        \"grid gap-6\",\n        (layout?.gridConfig?.cols ?? 3) >= 4 && \"grid-cols-1 md:grid-cols-2 lg:grid-cols-4\",\n        (layout?.gridConfig?.cols ?? 3) === 3 && \"grid-cols-1 md:grid-cols-2 lg:grid-cols-3\",\n        (layout?.gridConfig?.cols ?? 3) <= 2 && \"grid-cols-1 md:grid-cols-2\"\n      )}>\n        {/* 统一使用 widgets 渲染，避免访问 layout.widgets */}\n        {widgets.map((widget, idx) => renderWidget(widget, idx))}\n      </div>\n\n      {/* 空状态 */}\n      {widgets.length === 0 && (\n        <div className=\"text-center py-12\">\n          <div className=\"text-gray-400 mb-4\">\n            <Settings className=\"h-16 w-16 mx-auto\" />\n          </div>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">还没有组件</h3>\n          <p className=\"text-gray-600 mb-4\">点击编辑模式开始添加组件</p>\n          <button\n            onClick={() => setIsEditMode(true)}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n          >\n            开始编辑\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default ModularDashboardBuilder;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4135, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/AIInsightEngine.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Brain, TrendingUp, Users, DollarSign, Eye, Target, Clock, CheckCircle } from 'lucide-react';\nimport { SmartInsight } from '@/app/lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface AIInsightEngineProps {\n  className?: string;\n  onInsightGenerated?: (insights: SmartInsight[]) => void;\n}\n\nexport function AIInsightEngine({\n  className,\n  onInsightGenerated\n}: AIInsightEngineProps) {\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [selectedMetrics, setSelectedMetrics] = useState<string[]>([]);\n  const [analysisDepth, setAnalysisDepth] = useState<'basic' | 'advanced' | 'deep'>('advanced');\n  const [timeRange, setTimeRange] = useState<'7d' | '30d' | '90d' | '1y'>('30d');\n\n  const availableMetrics = useMemo(() => {\n    return [\n      { id: 'revenue', name: '收入', icon: DollarSign, category: '财务' },\n      { id: 'users', name: '用户', icon: Users, category: '用户' },\n      { id: 'engagement', name: '参与度', icon: Eye, category: '用户' },\n      { id: 'conversion', name: '转化率', icon: Target, category: '营销' },\n      { id: 'retention', name: '留存率', icon: CheckCircle, category: '用户' },\n      { id: 'performance', name: '性能', icon: Clock, category: '技术' }\n    ];\n  }, []);\n\n  const generateInsights = useCallback(async () => {\n    setIsAnalyzing(true);\n    \n    // 模拟AI分析过程\n    await new Promise(resolve => setTimeout(resolve, 2000));\n    \n    const confidence1 = Math.floor(Math.random() * 30 + 70);\n    const confidence2 = Math.floor(Math.random() * 25 + 65);\n    const confidence3 = Math.floor(Math.random() * 20 + 75);\n    const confidence4 = Math.floor(Math.random() * 15 + 80);\n\n    const mockInsights: SmartInsight[] = [\n      {\n        id: '1',\n        title: '收入趋势异常',\n        description: `过去${timeRange === '7d' ? '7天' : timeRange === '30d' ? '30天' : timeRange === '90d' ? '90天' : '1年'}收入增长率下降${Math.floor(Math.random() * 20 + 5)}%，需要立即关注。`,\n        type: 'anomaly',\n        severity: 'high',\n        category: '财务',\n        confidence: confidence1,\n        dataPoints: [\n          { label: 'income_change', value: confidence1, trend: 'down' }\n        ],\n        recommendations: [\n          { id: 'rec-1', text: '建议分析具体下降原因，调整营销策略，优化产品定价。', priority: 'high' }\n        ],\n        timestamp: new Date(),\n        tags: ['收入', '趋势'],\n        autoActionable: false\n      },\n      {\n        id: '2',\n        title: '用户增长机会',\n        description: '发现新的用户获取渠道，预计可提升用户增长15-20%。',\n        type: 'opportunity',\n        severity: 'medium',\n        category: '用户',\n        confidence: confidence2,\n        dataPoints: [\n          { label: 'user_growth_potential', value: confidence2, trend: 'up' }\n        ],\n        recommendations: [\n          { id: 'rec-2', text: '建议投入更多资源到新渠道测试，监控转化效果。', priority: 'medium' }\n        ],\n        timestamp: new Date(),\n        tags: ['用户', '渠道'],\n        autoActionable: false\n      },\n      {\n        id: '3',\n        title: '系统性能优化',\n        description: '检测到系统响应时间增加，可能影响用户体验。',\n        type: 'risk',\n        severity: 'medium',\n        category: '技术',\n        confidence: confidence3,\n        dataPoints: [\n          { label: 'latency_increase', value: confidence3, trend: 'up' }\n        ],\n        recommendations: [\n          { id: 'rec-3', text: '优化数据库查询，增加缓存机制，监控服务器资源。', priority: 'medium' }\n        ],\n        timestamp: new Date(),\n        tags: ['性能', '响应时间'],\n        autoActionable: false\n      },\n      {\n        id: '4',\n        title: '营销ROI提升',\n        description: '最近营销活动效果显著，ROI提升25%。',\n        type: 'achievement',\n        severity: 'low',\n        category: '营销',\n        confidence: confidence4,\n        dataPoints: [\n          { label: 'roi_increase', value: confidence4, trend: 'up' }\n        ],\n        recommendations: [\n          { id: 'rec-4', text: '复制成功营销策略，扩大投放规模。', priority: 'low' }\n        ],\n        timestamp: new Date(),\n        tags: ['营销', 'ROI'],\n        autoActionable: true\n      }\n    ];\n\n    setIsAnalyzing(false);\n    \n    if (onInsightGenerated) {\n      onInsightGenerated(mockInsights);\n    }\n  }, [timeRange, selectedMetrics, onInsightGenerated]);\n\n  const toggleMetric = useCallback((metricId: string) => {\n    setSelectedMetrics(prev => \n      prev.includes(metricId) \n        ? prev.filter(id => id !== metricId)\n        : [...prev, metricId]\n    );\n  }, []);\n\n  const getAnalysisDepthLabel = useCallback((depth: string) => {\n    switch (depth) {\n      case 'basic':\n        return '基础分析 - 快速概览';\n      case 'advanced':\n        return '高级分析 - 深度洞察';\n      case 'deep':\n        return '深度分析 - AI预测';\n      default:\n        return '高级分析';\n    }\n  }, []);\n\n  const getTimeRangeLabel = useCallback((range: string) => {\n    switch (range) {\n      case '7d':\n        return '最近7天';\n      case '30d':\n        return '最近30天';\n      case '90d':\n        return '最近90天';\n      case '1y':\n        return '最近1年';\n      default:\n        return '最近30天';\n    }\n  }, []);\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n      <div className=\"flex items-center gap-3 mb-6\">\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\n          <Brain className=\"h-6 w-6 text-blue-600\" />\n        </div>\n        <div>\n          <h2 className=\"text-xl font-semibold text-gray-900\">AI洞察引擎</h2>\n          <p className=\"text-sm text-gray-600\">智能分析数据，生成业务洞察</p>\n        </div>\n      </div>\n\n      {/* 分析配置 */}\n      <div className=\"space-y-6\">\n        {/* 时间范围选择 */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n            分析时间范围\n          </label>\n          <div className=\"grid grid-cols-4 gap-3\">\n            {(['7d', '30d', '90d', '1y'] as const).map(range => (\n              <button\n                key={range}\n                onClick={() => setTimeRange(range)}\n                className={cn(\n                  \"p-3 rounded-lg border text-sm font-medium transition-colors\",\n                  timeRange === range\n                    ? \"bg-blue-600 text-white border-blue-600\"\n                    : \"bg-white text-gray-700 border-gray-300 hover:bg-gray-50\"\n                )}\n              >\n                {getTimeRangeLabel(range)}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* 分析深度 */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n            分析深度\n          </label>\n          <div className=\"space-y-3\">\n            {(['basic', 'advanced', 'deep'] as const).map(depth => (\n              <label key={depth} className=\"flex items-center cursor-pointer\">\n                <input\n                  type=\"radio\"\n                  name=\"analysisDepth\"\n                  value={depth}\n                  checked={analysisDepth === depth}\n                  onChange={(e) => setAnalysisDepth(e.target.value as any)}\n                  className=\"mr-3 text-blue-600\"\n                />\n                <div>\n                  <div className=\"font-medium text-gray-900\">\n                    {getAnalysisDepthLabel(depth)}\n                  </div>\n                  <div className=\"text-sm text-gray-600\">\n                    {depth === 'basic' && '快速生成基础洞察'}\n                    {depth === 'advanced' && '深度分析数据模式和趋势'}\n                    {depth === 'deep' && 'AI预测和高级建模'}\n                  </div>\n                </div>\n              </label>\n            ))}\n          </div>\n        </div>\n\n        {/* 指标选择 */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n            选择分析指标（可选）\n          </label>\n          <div className=\"grid grid-cols-2 gap-3\">\n            {availableMetrics.map(metric => {\n              const Icon = metric.icon;\n              return (\n                <label\n                  key={metric.id}\n                  className={cn(\n                    \"flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors\",\n                    selectedMetrics.includes(metric.id)\n                      ? \"bg-blue-50 border-blue-300\"\n                      : \"bg-white border-gray-200 hover:bg-gray-50\"\n                  )}\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedMetrics.includes(metric.id)}\n                    onChange={() => toggleMetric(metric.id)}\n                    className=\"text-blue-600\"\n                  />\n                  <Icon className=\"h-5 w-5 text-gray-600\" />\n                  <div>\n                    <div className=\"font-medium text-gray-900\">{metric.name}</div>\n                    <div className=\"text-xs text-gray-500\">{metric.category}</div>\n                  </div>\n                </label>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* 分析按钮 */}\n        <div className=\"pt-4 border-t border-gray-200\">\n          <button\n            onClick={generateInsights}\n            disabled={isAnalyzing}\n            className={cn(\n              \"w-full flex items-center justify-center gap-3 px-6 py-3 rounded-lg font-medium transition-colors\",\n              isAnalyzing\n                ? \"bg-gray-400 text-white cursor-not-allowed\"\n                : \"bg-blue-600 text-white hover:bg-blue-700\"\n            )}\n          >\n            {isAnalyzing ? (\n              <>\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\n                AI分析中...\n              </>\n            ) : (\n              <>\n                <Brain className=\"h-5 w-5\" />\n                开始AI分析\n              </>\n            )}\n          </button>\n        </div>\n\n        {/* 分析状态 */}\n        {isAnalyzing && (\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n              <div>\n                <div className=\"font-medium text-blue-900\">正在分析数据...</div>\n                <div className=\"text-sm text-blue-700 mt-1\">\n                  AI正在处理您的数据，这可能需要几秒钟时间\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* 分析说明 */}\n      <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\n        <h4 className=\"font-medium text-gray-900 mb-2\">分析说明</h4>\n        <ul className=\"text-sm text-gray-600 space-y-1\">\n          <li>• 基础分析：提供数据概览和基础趋势分析</li>\n          <li>• 高级分析：深度挖掘数据模式，识别异常和机会</li>\n          <li>• 深度分析：使用AI模型进行预测和高级建模</li>\n          <li>• 选择特定指标可以获得更精准的分析结果</li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n\nexport default AIInsightEngine;"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AALA;;;;;AAYO,SAAS,gBAAgB,EAC9B,SAAS,EACT,kBAAkB,EACG;IACrB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,4NAAQ,EAAC;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,4NAAQ,EAAW,EAAE;IACnE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,4NAAQ,EAAgC;IAClF,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,4NAAQ,EAA8B;IAExE,MAAM,mBAAmB,IAAA,2NAAO,EAAC;QAC/B,OAAO;YACL;gBAAE,IAAI;gBAAW,MAAM;gBAAM,MAAM,2OAAU;gBAAE,UAAU;YAAK;YAC9D;gBAAE,IAAI;gBAAS,MAAM;gBAAM,MAAM,wNAAK;gBAAE,UAAU;YAAK;YACvD;gBAAE,IAAI;gBAAc,MAAM;gBAAO,MAAM,kNAAG;gBAAE,UAAU;YAAK;YAC3D;gBAAE,IAAI;gBAAc,MAAM;gBAAO,MAAM,2NAAM;gBAAE,UAAU;YAAK;YAC9D;gBAAE,IAAI;gBAAa,MAAM;gBAAO,MAAM,qPAAW;gBAAE,UAAU;YAAK;YAClE;gBAAE,IAAI;gBAAe,MAAM;gBAAM,MAAM,wNAAK;gBAAE,UAAU;YAAK;SAC9D;IACH,GAAG,EAAE;IAEL,MAAM,mBAAmB,IAAA,+NAAW,EAAC;QACnC,eAAe;QAEf,WAAW;QACX,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;QAEjD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;QACpD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;QACpD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;QACpD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;QAEpD,MAAM,eAA+B;YACnC;gBACE,IAAI;gBACJ,OAAO;gBACP,aAAa,CAAC,EAAE,EAAE,cAAc,OAAO,OAAO,cAAc,QAAQ,QAAQ,cAAc,QAAQ,QAAQ,KAAK,OAAO,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK,GAAG,SAAS,CAAC;gBACrK,MAAM;gBACN,UAAU;gBACV,UAAU;gBACV,YAAY;gBACZ,YAAY;oBACV;wBAAE,OAAO;wBAAiB,OAAO;wBAAa,OAAO;oBAAO;iBAC7D;gBACD,iBAAiB;oBACf;wBAAE,IAAI;wBAAS,MAAM;wBAA6B,UAAU;oBAAO;iBACpE;gBACD,WAAW,IAAI;gBACf,MAAM;oBAAC;oBAAM;iBAAK;gBAClB,gBAAgB;YAClB;YACA;gBACE,IAAI;gBACJ,OAAO;gBACP,aAAa;gBACb,MAAM;gBACN,UAAU;gBACV,UAAU;gBACV,YAAY;gBACZ,YAAY;oBACV;wBAAE,OAAO;wBAAyB,OAAO;wBAAa,OAAO;oBAAK;iBACnE;gBACD,iBAAiB;oBACf;wBAAE,IAAI;wBAAS,MAAM;wBAA0B,UAAU;oBAAS;iBACnE;gBACD,WAAW,IAAI;gBACf,MAAM;oBAAC;oBAAM;iBAAK;gBAClB,gBAAgB;YAClB;YACA;gBACE,IAAI;gBACJ,OAAO;gBACP,aAAa;gBACb,MAAM;gBACN,UAAU;gBACV,UAAU;gBACV,YAAY;gBACZ,YAAY;oBACV;wBAAE,OAAO;wBAAoB,OAAO;wBAAa,OAAO;oBAAK;iBAC9D;gBACD,iBAAiB;oBACf;wBAAE,IAAI;wBAAS,MAAM;wBAA2B,UAAU;oBAAS;iBACpE;gBACD,WAAW,IAAI;gBACf,MAAM;oBAAC;oBAAM;iBAAO;gBACpB,gBAAgB;YAClB;YACA;gBACE,IAAI;gBACJ,OAAO;gBACP,aAAa;gBACb,MAAM;gBACN,UAAU;gBACV,UAAU;gBACV,YAAY;gBACZ,YAAY;oBACV;wBAAE,OAAO;wBAAgB,OAAO;wBAAa,OAAO;oBAAK;iBAC1D;gBACD,iBAAiB;oBACf;wBAAE,IAAI;wBAAS,MAAM;wBAAoB,UAAU;oBAAM;iBAC1D;gBACD,WAAW,IAAI;gBACf,MAAM;oBAAC;oBAAM;iBAAM;gBACnB,gBAAgB;YAClB;SACD;QAED,eAAe;QAEf,IAAI,oBAAoB;YACtB,mBAAmB;QACrB;IACF,GAAG;QAAC;QAAW;QAAiB;KAAmB;IAEnD,MAAM,eAAe,IAAA,+NAAW,EAAC,CAAC;QAChC,mBAAmB,CAAA,OACjB,KAAK,QAAQ,CAAC,YACV,KAAK,MAAM,CAAC,CAAA,KAAM,OAAO,YACzB;mBAAI;gBAAM;aAAS;IAE3B,GAAG,EAAE;IAEL,MAAM,wBAAwB,IAAA,+NAAW,EAAC,CAAC;QACzC,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF,GAAG,EAAE;IAEL,MAAM,oBAAoB,IAAA,+NAAW,EAAC,CAAC;QACrC,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF,GAAG,EAAE;IAEL,qBACE,yPAAC;QAAI,WAAW,IAAA,oIAAE,EAAC,4DAA4D;;0BAC7E,yPAAC;gBAAI,WAAU;;kCACb,yPAAC;wBAAI,WAAU;kCACb,cAAA,yPAAC,wNAAK;4BAAC,WAAU;;;;;;;;;;;kCAEnB,yPAAC;;0CACC,yPAAC;gCAAG,WAAU;0CAAsC;;;;;;0CACpD,yPAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;;;;;;;0BAKzC,yPAAC;gBAAI,WAAU;;kCAEb,yPAAC;;0CACC,yPAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,yPAAC;gCAAI,WAAU;0CACZ,AAAC;oCAAC;oCAAM;oCAAO;oCAAO;iCAAK,CAAW,GAAG,CAAC,CAAA,sBACzC,yPAAC;wCAEC,SAAS,IAAM,aAAa;wCAC5B,WAAW,IAAA,oIAAE,EACX,+DACA,cAAc,QACV,2CACA;kDAGL,kBAAkB;uCATd;;;;;;;;;;;;;;;;kCAgBb,yPAAC;;0CACC,yPAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,yPAAC;gCAAI,WAAU;0CACZ,AAAC;oCAAC;oCAAS;oCAAY;iCAAO,CAAW,GAAG,CAAC,CAAA,sBAC5C,yPAAC;wCAAkB,WAAU;;0DAC3B,yPAAC;gDACC,MAAK;gDACL,MAAK;gDACL,OAAO;gDACP,SAAS,kBAAkB;gDAC3B,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;gDAChD,WAAU;;;;;;0DAEZ,yPAAC;;kEACC,yPAAC;wDAAI,WAAU;kEACZ,sBAAsB;;;;;;kEAEzB,yPAAC;wDAAI,WAAU;;4DACZ,UAAU,WAAW;4DACrB,UAAU,cAAc;4DACxB,UAAU,UAAU;;;;;;;;;;;;;;uCAhBf;;;;;;;;;;;;;;;;kCAyBlB,yPAAC;;0CACC,yPAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,yPAAC;gCAAI,WAAU;0CACZ,iBAAiB,GAAG,CAAC,CAAA;oCACpB,MAAM,OAAO,OAAO,IAAI;oCACxB,qBACE,yPAAC;wCAEC,WAAW,IAAA,oIAAE,EACX,kFACA,gBAAgB,QAAQ,CAAC,OAAO,EAAE,IAC9B,+BACA;;0DAGN,yPAAC;gDACC,MAAK;gDACL,SAAS,gBAAgB,QAAQ,CAAC,OAAO,EAAE;gDAC3C,UAAU,IAAM,aAAa,OAAO,EAAE;gDACtC,WAAU;;;;;;0DAEZ,yPAAC;gDAAK,WAAU;;;;;;0DAChB,yPAAC;;kEACC,yPAAC;wDAAI,WAAU;kEAA6B,OAAO,IAAI;;;;;;kEACvD,yPAAC;wDAAI,WAAU;kEAAyB,OAAO,QAAQ;;;;;;;;;;;;;uCAjBpD,OAAO,EAAE;;;;;gCAqBpB;;;;;;;;;;;;kCAKJ,yPAAC;wBAAI,WAAU;kCACb,cAAA,yPAAC;4BACC,SAAS;4BACT,UAAU;4BACV,WAAW,IAAA,oIAAE,EACX,oGACA,cACI,8CACA;sCAGL,4BACC;;kDACE,yPAAC;wCAAI,WAAU;;;;;;oCAAkE;;6DAInF;;kDACE,yPAAC,wNAAK;wCAAC,WAAU;;;;;;oCAAY;;;;;;;;;;;;;oBAQpC,6BACC,yPAAC;wBAAI,WAAU;kCACb,cAAA,yPAAC;4BAAI,WAAU;;8CACb,yPAAC;oCAAI,WAAU;;;;;;8CACf,yPAAC;;sDACC,yPAAC;4CAAI,WAAU;sDAA4B;;;;;;sDAC3C,yPAAC;4CAAI,WAAU;sDAA6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAUtD,yPAAC;gBAAI,WAAU;;kCACb,yPAAC;wBAAG,WAAU;kCAAiC;;;;;;kCAC/C,yPAAC;wBAAG,WAAU;;0CACZ,yPAAC;0CAAG;;;;;;0CACJ,yPAAC;0CAAG;;;;;;0CACJ,yPAAC;0CAAG;;;;;;0CACJ,yPAAC;0CAAG;;;;;;;;;;;;;;;;;;;;;;;;AAKd;uCAEe","debugId":null}},
    {"offset": {"line": 4768, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/lib/dashboard/data-generator.ts"],"sourcesContent":["import { \n  ChartData, \n  Dataset, \n  MetricData, \n  TableData, \n  TableHeader, \n  TableRow,\n  SmartInsight,\n  DataPoint,\n  Recommendation \n} from './types';\n\n// 生成模拟图表数据\nexport function generateChartData(type: 'line' | 'bar' | 'pie' | 'area' = 'line'): ChartData {\n  const months = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];\n  const colors = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#06B6D4'];\n  \n  switch (type) {\n    case 'line':\n    case 'area':\n      return {\n        labels: months.slice(0, 6),\n        datasets: [\n          {\n            label: '学习时长',\n            data: [120, 150, 180, 220, 280, 320],\n            borderColor: colors[0],\n            backgroundColor: type === 'area' ? `${colors[0]}20` : colors[0],\n            fill: type === 'area',\n            tension: 0.4\n          },\n          {\n            label: '完成课程',\n            data: [8, 12, 15, 18, 25, 30],\n            borderColor: colors[1],\n            backgroundColor: type === 'area' ? `${colors[1]}20` : colors[1],\n            fill: type === 'area',\n            tension: 0.4\n          }\n        ]\n      };\n    \n    case 'bar':\n      return {\n        labels: ['React', 'Vue', 'Angular', 'Svelte', 'Next.js', 'Nuxt.js'],\n        datasets: [\n          {\n            label: '学习人数',\n            data: [2500, 1800, 1200, 800, 2200, 900],\n            backgroundColor: colors\n          }\n        ]\n      };\n    \n    case 'pie':\n      return {\n        labels: ['前端开发', '后端开发', '数据科学', '移动开发', 'DevOps'],\n        datasets: [\n          {\n            label: '技能分布',\n            data: [35, 28, 15, 12, 10],\n            backgroundColor: colors\n          }\n        ]\n      };\n    \n    default:\n      return generateChartData('line');\n  }\n}\n\n// 生成模拟指标数据\nexport function generateMetricData(type: 'revenue' | 'users' | 'engagement' | 'performance' = 'users'): MetricData {\n  const baseData = {\n    revenue: {\n      value: 125000,\n      label: '总收入',\n      change: 12.5,\n      trend: 'up' as const,\n      target: 150000,\n      unit: '¥',\n      format: 'currency' as const\n    },\n    users: {\n      value: 2847,\n      label: '活跃用户',\n      change: 8.3,\n      trend: 'up' as const,\n      target: 3000,\n      unit: '',\n      format: 'number' as const\n    },\n    engagement: {\n      value: 78.5,\n      label: '学习参与度',\n      change: -2.1,\n      trend: 'down' as const,\n      target: 85,\n      unit: '%',\n      format: 'percentage' as const\n    },\n    performance: {\n      value: 92,\n      label: '系统性能',\n      change: 0,\n      trend: 'stable' as const,\n      target: 95,\n      unit: '%',\n      format: 'percentage' as const\n    }\n  };\n\n  return baseData[type];\n}\n\n// 生成模拟表格数据\nexport function generateTableData(type: 'courses' | 'users' | 'revenue' | 'activity' = 'courses'): TableData {\n  const headers: Record<string, TableHeader[]> = {\n    courses: [\n      { key: 'title', label: '课程名称', type: 'text', sortable: true },\n      { key: 'category', label: '分类', type: 'text', sortable: true },\n      { key: 'students', label: '学员数', type: 'number', sortable: true },\n      { key: 'rating', label: '评分', type: 'number', sortable: true },\n      { key: 'revenue', label: '收入', type: 'currency', sortable: true },\n      { key: 'status', label: '状态', type: 'text', sortable: false }\n    ],\n    users: [\n      { key: 'name', label: '姓名', type: 'text', sortable: true },\n      { key: 'email', label: '邮箱', type: 'text', sortable: true },\n      { key: 'courses', label: '课程数', type: 'number', sortable: true },\n      { key: 'progress', label: '进度', type: 'percentage', sortable: true },\n      { key: 'joined', label: '加入时间', type: 'date', sortable: true },\n      { key: 'status', label: '状态', type: 'text', sortable: false }\n    ],\n    revenue: [\n      { key: 'date', label: '日期', type: 'date', sortable: true },\n      { key: 'course', label: '课程', type: 'text', sortable: true },\n      { key: 'amount', label: '金额', type: 'currency', sortable: true },\n      { key: 'students', label: '学员数', type: 'number', sortable: true },\n      { key: 'conversion', label: '转化率', type: 'percentage', sortable: true },\n      { key: 'source', label: '来源', type: 'text', sortable: true }\n    ],\n    activity: [\n      { key: 'timestamp', label: '时间', type: 'date', sortable: true },\n      { key: 'user', label: '用户', type: 'text', sortable: true },\n      { key: 'action', label: '操作', type: 'text', sortable: true },\n      { key: 'course', label: '课程', type: 'text', sortable: true },\n      { key: 'duration', label: '时长', type: 'duration', sortable: true },\n      { key: 'status', label: '状态', type: 'text', sortable: false }\n    ]\n  };\n\n  const generateRows = (type: string, count: number = 10): TableRow[] => {\n    const rows: TableRow[] = [];\n    \n    for (let i = 1; i <= count; i++) {\n      switch (type) {\n        case 'courses':\n          rows.push({\n            id: `course-${i}`,\n            data: {\n              title: `热门课程 ${i}`,\n              category: ['前端开发', '后端开发', '数据科学', '移动开发'][Math.floor(Math.random() * 4)],\n              students: Math.floor(Math.random() * 1000) + 100,\n              rating: (Math.random() * 2 + 3).toFixed(1),\n              revenue: Math.floor(Math.random() * 50000) + 10000,\n              status: Math.random() > 0.7 ? '热门' : '正常'\n            }\n          });\n          break;\n        \n        case 'users':\n          rows.push({\n            id: `user-${i}`,\n            data: {\n              name: `用户${i}`,\n              email: `user${i}@example.com`,\n              courses: Math.floor(Math.random() * 10) + 1,\n              progress: Math.floor(Math.random() * 100),\n              joined: new Date(2024 - Math.floor(Math.random() * 2), Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1),\n              status: Math.random() > 0.8 ? '活跃' : '正常'\n            }\n          });\n          break;\n        \n        case 'revenue':\n          rows.push({\n            id: `revenue-${i}`,\n            data: {\n              date: new Date(2024, Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1),\n              course: `课程 ${Math.floor(Math.random() * 20) + 1}`,\n              amount: Math.floor(Math.random() * 10000) + 1000,\n              students: Math.floor(Math.random() * 100) + 10,\n              conversion: (Math.random() * 20 + 5).toFixed(1),\n              source: ['直接访问', '搜索引擎', '社交媒体', '推荐'][Math.floor(Math.random() * 4)]\n            }\n          });\n          break;\n        \n        case 'activity':\n          rows.push({\n            id: `activity-${i}`,\n            data: {\n              timestamp: new Date(Date.now() - Math.random() * 86400000 * 30), // 最近30天\n              user: `用户${Math.floor(Math.random() * 100) + 1}`,\n              action: ['开始学习', '完成课程', '发表评论', '获得证书'][Math.floor(Math.random() * 4)],\n              course: `课程 ${Math.floor(Math.random() * 20) + 1}`,\n              duration: Math.floor(Math.random() * 120) + 30,\n              status: Math.random() > 0.9 ? '异常' : '正常'\n            }\n          });\n          break;\n      }\n    }\n    \n    return rows;\n  };\n\n  return {\n    headers: headers[type],\n    rows: generateRows(type),\n    pagination: {\n      enabled: true,\n      pageSize: 10,\n      currentPage: 1,\n      totalItems: 50,\n      showSizeChanger: true,\n      showQuickJumper: true\n    },\n    sorting: {\n      enabled: true,\n      defaultSortField: 'title',\n      defaultSortOrder: 'asc',\n      multiSort: false\n    }\n  };\n}\n\n// 生成智能洞察数据\nexport function generateSmartInsights(count: number = 5): SmartInsight[] {\n  const insights: SmartInsight[] = [];\n  const types: Array<'trend' | 'anomaly' | 'opportunity' | 'risk' | 'achievement'> = \n    ['trend', 'anomaly', 'opportunity', 'risk', 'achievement'];\n  \n  const severities: Array<'low' | 'medium' | 'high' | 'critical'> = \n    ['low', 'medium', 'high', 'critical'];\n  \n  const categories = ['学习进度', '用户参与', '收入分析', '系统性能', '内容质量'];\n  \n  for (let i = 1; i <= count; i++) {\n    const type = types[Math.floor(Math.random() * types.length)];\n    const severity = severities[Math.floor(Math.random() * severities.length)];\n    const category = categories[Math.floor(Math.random() * categories.length)];\n    \n    const dataPoints: DataPoint[] = [\n      {\n        label: '当前值',\n        value: Math.floor(Math.random() * 1000) + 100,\n        change: (Math.random() * 40 - 20).toFixed(1),\n        trend: Math.random() > 0.5 ? 'up' : 'down',\n        timestamp: new Date()\n      },\n      {\n        label: '对比值',\n        value: Math.floor(Math.random() * 800) + 200,\n        change: (Math.random() * 30 - 15).toFixed(1),\n        trend: Math.random() > 0.5 ? 'up' : 'down',\n        timestamp: new Date(Date.now() - 86400000 * 7) // 一周前\n      }\n    ];\n    \n    const recommendations: Recommendation[] = [\n      {\n        id: `rec-${i}-1`,\n        text: `建议优化${category}相关策略`,\n        priority: severity === 'critical' ? 'high' : severity === 'high' ? 'medium' : 'low',\n        estimatedImpact: `预计提升${(Math.random() * 20 + 5).toFixed(1)}%`,\n        actionUrl: `/dashboard/analytics?focus=${category}`,\n        actionText: '查看详情'\n      }\n    ];\n    \n    if (Math.random() > 0.5) {\n      recommendations.push({\n        id: `rec-${i}-2`,\n        text: `考虑调整${category}配置参数`,\n        priority: 'medium',\n        estimatedImpact: `预计改善${(Math.random() * 15 + 3).toFixed(1)}%`,\n        actionUrl: `/settings/${category.toLowerCase()}`,\n        actionText: '配置设置'\n      });\n    }\n    \n    insights.push({\n      id: `insight-${i}`,\n      type,\n      title: `${category} - ${type === 'trend' ? '趋势分析' : \n                           type === 'anomaly' ? '异常检测' :\n                           type === 'opportunity' ? '机会识别' :\n                           type === 'risk' ? '风险评估' : '成就达成'}`,\n      description: `在${category}方面发现${type === 'trend' ? '重要趋势' : \n                                      type === 'anomaly' ? '异常模式' :\n                                      type === 'opportunity' ? '优化机会' :\n                                      type === 'risk' ? '潜在风险' : '显著成就'}，需要关注`,\n      severity,\n      dataPoints,\n      recommendations,\n      timestamp: new Date(Date.now() - Math.random() * 86400000 * 7), // 最近一周\n      category,\n      tags: [category.toLowerCase(), type, severity],\n      confidence: Math.random() * 0.3 + 0.7, // 70-100%\n      autoActionable: Math.random() > 0.3\n    });\n  }\n  \n  return insights.sort((a, b) => {\n    const severityOrder = { critical: 4, high: 3, medium: 2, low: 1 };\n    return severityOrder[b.severity] - severityOrder[a.severity];\n  });\n}\n\n// 生成实时数据更新\nexport function generateRealtimeUpdate() {\n  const metrics = ['users', 'revenue', 'engagement', 'performance'];\n  const metric = metrics[Math.floor(Math.random() * metrics.length)];\n  \n  return {\n    type: 'update',\n    metric,\n    data: generateMetricData(metric as any),\n    timestamp: new Date()\n  };\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5293, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/hooks/useSmartDashboard.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { \n  DashboardWidget, \n  DashboardLayout, \n  DashboardData, \n  SmartInsight,\n  ChartData,\n  MetricData,\n  TableData \n} from '@/app/lib/dashboard/types';\nimport {\n  generateChartData,\n  generateMetricData,\n  generateTableData,\n  generateSmartInsights,\n  generateRealtimeUpdate\n} from '@/app/lib/dashboard/data-generator';\n\ninterface UseSmartDashboardProps {\n  layoutId?: string;\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n  enableInsights?: boolean;\n  enableRealtime?: boolean;\n}\n\ninterface UseSmartDashboardReturn {\n  layout: DashboardLayout | null;\n  data: DashboardData;\n  insights: SmartInsight[];\n  loading: boolean;\n  error: string | null;\n  refresh: () => Promise<void>;\n  updateWidget: (widgetId: string, data: any) => void;\n  updateLayout: (layout: DashboardLayout) => void;\n  refreshWidget: (widgetId: string) => Promise<void>;\n  exportData: (format: 'json' | 'csv' | 'pdf') => void;\n}\n\nexport function useSmartDashboard({\n  layoutId = 'default',\n  autoRefresh = true,\n  refreshInterval = 30000, // 30秒\n  enableInsights = true,\n  enableRealtime = true\n}: UseSmartDashboardProps): UseSmartDashboardReturn {\n  const [layout, setLayout] = useState<DashboardLayout | null>(null);\n  const [data, setData] = useState<DashboardData>({\n    widgets: {},\n    metadata: {\n      lastUpdated: new Date(),\n      refreshStatus: {},\n      totalWidgets: 0,\n      activeWidgets: 0\n    }\n  });\n  const [insights, setInsights] = useState<SmartInsight[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const refreshIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const realtimeIntervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  // 生成默认布局\n  const generateDefaultLayout = useCallback((): DashboardLayout => {\n    return {\n      id: 'default',\n      name: '智能仪表板',\n      description: 'AI驱动的智能数据仪表板',\n      widgets: [\n        {\n          id: 'revenue-chart',\n          type: 'chart',\n          title: '收入趋势',\n          dataSource: 'revenue',\n          config: {\n            chartType: 'line',\n            colorScheme: ['#3B82F6', '#10B981'],\n            showLegend: true,\n            showGrid: true,\n            animation: true\n          },\n          size: 'large',\n          position: { x: 0, y: 0, w: 8, h: 4 },\n          refreshInterval: 30000,\n          interactive: true\n        },\n        {\n          id: 'active-users',\n          type: 'metric',\n          title: '活跃用户',\n          dataSource: 'users',\n          config: {\n            format: 'number',\n            showTrend: true,\n            colorScheme: ['#3B82F6']\n          },\n          size: 'small',\n          position: { x: 8, y: 0, w: 4, h: 2 },\n          refreshInterval: 15000\n        },\n        {\n          id: 'engagement-rate',\n          type: 'metric',\n          title: '学习参与度',\n          dataSource: 'engagement',\n          config: {\n            format: 'percentage',\n            showTrend: true,\n            colorScheme: ['#10B981']\n          },\n          size: 'small',\n          position: { x: 8, y: 2, w: 4, h: 2 },\n          refreshInterval: 15000\n        },\n        {\n          id: 'top-courses',\n          type: 'table',\n          title: '热门课程',\n          dataSource: 'courses',\n          config: {\n            showPagination: true,\n            pageSize: 5,\n            enableSorting: true\n          },\n          size: 'medium',\n          position: { x: 0, y: 4, w: 6, h: 6 },\n          refreshInterval: 60000\n        },\n        {\n          id: 'learning-progress',\n          type: 'progress',\n          title: '学习进度',\n          dataSource: 'progress',\n          config: {\n            showPercentage: true,\n            colorScheme: ['#F59E0B', '#10B981', '#3B82F6']\n          },\n          size: 'medium',\n          position: { x: 6, y: 4, w: 6, h: 6 },\n          refreshInterval: 30000\n        }\n      ],\n      gridConfig: {\n        cols: 12,\n        rowHeight: 80,\n        margin: [16, 16],\n        containerPadding: [0, 0]\n      },\n      theme: 'light',\n      breakpoints: {\n        lg: 1200,\n        md: 996,\n        sm: 768,\n        xs: 480,\n        xxs: 0\n      },\n      layouts: {\n        lg: [],\n        md: [],\n        sm: [],\n        xs: [],\n        xxs: []\n      }\n    };\n  }, []);\n\n  // 获取组件数据\n  const fetchWidgetData = useCallback(async (widget: DashboardWidget): Promise<any> => {\n    try {\n      switch (widget.type) {\n        case 'chart':\n          return generateChartData(widget.config.chartType || 'line');\n        \n        case 'metric':\n          return generateMetricData(widget.dataSource as any);\n        \n        case 'table':\n          return generateTableData(widget.dataSource as any);\n        \n        case 'progress':\n          return {\n            total: 100,\n            completed: Math.floor(Math.random() * 100),\n            inProgress: Math.floor(Math.random() * 50),\n            notStarted: Math.floor(Math.random() * 30)\n          };\n        \n        case 'activity':\n          return Array.from({ length: 10 }, (_, i) => ({\n            id: `activity-${i}`,\n            user: `用户${Math.floor(Math.random() * 100) + 1}`,\n            action: ['开始学习', '完成课程', '发表评论', '获得证书'][Math.floor(Math.random() * 4)],\n            timestamp: new Date(Date.now() - Math.random() * 86400000)\n          }));\n        \n        case 'calendar':\n          return {\n            events: Array.from({ length: 20 }, (_, i) => ({\n              id: `event-${i}`,\n              title: `学习活动 ${i + 1}`,\n              date: new Date(Date.now() + Math.random() * 86400000 * 30),\n              type: ['课程', '考试', '讨论', '项目'][Math.floor(Math.random() * 4)]\n            }))\n          };\n        \n        default:\n          return {};\n      }\n    } catch (error) {\n      console.error(`Failed to fetch data for widget ${widget.id}:`, error);\n      throw error;\n    }\n  }, []);\n\n  // 刷新所有数据\n  const refreshData = useCallback(async () => {\n    if (!layout) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const widgetData: Record<string, any> = {};\n      const refreshStatus: Record<string, 'loading' | 'success' | 'error'> = {};\n\n      // 并行获取所有组件数据\n      const dataPromises = layout.widgets.map(async (widget) => {\n        refreshStatus[widget.id] = 'loading';\n        try {\n          const data = await fetchWidgetData(widget);\n          widgetData[widget.id] = data;\n          refreshStatus[widget.id] = 'success';\n        } catch (error) {\n          refreshStatus[widget.id] = 'error';\n          console.error(`Error refreshing widget ${widget.id}:`, error);\n        }\n      });\n\n      await Promise.all(dataPromises);\n\n      // 生成智能洞察\n      if (enableInsights) {\n        const newInsights = generateSmartInsights(5);\n        setInsights(newInsights);\n      }\n\n      setData({\n        widgets: widgetData,\n        metadata: {\n          lastUpdated: new Date(),\n          refreshStatus,\n          totalWidgets: layout.widgets.length,\n          activeWidgets: Object.values(refreshStatus).filter(status => status === 'success').length\n        }\n      });\n\n    } catch (error) {\n      setError(error instanceof Error ? error.message : '获取仪表板数据失败');\n      console.error('Failed to refresh dashboard data:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [layout, enableInsights, fetchWidgetData]);\n\n  // 刷新单个组件\n  const refreshWidget = useCallback(async (widgetId: string) => {\n    if (!layout) return;\n\n    const widget = layout.widgets.find(w => w.id === widgetId);\n    if (!widget) return;\n\n    try {\n      setData(prev => ({\n        ...prev,\n        metadata: {\n          ...prev.metadata,\n          refreshStatus: {\n            ...prev.metadata.refreshStatus,\n            [widgetId]: 'loading'\n          }\n        }\n      }));\n\n      const widgetData = await fetchWidgetData(widget);\n\n      setData(prev => ({\n        ...prev,\n        widgets: {\n          ...prev.widgets,\n          [widgetId]: widgetData\n        },\n        metadata: {\n          ...prev.metadata,\n          refreshStatus: {\n            ...prev.metadata.refreshStatus,\n            [widgetId]: 'success'\n          },\n          lastUpdated: new Date()\n        }\n      }));\n\n    } catch (error) {\n      setData(prev => ({\n        ...prev,\n        metadata: {\n          ...prev.metadata,\n          refreshStatus: {\n            ...prev.metadata.refreshStatus,\n            [widgetId]: 'error'\n          }\n        }\n      }));\n      console.error(`Failed to refresh widget ${widgetId}:`, error);\n    }\n  }, [layout, fetchWidgetData]);\n\n  // 更新组件数据\n  const updateWidget = useCallback((widgetId: string, newData: any) => {\n    setData(prev => ({\n      ...prev,\n      widgets: {\n        ...prev.widgets,\n        [widgetId]: newData\n      }\n    }));\n  }, []);\n\n  // 更新布局\n  const updateLayout = useCallback((newLayout: DashboardLayout) => {\n    setLayout(newLayout);\n  }, []);\n\n  // 导出数据\n  const exportData = useCallback((format: 'json' | 'csv' | 'pdf') => {\n    const dataToExport = {\n      layout,\n      data,\n      insights,\n      exportedAt: new Date()\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `dashboard-data-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'csv':\n        // 简化的CSV导出，实际项目中需要更复杂的逻辑\n        const csvData = Object.entries(data.widgets).map(([key, value]) => ({\n          widget: key,\n          data: JSON.stringify(value)\n        }));\n        const csvContent = \"data:text/csv;charset=utf-8,\" + \n          \"Widget,Data\\n\" + \n          csvData.map(row => `\"${row.widget}\",\"${row.data}\"`).join(\"\\n\");\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `dashboard-data-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n      \n      case 'pdf':\n        // 这里需要集成PDF生成库，如jsPDF\n        console.log('PDF export would be implemented here');\n        break;\n    }\n  }, [layout, data, insights]);\n\n  // 初始化\n  useEffect(() => {\n    const initDashboard = async () => {\n      try {\n        setLoading(true);\n        \n        // 生成默认布局\n        const defaultLayout = generateDefaultLayout();\n        setLayout(defaultLayout);\n        \n        // 初始数据加载\n        await refreshData();\n        \n      } catch (error) {\n        setError(error instanceof Error ? error.message : '初始化仪表板失败');\n        console.error('Failed to initialize dashboard:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    initDashboard();\n  }, []);\n\n  // 自动刷新\n  useEffect(() => {\n    if (!autoRefresh) return;\n\n    // 清除现有定时器\n    if (refreshIntervalRef.current) {\n      clearInterval(refreshIntervalRef.current);\n    }\n\n    // 设置新的定时器\n    refreshIntervalRef.current = setInterval(() => {\n      refreshData();\n    }, refreshInterval);\n\n    return () => {\n      if (refreshIntervalRef.current) {\n        clearInterval(refreshIntervalRef.current);\n      }\n    };\n  }, [autoRefresh, refreshInterval, refreshData]);\n\n  // 实时更新\n  useEffect(() => {\n    if (!enableRealtime) return;\n\n    if (realtimeIntervalRef.current) {\n      clearInterval(realtimeIntervalRef.current);\n    }\n\n    realtimeIntervalRef.current = setInterval(() => {\n      const update = generateRealtimeUpdate();\n      \n      // 更新对应组件的数据\n      setData(prev => {\n        const currentWidgetData = prev.widgets[update.metric];\n        if (currentWidgetData) {\n          return {\n            ...prev,\n            widgets: {\n              ...prev.widgets,\n              [update.metric]: update.data\n            }\n          };\n        }\n        return prev;\n      });\n    }, 5000); // 5秒更新一次\n\n    return () => {\n      if (realtimeIntervalRef.current) {\n        clearInterval(realtimeIntervalRef.current);\n      }\n    };\n  }, [enableRealtime]);\n\n  return {\n    layout,\n    data,\n    insights,\n    loading,\n    error,\n    refresh: refreshData,\n    updateWidget,\n    updateLayout,\n    refreshWidget,\n    exportData\n  };\n}\n\n// 演示用的Hook\nexport function useDemoDashboard() {\n  return useSmartDashboard({\n    layoutId: 'demo',\n    autoRefresh: true,\n    refreshInterval: 30000,\n    enableInsights: true,\n    enableRealtime: true\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5769, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/dashboard/analytics/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { ModularDashboardBuilder } from '@/app/components/ModularDashboardBuilder';\nimport { AIInsightEngine } from '@/app/components/AIInsightEngine';\nimport { useDemoDashboard } from '@/app/hooks/useSmartDashboard';\n\nexport default function AnalyticsDashboard() {\n  const [activeTab, setActiveTab] = useState<'dashboard' | 'insights'>('dashboard');\n  const { widgets, isLoading, error, refreshData } = useDemoDashboard();\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">智能数据分析仪表板</h1>\n          <p className=\"text-gray-600\">实时监控学习进度，获取AI驱动的业务洞察</p>\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"mb-6\">\n          <nav className=\"flex space-x-1 bg-white rounded-lg p-1 shadow-sm\">\n            <button\n              onClick={() => setActiveTab('dashboard')}\n              className={`px-4 py-2 rounded-md font-medium transition-colors ${\n                activeTab === 'dashboard'\n                  ? 'bg-blue-500 text-white'\n                  : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'\n              }`}\n            >\n              仪表板\n            </button>\n            <button\n              onClick={() => setActiveTab('insights')}\n              className={`px-4 py-2 rounded-md font-medium transition-colors ${\n                activeTab === 'insights'\n                  ? 'bg-blue-500 text-white'\n                  : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'\n              }`}\n            >\n              AI洞察\n            </button>\n          </nav>\n        </div>\n\n        {/* Content */}\n        {activeTab === 'dashboard' && (\n          <div className=\"space-y-6\">\n            {/* Dashboard Stats */}\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">总访问量</div>\n                <div className=\"text-2xl font-bold text-gray-900\">12,543</div>\n                <div className=\"text-sm text-green-600\">+12.5%</div>\n              </div>\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">活跃用户</div>\n                <div className=\"text-2xl font-bold text-gray-900\">3,247</div>\n                <div className=\"text-sm text-green-600\">+8.2%</div>\n              </div>\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">课程完成率</div>\n                <div className=\"text-2xl font-bold text-gray-900\">78.3%</div>\n                <div className=\"text-sm text-blue-600\">+3.1%</div>\n              </div>\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">平均学习时长</div>\n                <div className=\"text-2xl font-bold text-gray-900\">2.4h</div>\n                <div className=\"text-sm text-red-600\">-5.3%</div>\n              </div>\n            </div>\n\n            {/* Modular Dashboard Builder */}\n            <ModularDashboardBuilder />\n          </div>\n        )}\n\n        {activeTab === 'insights' && (\n          <div className=\"space-y-6\">\n            <AIInsightEngine />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,4NAAQ,EAA2B;IACrE,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,IAAA,gKAAgB;IAEnE,qBACE,yPAAC;QAAI,WAAU;kBACb,cAAA,yPAAC;YAAI,WAAU;;8BAEb,yPAAC;oBAAI,WAAU;;sCACb,yPAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,yPAAC;4BAAE,WAAU;sCAAgB;;;;;;;;;;;;8BAI/B,yPAAC;oBAAI,WAAU;8BACb,cAAA,yPAAC;wBAAI,WAAU;;0CACb,yPAAC;gCACC,SAAS,IAAM,aAAa;gCAC5B,WAAW,CAAC,mDAAmD,EAC7D,cAAc,cACV,2BACA,uDACJ;0CACH;;;;;;0CAGD,yPAAC;gCACC,SAAS,IAAM,aAAa;gCAC5B,WAAW,CAAC,mDAAmD,EAC7D,cAAc,aACV,2BACA,uDACJ;0CACH;;;;;;;;;;;;;;;;;gBAOJ,cAAc,6BACb,yPAAC;oBAAI,WAAU;;sCAEb,yPAAC;4BAAI,WAAU;;8CACb,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;4CAAI,WAAU;sDAAyC;;;;;;sDACxD,yPAAC;4CAAI,WAAU;sDAAmC;;;;;;sDAClD,yPAAC;4CAAI,WAAU;sDAAyB;;;;;;;;;;;;8CAE1C,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;4CAAI,WAAU;sDAAyC;;;;;;sDACxD,yPAAC;4CAAI,WAAU;sDAAmC;;;;;;sDAClD,yPAAC;4CAAI,WAAU;sDAAyB;;;;;;;;;;;;8CAE1C,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;4CAAI,WAAU;sDAAyC;;;;;;sDACxD,yPAAC;4CAAI,WAAU;sDAAmC;;;;;;sDAClD,yPAAC;4CAAI,WAAU;sDAAwB;;;;;;;;;;;;8CAEzC,yPAAC;oCAAI,WAAU;;sDACb,yPAAC;4CAAI,WAAU;sDAAyC;;;;;;sDACxD,yPAAC;4CAAI,WAAU;sDAAmC;;;;;;sDAClD,yPAAC;4CAAI,WAAU;sDAAuB;;;;;;;;;;;;;;;;;;sCAK1C,yPAAC,mLAAuB;;;;;;;;;;;gBAI3B,cAAc,4BACb,yPAAC;oBAAI,WAAU;8BACb,cAAA,yPAAC,mKAAe;;;;;;;;;;;;;;;;;;;;;AAM5B","debugId":null}}]
}