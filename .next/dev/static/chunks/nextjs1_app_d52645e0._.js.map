{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\nexport function formatDate(date: Date | string): string {\n  const d = new Date(date)\n  return d.toLocaleDateString('zh-CN', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  })\n}\n\nexport function formatDuration(minutes: number): string {\n  if (minutes < 60) return `${minutes}分钟`\n  const hours = Math.floor(minutes / 60)\n  const remainingMinutes = minutes % 60\n  return remainingMinutes > 0 ? `${hours}小时${remainingMinutes}分钟` : `${hours}小时`\n}\n\nexport function formatCurrency(\n  amount: number,\n  currency: string = 'USD',\n  locale: string = 'en-US'\n): string {\n  // amounts are stored in cents; convert to currency units\n  return new Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency,\n  }).format(amount / 100);\n}\n\nexport function generateYAxis<T extends { revenue: number }>(\n  revenueData: T[] | undefined | null\n): { yAxisLabels: string[]; topLabel: number } {\n  const hasData = Array.isArray(revenueData) && revenueData.length > 0;\n  const maxRevenue = hasData ? Math.max(...revenueData.map((r) => r.revenue)) : 0;\n\n  // Round up to a nice scale (nearest 1000)\n  const topLabel = maxRevenue > 0 ? Math.ceil(maxRevenue / 1000) * 1000 : 0;\n\n  // Build 5 evenly spaced labels from top → 0\n  const steps = 4;\n  const yAxisLabels: string[] = [];\n  for (let i = steps; i >= 0; i--) {\n    const value = topLabel > 0 ? Math.round((topLabel / steps) * i) : 0;\n    yAxisLabels.push(value.toLocaleString());\n  }\n\n  return { yAxisLabels, topLabel };\n}\n\nexport function formatDateToLocal(\n  date: Date | string,\n  locale: string = 'en-US'\n): string {\n  const d = new Date(date)\n  return new Intl.DateTimeFormat(locale, {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n  }).format(d)\n}\n\nexport function generatePagination(\n  currentPage: number,\n  totalPages: number\n): Array<number | string> {\n  const pages: Array<number | string> = []\n  const delta = 2\n  const start = Math.max(1, currentPage - delta)\n  const end = Math.min(totalPages, currentPage + delta)\n  const range: number[] = []\n\n  for (let i = start; i <= end; i++) range.push(i)\n\n  if (range[0] !== 1) {\n    pages.push(1)\n    if (range[0] > 2) pages.push('...')\n  }\n\n  pages.push(...range)\n\n  if (range[range.length - 1] !== totalPages) {\n    if (range[range.length - 1] < totalPages - 1) pages.push('...')\n    pages.push(totalPages)\n  }\n\n  return pages\n}\n\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number\n): T {\n  let timeout: NodeJS.Timeout | null = null\n  return ((...args: Parameters<T>) => {\n    if (timeout) clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }) as T\n}\n\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number\n): T {\n  let inThrottle: boolean = false\n  return ((...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args)\n      inThrottle = true\n      setTimeout(() => inThrottle = false, limit)\n    }\n  }) as T\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,kPAAO,EAAC,IAAA,4MAAI,EAAC;AACtB;AAEO,SAAS,WAAW,IAAmB;IAC5C,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,EAAE,kBAAkB,CAAC,SAAS;QACnC,MAAM;QACN,OAAO;QACP,KAAK;IACP;AACF;AAEO,SAAS,eAAe,OAAe;IAC5C,IAAI,UAAU,IAAI,OAAO,GAAG,QAAQ,EAAE,CAAC;IACvC,MAAM,QAAQ,KAAK,KAAK,CAAC,UAAU;IACnC,MAAM,mBAAmB,UAAU;IACnC,OAAO,mBAAmB,IAAI,GAAG,MAAM,EAAE,EAAE,iBAAiB,EAAE,CAAC,GAAG,GAAG,MAAM,EAAE,CAAC;AAChF;AAEO,SAAS,eACd,MAAc,EACd,WAAmB,KAAK,EACxB,SAAiB,OAAO;IAExB,yDAAyD;IACzD,OAAO,IAAI,KAAK,YAAY,CAAC,QAAQ;QACnC,OAAO;QACP;IACF,GAAG,MAAM,CAAC,SAAS;AACrB;AAEO,SAAS,cACd,WAAmC;IAEnC,MAAM,UAAU,MAAM,OAAO,CAAC,gBAAgB,YAAY,MAAM,GAAG;IACnE,MAAM,aAAa,UAAU,KAAK,GAAG,IAAI,YAAY,GAAG,CAAC,CAAC,IAAM,EAAE,OAAO,KAAK;IAE9E,0CAA0C;IAC1C,MAAM,WAAW,aAAa,IAAI,KAAK,IAAI,CAAC,aAAa,QAAQ,OAAO;IAExE,4CAA4C;IAC5C,MAAM,QAAQ;IACd,MAAM,cAAwB,EAAE;IAChC,IAAK,IAAI,IAAI,OAAO,KAAK,GAAG,IAAK;QAC/B,MAAM,QAAQ,WAAW,IAAI,KAAK,KAAK,CAAC,AAAC,WAAW,QAAS,KAAK;QAClE,YAAY,IAAI,CAAC,MAAM,cAAc;IACvC;IAEA,OAAO;QAAE;QAAa;IAAS;AACjC;AAEO,SAAS,kBACd,IAAmB,EACnB,SAAiB,OAAO;IAExB,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,IAAI,KAAK,cAAc,CAAC,QAAQ;QACrC,MAAM;QACN,OAAO;QACP,KAAK;IACP,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,mBACd,WAAmB,EACnB,UAAkB;IAElB,MAAM,QAAgC,EAAE;IACxC,MAAM,QAAQ;IACd,MAAM,QAAQ,KAAK,GAAG,CAAC,GAAG,cAAc;IACxC,MAAM,MAAM,KAAK,GAAG,CAAC,YAAY,cAAc;IAC/C,MAAM,QAAkB,EAAE;IAE1B,IAAK,IAAI,IAAI,OAAO,KAAK,KAAK,IAAK,MAAM,IAAI,CAAC;IAE9C,IAAI,KAAK,CAAC,EAAE,KAAK,GAAG;QAClB,MAAM,IAAI,CAAC;QACX,IAAI,KAAK,CAAC,EAAE,GAAG,GAAG,MAAM,IAAI,CAAC;IAC/B;IAEA,MAAM,IAAI,IAAI;IAEd,IAAI,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE,KAAK,YAAY;QAC1C,IAAI,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE,GAAG,aAAa,GAAG,MAAM,IAAI,CAAC;QACzD,MAAM,IAAI,CAAC;IACb;IAEA,OAAO;AACT;AAEO,SAAS,SACd,IAAO,EACP,IAAY;IAEZ,IAAI,UAAiC;IACrC,OAAQ,CAAC,GAAG;QACV,IAAI,SAAS,aAAa;QAC1B,UAAU,WAAW,IAAM,QAAQ,OAAO;IAC5C;AACF;AAEO,SAAS,SACd,IAAO,EACP,KAAa;IAEb,IAAI,aAAsB;IAC1B,OAAQ,CAAC,GAAG;QACV,IAAI,CAAC,YAAY;YACf,QAAQ;YACR,aAAa;YACb,WAAW,IAAM,aAAa,OAAO;QACvC;IACF;AACF","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartChartWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback } from 'react';\nimport { Line, Bar, Pie, Scatter, Radar } from 'react-chartjs-2';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  BarElement,\n  ArcElement,\n  Title,\n  Tooltip,\n  Legend,\n  Filler,\n  RadialLinearScale,\n  ChartOptions\n} from 'chart.js';\nimport { RefreshCw, Download, Settings, TrendingUp } from 'lucide-react';\nimport { DashboardWidget, ChartData } from '../lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  BarElement,\n  ArcElement,\n  Title,\n  Tooltip,\n  Legend,\n  Filler,\n  RadialLinearScale\n);\n\ninterface SmartChartWidgetProps {\n  widget: DashboardWidget;\n  data: ChartData;\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'png' | 'csv' | 'json') => void;\n  onSettings?: () => void;\n  className?: string;\n}\n\nexport function SmartChartWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  className\n}: SmartChartWidgetProps) {\n  const [showSettings, setShowSettings] = useState(false);\n  const [selectedDataset, setSelectedDataset] = useState(0);\n\n  const { config } = widget;\n  const chartType = config.chartType || 'line';\n\n  // 图表配置选项\n  const getChartOptions = useCallback(() => {\n    const baseOptions = {\n      responsive: config.responsive !== false,\n      maintainAspectRatio: false,\n      // 明确限制为 false | undefined，避免被推断为 boolean\n      animation: config.animation === false ? (false as false) : undefined,\n      plugins: {\n        legend: {\n          display: config.showLegend !== false,\n          position: 'top' as const,\n        },\n        title: {\n          display: false,\n        },\n        tooltip: {\n          enabled: true,\n          backgroundColor: 'rgba(0, 0, 0, 0.8)',\n          titleColor: '#fff',\n          bodyColor: '#fff',\n          borderColor: '#374151',\n          borderWidth: 1,\n          cornerRadius: 6,\n        }\n      },\n      scales: {\n        x: {\n          display: config.showGrid !== false,\n          grid: {\n            display: config.showGrid !== false,\n            color: '#E5E7EB'\n          }\n        },\n        y: {\n          display: config.showGrid !== false,\n          grid: {\n            display: config.showGrid !== false,\n            color: '#E5E7EB'\n          }\n        }\n      }\n    };\n\n    // 根据图表类型调整配置\n    switch (chartType) {\n      case 'pie': {\n        // 移除 scales 属性以匹配 Pie 的类型\n        const { scales, ...rest } = baseOptions;\n        return rest;\n      }\n      case 'radar':\n        return {\n          ...baseOptions,\n          scales: {\n            r: {\n              beginAtZero: true,\n              grid: {\n                color: '#E5E7EB'\n              }\n            }\n          }\n        };\n      default:\n        return baseOptions;\n    }\n  }, [chartType, config]);\n\n  // 渲染图表\n  const renderChart = useCallback(() => {\n    if (loading || error || !data) {\n      return null;\n    }\n\n    const effectiveData = chartType === 'area'\n      ? { ...data, datasets: data.datasets.map((ds) => ({ ...ds, fill: true })) }\n      : data;\n\n    const options = getChartOptions();\n\n    switch (chartType) {\n      case 'line':\n        return (\n          <Line\n            data={effectiveData}\n            options={options as ChartOptions<'line'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'bar':\n        return (\n          <Bar\n            data={effectiveData}\n            options={options as ChartOptions<'bar'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'pie':\n        return (\n          <Pie\n            data={effectiveData}\n            options={options as ChartOptions<'pie'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'area':\n        return (\n          <Line\n            data={effectiveData}\n            options={options as ChartOptions<'line'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'scatter':\n        return (\n          <Scatter\n            data={effectiveData}\n            options={options as ChartOptions<'scatter'>}\n            className=\"w-full h-full\"\n          />\n        );\n      case 'radar':\n        return (\n          <Radar\n            data={effectiveData}\n            options={options as ChartOptions<'radar'>}\n            className=\"w-full h-full\"\n          />\n        );\n      default:\n        return (\n          <Line\n            data={effectiveData}\n            options={options as ChartOptions<'line'>}\n            className=\"w-full h-full\"\n          />\n        );\n    }\n  }, [chartType, data, loading, error, getChartOptions]);\n\n  // 导出功能\n  const handleExport = useCallback((format: 'png' | 'csv' | 'json') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    // 默认导出逻辑\n    switch (format) {\n      case 'csv':\n        const csvData = data.datasets.map((dataset, index) => ({\n          label: dataset.label,\n          data: dataset.data.join(',')\n        }));\n        const csvContent = \"data:text/csv;charset=utf-8,\" + \n          \"Label,Data\\n\" + \n          csvData.map(row => `\"${row.label}\",\"${row.data}\"`).join(\"\\n\");\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-data-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n      \n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-data-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'png':\n        // 这里需要实现图表截图功能\n        console.log('PNG export would be implemented with canvas');\n        break;\n    }\n  }, [data, onExport, widget.id]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n          </div>\n        </div>\n        <div className=\"h-64 bg-gray-100 rounded-lg animate-pulse\" />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n        </div>\n        <div className=\"h-64 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n          <div className=\"text-center\">\n            <div className=\"text-red-500 mb-2\">⚠️</div>\n            <p className=\"text-red-700 font-medium\">{error}</p>\n            <button\n              onClick={onRefresh}\n              className=\"mt-2 px-4 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700\"\n            >\n              重试\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n          {widget.description && (\n            <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n            title=\"刷新\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n          \n          <div className=\"relative\">\n            <button\n              onClick={() => setShowSettings(!showSettings)}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"设置\"\n            >\n              <Settings className=\"h-4 w-4\" />\n            </button>\n            \n            {showSettings && (\n              <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                <div className=\"py-1\">\n                  <button\n                    onClick={() => {\n                      handleExport('csv');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出CSV\n                  </button>\n                  <button\n                    onClick={() => {\n                      handleExport('json');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出JSON\n                  </button>\n                  {onSettings && (\n                    <button\n                      onClick={() => {\n                        onSettings();\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Settings className=\"h-4 w-4 inline mr-2\" />\n                      高级设置\n                    </button>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* 内容区域 */}\n      <div className=\"p-6\">\n        <div className=\"h-80\">\n          {renderChart()}\n        </div>\n        \n        {/* 数据摘要 */}\n        {data.datasets && data.datasets.length > 0 && (\n          <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <TrendingUp className=\"h-4 w-4 text-green-600\" />\n              <span className=\"text-sm font-medium text-gray-900\">数据摘要</span>\n            </div>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n              {data.datasets.map((dataset, index) => {\n                const total = dataset.data.reduce((sum, value) => sum + (typeof value === 'number' ? value : 0), 0);\n                const average = total / dataset.data.length;\n                return (\n                  <div key={index} className=\"text-center\">\n                    <div className=\"text-lg font-semibold text-gray-900\">\n                      {dataset.label}\n                    </div>\n                    <div className=\"text-xs text-gray-600\">\n                      总计: {total.toLocaleString()}\n                    </div>\n                    <div className=\"text-xs text-gray-600\">\n                      平均: {average.toFixed(1)}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default SmartChartWidget;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 812, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartMetricWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback } from 'react';\nimport { TrendingUp, TrendingDown, Minus, RefreshCw, Download, Settings } from 'lucide-react';\nimport { DashboardWidget } from '@/app/lib/dashboard/types';\nimport { MetricData } from '@/app/lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface SmartMetricWidgetProps {\n  widget: DashboardWidget;\n  data: MetricData;\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'json' | 'csv') => void;\n  onSettings?: () => void;\n  className?: string;\n}\n\nexport function SmartMetricWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  className\n}: SmartMetricWidgetProps) {\n  const [showSettings, setShowSettings] = useState(false);\n\n  const formatValue = useCallback((value: number, format?: string, unit?: string) => {\n    let formatted = value.toString();\n    \n    switch (format) {\n      case 'currency':\n        formatted = new Intl.NumberFormat('zh-CN', {\n          style: 'currency',\n          currency: 'CNY',\n          minimumFractionDigits: 0,\n          maximumFractionDigits: 0\n        }).format(value);\n        break;\n      \n      case 'percentage':\n        formatted = `${value.toFixed(1)}%`;\n        break;\n      \n      case 'duration':\n        if (value < 60) {\n          formatted = `${value}分钟`;\n        } else {\n          const hours = Math.floor(value / 60);\n          const minutes = value % 60;\n          formatted = minutes > 0 ? `${hours}小时${minutes}分钟` : `${hours}小时`;\n        }\n        break;\n      \n      default:\n        formatted = new Intl.NumberFormat('zh-CN').format(value);\n        break;\n    }\n    \n    return formatted;\n  }, []);\n\n  const getTrendIcon = useCallback((trend: 'up' | 'down' | 'stable') => {\n    switch (trend) {\n      case 'up':\n        return <TrendingUp className=\"h-4 w-4\" />;\n      case 'down':\n        return <TrendingDown className=\"h-4 w-4\" />;\n      case 'stable':\n        return <Minus className=\"h-4 w-4\" />;\n      default:\n        return null;\n    }\n  }, []);\n\n  const getTrendColor = useCallback((trend: 'up' | 'down' | 'stable') => {\n    switch (trend) {\n      case 'up':\n        return 'text-green-600';\n      case 'down':\n        return 'text-red-600';\n      case 'stable':\n        return 'text-gray-600';\n      default:\n        return 'text-gray-600';\n    }\n  }, []);\n\n  const getProgressPercentage = useCallback((current: number, target?: number) => {\n    if (!target) return 0;\n    return Math.min((current / target) * 100, 100);\n  }, []);\n\n  const handleExport = useCallback((format: 'json' | 'csv') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    const exportData = {\n      widgetId: widget.id,\n      metric: data,\n      timestamp: new Date()\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-metric-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'csv':\n        const csvContent = \"data:text/csv;charset=utf-8,\" + \n          \"Metric,Value,Change,Trend,Target,Timestamp\\n\" +\n          `\"${data.label}\",\"${data.value}\",\"${data.change || 0}\",\"${data.trend || 'stable'}\",\"${data.target || 'N/A'}\",\"${new Date().toISOString()}\"`;\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-metric-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n    }\n  }, [data, onExport, widget.id]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"animate-pulse\">\n            <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n          </div>\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n        </div>\n        <div className=\"h-12 bg-gray-200 rounded-lg animate-pulse mb-4\"></div>\n        <div className=\"h-2 bg-gray-200 rounded-full animate-pulse\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n        </div>\n        <div className=\"h-32 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n          <div className=\"text-center\">\n            <div className=\"text-red-500 mb-2\">⚠️</div>\n            <p className=\"text-red-700 font-medium text-sm\">{error}</p>\n            <button\n              onClick={onRefresh}\n              className=\"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"\n            >\n              重试\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n          {widget.description && (\n            <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={onRefresh}\n            className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n            title=\"刷新\"\n          >\n            <RefreshCw className=\"h-4 w-4\" />\n          </button>\n          \n          <div className=\"relative\">\n            <button\n              onClick={() => setShowSettings(!showSettings)}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"设置\"\n            >\n              <Settings className=\"h-4 w-4\" />\n            </button>\n            \n            {showSettings && (\n              <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                <div className=\"py-1\">\n                  <button\n                    onClick={() => {\n                      handleExport('csv');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出CSV\n                  </button>\n                  <button\n                    onClick={() => {\n                      handleExport('json');\n                      setShowSettings(false);\n                    }}\n                    className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                  >\n                    <Download className=\"h-4 w-4 inline mr-2\" />\n                    导出JSON\n                  </button>\n                  {onSettings && (\n                    <button\n                      onClick={() => {\n                        onSettings();\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Settings className=\"h-4 w-4 inline mr-2\" />\n                      高级设置\n                    </button>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* 内容区域 */}\n      <div className=\"p-6\">\n        <div className=\"space-y-4\">\n          {/* 主要指标 */}\n          <div className=\"text-center\">\n            <div className=\"text-3xl font-bold text-gray-900 mb-2\">\n              {formatValue(data.value, data.format, data.unit)}\n            </div>\n            <div className=\"text-sm text-gray-600\">{data.label}</div>\n          </div>\n\n          {/* 趋势信息 */}\n          {data.change !== undefined && data.trend && (\n            <div className=\"flex items-center justify-center gap-2\">\n              <div className={cn(\"flex items-center gap-1\", getTrendColor(data.trend))}>\n                {getTrendIcon(data.trend)}\n                <span className=\"text-sm font-medium\">\n                  {data.change > 0 ? '+' : ''}{data.change.toFixed(1)}%\n                </span>\n              </div>\n              <span className=\"text-xs text-gray-500\">vs 上期</span>\n            </div>\n          )}\n\n          {/* 进度条（如果有目标）*/}\n          {data.target && (\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-600\">进度</span>\n                <span className=\"text-gray-900 font-medium\">\n                  {getProgressPercentage(data.value, data.target).toFixed(0)}%\n                </span>\n              </div>\n              <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                <div \n                  className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                  style={{ width: `${getProgressPercentage(data.value, data.target)}%` }}\n                />\n              </div>\n              <div className=\"flex justify-between text-xs text-gray-500\">\n                <span>当前</span>\n                <span>目标: {formatValue(data.target, data.format, data.unit)}</span>\n              </div>\n            </div>\n          )}\n\n          {/* 额外信息 */}\n          <div className=\"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200\">\n            <div className=\"text-center\">\n              <div className=\"text-sm text-gray-600\">状态</div>\n              <div className={cn(\"text-sm font-medium\", getTrendColor(data.trend || 'stable'))}>\n                {data.trend === 'up' ? '上升' : data.trend === 'down' ? '下降' : '稳定'}\n              </div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-sm text-gray-600\">更新时间</div>\n              <div className=\"text-sm font-medium text-gray-900\">\n                {new Date().toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function SmartMetricSkeleton() {\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n          <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n        </div>\n        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n      </div>\n      <div className=\"h-12 bg-gray-200 rounded-lg animate-pulse mb-4\"></div>\n      <div className=\"h-2 bg-gray-200 rounded-full animate-pulse\"></div>\n    </div>\n  );\n}\n\nexport default SmartMetricWidget;"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1595, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartTableWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Search, Filter, Download, RefreshCw, Settings, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { DashboardWidget } from '../lib/dashboard/types';\nimport { TableData, TableHeader, TableRow, TableAction } from '../lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface SmartTableWidgetProps {\n  widget: DashboardWidget;\n  data: TableData;\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'json' | 'csv') => void;\n  onSettings?: () => void;\n  onRowClick?: (row: TableRow) => void;\n  onActionClick?: (action: TableAction, row: TableRow) => void;\n  className?: string;\n}\n\nexport function SmartTableWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  onRowClick,\n  onActionClick,\n  className\n}: SmartTableWidgetProps) {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(10);\n  const [sortField, setSortField] = useState<string>('');\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');\n  const [showSettings, setShowSettings] = useState(false);\n  const [selectedRows, setSelectedRows] = useState<Set<string>>(new Set());\n\n  const filteredData = useMemo(() => {\n    if (!searchTerm) return data.rows;\n    return data.rows.filter(row => {\n      return Object.values(row.data || {}).some(value =>\n        String(value).toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    });\n  }, [data.rows, searchTerm]);\n\n  const sortedData = useMemo(() => {\n    if (!sortField) return filteredData;\n    return [...filteredData].sort((a, b) => {\n      const aVal = a.data?.[sortField];\n      const bVal = b.data?.[sortField];\n      if (typeof aVal === 'number' && typeof bVal === 'number') {\n        return sortOrder === 'asc' ? aVal - bVal : bVal - aVal;\n      }\n      const aStr = String(aVal ?? '');\n      const bStr = String(bVal ?? '');\n      const cmp = aStr.localeCompare(bStr, 'zh-CN');\n      return sortOrder === 'asc' ? cmp : -cmp;\n    });\n  }, [filteredData, sortField, sortOrder]);\n\n  const paginatedData = useMemo(() => {\n    const start = (currentPage - 1) * pageSize;\n    const end = start + pageSize;\n    return sortedData.slice(start, end);\n  }, [sortedData, currentPage, pageSize]);\n\n  const totalPages = Math.ceil(sortedData.length / pageSize);\n\n  const handleSort = useCallback((field: string) => {\n    if (sortField === field) {\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortOrder('asc');\n    }\n  }, [sortField, sortOrder]);\n\n  const handleExport = useCallback((format: 'json' | 'csv') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    const exportData = {\n      widgetId: widget.id,\n      headers: data.headers,\n      rows: sortedData,\n      timestamp: new Date()\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-table-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'csv':\n        const csvHeaders = data.headers.map(h => h.label).join(',');\n        const csvRows = sortedData.map(row =>\n          data.headers.map(header => `\"${String(row.data?.[header.key] ?? '')}\"`).join(',')\n        ).join('\\n');\n        const csvContent = \"data:text/csv;charset=utf-8,\" + csvHeaders + \"\\n\" + csvRows;\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-table-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n    }\n  }, [data.headers, sortedData, widget.id, onExport]);\n\n  const handleRowSelect = useCallback((rowId: string) => {\n    const newSelected = new Set(selectedRows);\n    if (newSelected.has(rowId)) {\n      newSelected.delete(rowId);\n    } else {\n      newSelected.add(rowId);\n    }\n    setSelectedRows(newSelected);\n  }, [selectedRows]);\n\n  const handleSelectAll = useCallback(() => {\n    if (selectedRows.size === paginatedData.length) {\n      setSelectedRows(new Set());\n    } else {\n      setSelectedRows(new Set(paginatedData.map(row => row.id)));\n    }\n  }, [selectedRows, paginatedData]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"animate-pulse\">\n              <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n              <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n            </div>\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"space-y-3\">\n            {[...Array(5)].map((_, i) => (\n              <div key={i} className=\"h-10 bg-gray-200 rounded animate-pulse\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n              {widget.description && (\n                <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n              )}\n            </div>\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"h-32 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n            <div className=\"text-center\">\n              <div className=\"text-red-500 mb-2\">⚠️</div>\n              <p className=\"text-red-700 font-medium text-sm\">{error}</p>\n              <button\n                onClick={onRefresh}\n                className=\"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"\n              >\n                重试\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n            {widget.description && (\n              <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n            )}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"刷新\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n            \n            <div className=\"relative\">\n              <button\n                onClick={() => setShowSettings(!showSettings)}\n                className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n                title=\"设置\"\n              >\n                <Settings className=\"h-4 w-4\" />\n              </button>\n              \n              {showSettings && (\n                <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                  <div className=\"py-1\">\n                    <button\n                      onClick={() => {\n                        handleExport('csv');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出CSV\n                    </button>\n                    <button\n                      onClick={() => {\n                        handleExport('json');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出JSON\n                    </button>\n                    {onSettings && (\n                      <button\n                        onClick={() => {\n                          onSettings();\n                          setShowSettings(false);\n                        }}\n                        className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                      >\n                        <Settings className=\"h-4 w-4 inline mr-2\" />\n                        高级设置\n                      </button>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* 搜索和过滤 */}\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex-1 relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n            <input\n              type=\"text\"\n              placeholder=\"搜索数据...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n          \n          <select\n            value={pageSize}\n            onChange={(e) => {\n              setPageSize(Number(e.target.value));\n              setCurrentPage(1);\n            }}\n            className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value={5}>5条/页</option>\n            <option value={10}>10条/页</option>\n            <option value={25}>25条/页</option>\n            <option value={50}>50条/页</option>\n          </select>\n        </div>\n      </div>\n\n      {/* 表格 */}\n      <div className=\"overflow-x-auto\">\n        <table className=\"w-full\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              {data.headers.map((header: TableHeader) => (\n                <th\n                  key={header.key}\n                  className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                >\n                  <button\n                    onClick={() => handleSort(header.key)}\n                    className=\"flex items-center gap-1 hover:text-gray-700\"\n                  >\n                    {header.label}\n                    {sortField === header.key && (\n                      <span className=\"text-blue-600\">\n                        {sortOrder === 'asc' ? '↑' : '↓'}\n                      </span>\n                    )}\n                  </button>\n                </th>\n              ))}\n              {paginatedData.some(r => r.actions && r.actions.length > 0) && (\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  操作\n                </th>\n              )}\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {paginatedData.map((row, index) => (\n              <tr\n                key={String(row.id || index)}\n                className=\"hover:bg-gray-50\"\n                onClick={() => onRowClick && onRowClick(row)}\n              >\n                {data.headers.map((header: TableHeader) => (\n                  <td key={header.key} className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {String(row.data?.[header.key] ?? '')}\n                  </td>\n                ))}\n                {row.actions && row.actions.length > 0 && (\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      {row.actions.map((action: TableAction) => (\n                        <button\n                          key={action.action}\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            onActionClick && onActionClick(action, row);\n                          }}\n                          className={cn(\n                            \"px-3 py-1 rounded text-sm font-medium transition-colors\",\n                            action.variant === 'primary' && 'bg-blue-600 text-white hover:bg-blue-700',\n                            action.variant === 'secondary' && 'bg-gray-100 text-gray-700 hover:bg-gray-200',\n                            action.variant === 'danger' && 'bg-red-600 text-white hover:bg-red-700'\n                          )}\n                        >\n                          {action.label}\n                        </button>\n                      ))}\n                    </div>\n                  </td>\n                )}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {/* 分页 */}\n      {totalPages > 1 && (\n        <div className=\"px-6 py-4 border-t border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"text-sm text-gray-700\">\n              显示第 {(currentPage - 1) * pageSize + 1} 到 {Math.min(currentPage * pageSize, sortedData.length)} 条，\n              共 {sortedData.length} 条数据\n            </div>\n            \n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                disabled={currentPage === 1}\n                className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                <ChevronLeft className=\"h-4 w-4\" />\n              </button>\n              \n              <div className=\"flex items-center gap-1\">\n                {[...Array(Math.min(5, totalPages))].map((_, i) => {\n                  const pageNum = Math.max(1, Math.min(totalPages - 4, currentPage - 2)) + i;\n                  return (\n                    <button\n                      key={pageNum}\n                      onClick={() => setCurrentPage(pageNum)}\n                      className={cn(\n                        \"px-3 py-2 rounded-lg text-sm font-medium\",\n                        currentPage === pageNum\n                          ? \"bg-blue-600 text-white\"\n                          : \"border border-gray-300 text-gray-700 hover:bg-gray-50\"\n                      )}\n                    >\n                      {pageNum}\n                    </button>\n                  );\n                })}\n              </div>\n              \n              <button\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n                disabled={currentPage === totalPages}\n                className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                <ChevronRight className=\"h-4 w-4\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport function SmartTableSkeleton() {\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"animate-pulse\">\n            <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n          </div>\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n        </div>\n        <div className=\"h-10 bg-gray-200 rounded animate-pulse\"></div>\n      </div>\n      <div className=\"p-6\">\n        <div className=\"space-y-3\">\n          {[...Array(5)].map((_, i) => (\n            <div key={i} className=\"h-10 bg-gray-200 rounded animate-pulse\"></div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default SmartTableWidget;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2536, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/SmartInsightWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Brain, TrendingUp, AlertTriangle, CheckCircle, Info, RefreshCw, Download, Settings } from 'lucide-react';\nimport { DashboardWidget, SmartInsight } from '../lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface SmartInsightWidgetProps {\n  widget: DashboardWidget;\n  data: SmartInsight[];\n  loading?: boolean;\n  error?: string | null;\n  onRefresh?: () => void;\n  onExport?: (format: 'json' | 'csv') => void;\n  onSettings?: () => void;\n  className?: string;\n}\n\nexport function SmartInsightWidget({\n  widget,\n  data,\n  loading = false,\n  error = null,\n  onRefresh,\n  onExport,\n  onSettings,\n  className\n}: SmartInsightWidgetProps) {\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\n  const [selectedSeverity, setSelectedSeverity] = useState<string>('all');\n  const [showSettings, setShowSettings] = useState(false);\n  // 新增：优先级选择状态\n  const [selectedPriority, setSelectedPriority] = useState<string>('all');\n\n  const categories = useMemo(() => {\n    const cats = new Set(data.map((insight) => insight.category));\n    return Array.from(cats);\n  }, [data]);\n\n  const severities = useMemo(() => {\n    return ['critical', 'high', 'medium', 'low'];\n  }, []);\n\n  // 新增：优先级列表\n  const priorities = useMemo(() => {\n    return ['high', 'medium', 'low'];\n  }, []);\n\n  const filteredInsights = useMemo(() => {\n    return data.filter((insight) => {\n      const categoryMatch =\n        selectedCategory === 'all' || insight.category === selectedCategory;\n      const severityMatch =\n        selectedSeverity === 'all' || insight.severity === selectedSeverity;\n      return categoryMatch && severityMatch;\n    });\n  }, [data, selectedCategory, selectedSeverity]);\n\n  const getInsightIcon = useCallback((type: string) => {\n    switch (type) {\n      case 'opportunity':\n        return <TrendingUp className=\"h-5 w-5 text-green-600\" />;\n      case 'risk':\n        return <AlertTriangle className=\"h-5 w-5 text-yellow-600\" />;\n      case 'achievement':\n        return <CheckCircle className=\"h-5 w-5 text-green-600\" />;\n      case 'trend':\n        return <TrendingUp className=\"h-5 w-5 text-blue-600\" />;\n      case 'anomaly':\n      default:\n        return <Info className=\"h-5 w-5 text-blue-600\" />;\n    }\n  }, []);\n\n  const getSeverityColor = useCallback((severity: string) => {\n    switch (severity) {\n      case 'critical':\n        return 'border-red-300 bg-red-50';\n      case 'high':\n        return 'border-red-200 bg-red-50';\n      case 'medium':\n        return 'border-yellow-200 bg-yellow-50';\n      case 'low':\n        return 'border-blue-200 bg-blue-50';\n      default:\n        return 'border-gray-200 bg-gray-50';\n    }\n  }, []);\n\n  const getSeverityBadgeColor = useCallback((severity: string) => {\n    switch (severity) {\n      case 'critical':\n        return 'bg-red-200 text-red-900';\n      case 'high':\n        return 'bg-red-100 text-red-800';\n      case 'medium':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'low':\n        return 'bg-blue-100 text-blue-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  }, []);\n\n  // 新增：优先级样式\n  const getPriorityColor = useCallback((priority: string) => {\n    switch (priority) {\n      case 'high':\n        return 'border-red-200 bg-red-50';\n      case 'medium':\n        return 'border-yellow-200 bg-yellow-50';\n      case 'low':\n        return 'border-blue-200 bg-blue-50';\n      default:\n        return 'border-gray-200 bg-gray-50';\n    }\n  }, []);\n\n  const getPriorityBadgeColor = useCallback((priority: string) => {\n    switch (priority) {\n      case 'high':\n        return 'bg-red-100 text-red-800';\n      case 'medium':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'low':\n        return 'bg-blue-100 text-blue-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  }, []);\n\n  const handleExport = useCallback((format: 'json' | 'csv') => {\n    if (onExport) {\n      onExport(format);\n      return;\n    }\n\n    const exportData = {\n      widgetId: widget.id,\n      insights: filteredInsights,\n      timestamp: new Date(),\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `${widget.id}-insights-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n\n      case 'csv':\n        const csvContent =\n          'data:text/csv;charset=utf-8,' +\n          '标题,描述,类型,严重程度,类别,置信度,影响,建议,时间戳\\n' +\n          filteredInsights\n            .map((insight) => {\n              const firstRec = insight.recommendations?.[0];\n              const impact = firstRec?.estimatedImpact || '';\n              const recommendationText = firstRec?.text || '';\n              return `\"${insight.title}\",\"${insight.description}\",\"${insight.type}\",\"${insight.severity}\",\"${insight.category}\",\"${insight.confidence}\",\"${impact}\",\"${recommendationText}\",\"${new Date().toISOString()}\"`;\n            })\n            .join('\\n');\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `${widget.id}-insights-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n    }\n  }, [filteredInsights, widget.id, onExport]);\n\n  if (loading) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"animate-pulse\">\n              <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n              <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n            </div>\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"space-y-4\">\n            {[...Array(3)].map((_, i) => (\n              <div key={i} className=\"h-24 bg-gray-200 rounded-lg animate-pulse\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n              {widget.description && (\n                <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n              )}\n            </div>\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"h-32 flex items-center justify-center bg-red-50 rounded-lg border border-red-200\">\n            <div className=\"text-center\">\n              <div className=\"text-red-500 mb-2\">⚠️</div>\n              <p className=\"text-red-700 font-medium text-sm\">{error}</p>\n              <button\n                onClick={onRefresh}\n                className=\"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"\n              >\n                重试\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200\", className)}>\n      {/* 头部 */}\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center gap-3\">\n            <Brain className=\"h-6 w-6 text-blue-600\" />\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">{widget.title}</h3>\n              {widget.description && (\n                <p className=\"text-sm text-gray-600 mt-1\">{widget.description}</p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={onRefresh}\n              className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n              title=\"刷新\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n            </button>\n\n            <div className=\"relative\">\n              <button\n                onClick={() => setShowSettings(!showSettings)}\n                className=\"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors\"\n                title=\"设置\"\n              >\n                <Settings className=\"h-4 w-4\" />\n              </button>\n\n              {showSettings && (\n                <div className=\"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10\">\n                  <div className=\"py-1\">\n                    <button\n                      onClick={() => {\n                        handleExport('csv');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出CSV\n                    </button>\n                    <button\n                      onClick={() => {\n                        handleExport('json');\n                        setShowSettings(false);\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                    >\n                      <Download className=\"h-4 w-4 inline mr-2\" />\n                      导出JSON\n                    </button>\n                    {onSettings && (\n                      <button\n                        onClick={() => {\n                          onSettings();\n                          setShowSettings(false);\n                        }}\n                        className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\n                      >\n                        <Settings className=\"h-4 w-4 inline mr-2\" />\n                        高级设置\n                      </button>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* 过滤器 */}\n        <div className=\"flex items-center gap-4\">\n          <div className=\"flex items-center gap-2\">\n            <label className=\"text-sm font-medium text-gray-700\">类别:</label>\n            <select\n              value={selectedCategory}\n              onChange={(e) => setSelectedCategory(e.target.value)}\n              className=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"all\">全部</option>\n              {categories.map(category => (\n                <option key={category} value={category}>{category}</option>\n              ))}\n            </select>\n          </div>\n            {/* 修改为严重程度筛选 */}\n            <div className=\"flex items-center gap-2\">\n                <label className=\"text-sm font-medium text-gray-700\">严重程度:</label>\n                <select\n                    value={selectedSeverity}\n                    onChange={(e) => setSelectedSeverity(e.target.value)}\n                    className=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                >\n                    <option value=\"all\">全部</option>\n                    {severities.map(severity => (\n                        <option key={severity} value={severity}>\n                            {severity === 'critical' ? '危急' : severity === 'high' ? '高' : severity === 'medium' ? '中' : '低'}\n                        </option>\n                    ))}\n                </select>\n            </div>\n        </div>\n      </div>\n\n      {/* 洞察内容 */}\n      <div className=\"p-6\">\n        {filteredInsights.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <Brain className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <p className=\"text-gray-600\">暂无相关洞察</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {filteredInsights.map((insight, index) => {\n              const firstRec = insight.recommendations?.[0];\n              const impact = firstRec?.estimatedImpact || '—';\n              return (\n                <div\n                  key={index}\n                  className={cn(\n                    \"rounded-lg border p-4\",\n                    // 使用严重程度颜色而非优先级\n                    getSeverityColor(insight.severity)\n                  )}\n                >\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"flex-shrink-0 mt-1\">\n                      {getInsightIcon(insight.type)}\n                    </div>\n\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <h4 className=\"text-sm font-semibold text-gray-900\">\n                          {insight.title}\n                        </h4>\n                        <div className=\"flex items-center gap-2\">\n                          <span className={cn(\n                            \"px-2 py-1 rounded-full text-xs font-medium\",\n                            // 使用严重程度徽章颜色\n                            getSeverityBadgeColor(insight.severity)\n                          )}>\n                            {insight.severity === 'critical' ? '危急' : insight.severity === 'high' ? '高' : insight.severity === 'medium' ? '中' : '低'}\n                          </span>\n                          <span className=\"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded\">\n                            {insight.category}\n                          </span>\n                        </div>\n                      </div>\n\n                      <p className=\"text-sm text-gray-700 mb-3\">\n                        {insight.description}\n                      </p>\n\n                      <div className=\"grid grid-cols-2 gap-4 mb-3\">\n                        <div>\n                          <div className=\"text-xs text-gray-500 mb-1\">置信度</div>\n                          <div className=\"flex items-center gap-2\">\n                            <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                              <div\n                                className=\"bg-blue-600 h-2 rounded-full\"\n                                style={{ width: `${insight.confidence}%` }}\n                              />\n                            </div>\n                            <span className=\"text-xs font-medium text-gray-700\">\n                              {insight.confidence}%\n                            </span>\n                          </div>\n                        </div>\n\n                        <div>\n                          <div className=\"text-xs text-gray-500 mb-1\">影响程度</div>\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {impact}\n                          </div>\n                        </div>\n                      </div>\n\n                      {insight.recommendations?.length > 0 && (\n                        <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\n                          <div className=\"text-xs font-medium text-gray-700 mb-2\">建议</div>\n                          <ul className=\"space-y-2\">\n                            {insight.recommendations.map((rec) => (\n                              <li key={rec.id} className=\"flex items-start justify-between gap-2\">\n                                <div className=\"text-sm text-gray-600\">{rec.text}</div>\n                                <span\n                                  className={cn(\n                                    \"px-2 py-0.5 rounded-full text-xs font-medium\",\n                                    getPriorityBadgeColor(rec.priority)\n                                  )}\n                                >\n                                  {rec.priority === 'high' ? '高优' : rec.priority === 'medium' ? '中优' : '低优'}\n                                </span>\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* 统计信息 */}\n      <div className=\"px-6 py-4 border-t border-gray-200 bg-gray-50\">\n        <div className=\"flex items-center justify-between text-sm text-gray-600\">\n          <div>\n            共 {filteredInsights.length} 条洞察\n          </div>\n          <div>\n            最后更新: {new Date().toLocaleString('zh-CN')}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function SmartInsightSkeleton() {\n  return (\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div className=\"p-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"animate-pulse\">\n            <div className=\"h-4 bg-gray-200 rounded w-24 mb-2\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n          </div>\n          <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n      <div className=\"p-6\">\n        <div className=\"space-y-4\">\n          {[...Array(3)].map((_, i) => (\n            <div key={i} className=\"h-24 bg-gray-200 rounded-lg animate-pulse\"></div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default SmartInsightWidget;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3646, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/lib/dashboard/data-generator.ts"],"sourcesContent":["import { \n  ChartData, \n  Dataset, \n  MetricData, \n  TableData, \n  TableHeader, \n  TableRow,\n  SmartInsight,\n  DataPoint,\n  Recommendation \n} from './types';\n\n// 生成模拟图表数据\nexport function generateChartData(type: 'line' | 'bar' | 'pie' | 'area' = 'line'): ChartData {\n  const months = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];\n  const colors = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#06B6D4'];\n  \n  switch (type) {\n    case 'line':\n    case 'area':\n      return {\n        labels: months.slice(0, 6),\n        datasets: [\n          {\n            label: '学习时长',\n            data: [120, 150, 180, 220, 280, 320],\n            borderColor: colors[0],\n            backgroundColor: type === 'area' ? `${colors[0]}20` : colors[0],\n            fill: type === 'area',\n            tension: 0.4\n          },\n          {\n            label: '完成课程',\n            data: [8, 12, 15, 18, 25, 30],\n            borderColor: colors[1],\n            backgroundColor: type === 'area' ? `${colors[1]}20` : colors[1],\n            fill: type === 'area',\n            tension: 0.4\n          }\n        ]\n      };\n    \n    case 'bar':\n      return {\n        labels: ['React', 'Vue', 'Angular', 'Svelte', 'Next.js', 'Nuxt.js'],\n        datasets: [\n          {\n            label: '学习人数',\n            data: [2500, 1800, 1200, 800, 2200, 900],\n            backgroundColor: colors\n          }\n        ]\n      };\n    \n    case 'pie':\n      return {\n        labels: ['前端开发', '后端开发', '数据科学', '移动开发', 'DevOps'],\n        datasets: [\n          {\n            label: '技能分布',\n            data: [35, 28, 15, 12, 10],\n            backgroundColor: colors\n          }\n        ]\n      };\n    \n    default:\n      return generateChartData('line');\n  }\n}\n\n// 生成模拟指标数据\nexport function generateMetricData(type: 'revenue' | 'users' | 'engagement' | 'performance' = 'users'): MetricData {\n  const baseData = {\n    revenue: {\n      value: 125000,\n      label: '总收入',\n      change: 12.5,\n      trend: 'up' as const,\n      target: 150000,\n      unit: '¥',\n      format: 'currency' as const\n    },\n    users: {\n      value: 2847,\n      label: '活跃用户',\n      change: 8.3,\n      trend: 'up' as const,\n      target: 3000,\n      unit: '',\n      format: 'number' as const\n    },\n    engagement: {\n      value: 78.5,\n      label: '学习参与度',\n      change: -2.1,\n      trend: 'down' as const,\n      target: 85,\n      unit: '%',\n      format: 'percentage' as const\n    },\n    performance: {\n      value: 92,\n      label: '系统性能',\n      change: 0,\n      trend: 'stable' as const,\n      target: 95,\n      unit: '%',\n      format: 'percentage' as const\n    }\n  };\n\n  return baseData[type];\n}\n\n// 生成模拟表格数据\nexport function generateTableData(type: 'courses' | 'users' | 'revenue' | 'activity' = 'courses'): TableData {\n  const headers: Record<string, TableHeader[]> = {\n    courses: [\n      { key: 'title', label: '课程名称', type: 'text', sortable: true },\n      { key: 'category', label: '分类', type: 'text', sortable: true },\n      { key: 'students', label: '学员数', type: 'number', sortable: true },\n      { key: 'rating', label: '评分', type: 'number', sortable: true },\n      { key: 'revenue', label: '收入', type: 'currency', sortable: true },\n      { key: 'status', label: '状态', type: 'text', sortable: false }\n    ],\n    users: [\n      { key: 'name', label: '姓名', type: 'text', sortable: true },\n      { key: 'email', label: '邮箱', type: 'text', sortable: true },\n      { key: 'courses', label: '课程数', type: 'number', sortable: true },\n      { key: 'progress', label: '进度', type: 'percentage', sortable: true },\n      { key: 'joined', label: '加入时间', type: 'date', sortable: true },\n      { key: 'status', label: '状态', type: 'text', sortable: false }\n    ],\n    revenue: [\n      { key: 'date', label: '日期', type: 'date', sortable: true },\n      { key: 'course', label: '课程', type: 'text', sortable: true },\n      { key: 'amount', label: '金额', type: 'currency', sortable: true },\n      { key: 'students', label: '学员数', type: 'number', sortable: true },\n      { key: 'conversion', label: '转化率', type: 'percentage', sortable: true },\n      { key: 'source', label: '来源', type: 'text', sortable: true }\n    ],\n    activity: [\n      { key: 'timestamp', label: '时间', type: 'date', sortable: true },\n      { key: 'user', label: '用户', type: 'text', sortable: true },\n      { key: 'action', label: '操作', type: 'text', sortable: true },\n      { key: 'course', label: '课程', type: 'text', sortable: true },\n      { key: 'duration', label: '时长', type: 'number', sortable: true },\n      { key: 'status', label: '状态', type: 'text', sortable: false }\n    ]\n  };\n\n  const generateRows = (type: string, count: number = 10): TableRow[] => {\n    const rows: TableRow[] = [];\n    \n    for (let i = 1; i <= count; i++) {\n      switch (type) {\n        case 'courses':\n          rows.push({\n            id: `course-${i}`,\n            data: {\n              title: `热门课程 ${i}`,\n              category: ['前端开发', '后端开发', '数据科学', '移动开发'][Math.floor(Math.random() * 4)],\n              students: Math.floor(Math.random() * 1000) + 100,\n              rating: (Math.random() * 2 + 3).toFixed(1),\n              revenue: Math.floor(Math.random() * 50000) + 10000,\n              status: Math.random() > 0.7 ? '热门' : '正常'\n            }\n          });\n          break;\n        \n        case 'users':\n          rows.push({\n            id: `user-${i}`,\n            data: {\n              name: `用户${i}`,\n              email: `user${i}@example.com`,\n              courses: Math.floor(Math.random() * 10) + 1,\n              progress: Math.floor(Math.random() * 100),\n              joined: new Date(2024 - Math.floor(Math.random() * 2), Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1),\n              status: Math.random() > 0.8 ? '活跃' : '正常'\n            }\n          });\n          break;\n        \n        case 'revenue':\n          rows.push({\n            id: `revenue-${i}`,\n            data: {\n              date: new Date(2024, Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1),\n              course: `课程 ${Math.floor(Math.random() * 20) + 1}`,\n              amount: Math.floor(Math.random() * 10000) + 1000,\n              students: Math.floor(Math.random() * 100) + 10,\n              conversion: (Math.random() * 20 + 5).toFixed(1),\n              source: ['直接访问', '搜索引擎', '社交媒体', '推荐'][Math.floor(Math.random() * 4)]\n            }\n          });\n          break;\n        \n        case 'activity':\n          rows.push({\n            id: `activity-${i}`,\n            data: {\n              timestamp: new Date(Date.now() - Math.random() * 86400000 * 30), // 最近30天\n              user: `用户${Math.floor(Math.random() * 100) + 1}`,\n              action: ['开始学习', '完成课程', '发表评论', '获得证书'][Math.floor(Math.random() * 4)],\n              course: `课程 ${Math.floor(Math.random() * 20) + 1}`,\n              duration: Math.floor(Math.random() * 120) + 30,\n              status: Math.random() > 0.9 ? '异常' : '正常'\n            }\n          });\n          break;\n      }\n    }\n    \n    return rows;\n  };\n\n  return {\n    headers: headers[type],\n    rows: generateRows(type),\n    pagination: {\n      enabled: true,\n      pageSize: 10,\n      currentPage: 1,\n      totalItems: 50,\n      showSizeChanger: true,\n      showQuickJumper: true\n    },\n    sorting: {\n      enabled: true,\n      defaultSortField: 'title',\n      defaultSortOrder: 'asc',\n      multiSort: false\n    }\n  };\n}\n\n// 生成智能洞察数据\nexport function generateSmartInsights(count: number = 5): SmartInsight[] {\n  const insights: SmartInsight[] = [];\n  const types: Array<'trend' | 'anomaly' | 'opportunity' | 'risk' | 'achievement'> = \n    ['trend', 'anomaly', 'opportunity', 'risk', 'achievement'];\n  \n  const severities: Array<'low' | 'medium' | 'high' | 'critical'> = \n    ['low', 'medium', 'high', 'critical'];\n  \n  const categories = ['学习进度', '用户参与', '收入分析', '系统性能', '内容质量'];\n  \n  for (let i = 1; i <= count; i++) {\n    const type = types[Math.floor(Math.random() * types.length)];\n    const severity = severities[Math.floor(Math.random() * severities.length)];\n    const category = categories[Math.floor(Math.random() * categories.length)];\n    \n    const dataPoints: DataPoint[] = [\n      {\n        label: '当前值',\n        value: Math.floor(Math.random() * 1000) + 100,\n        change: Number((Math.random() * 40 - 20).toFixed(1)),\n        trend: Math.random() > 0.5 ? 'up' : 'down',\n        timestamp: new Date()\n      },\n      {\n        label: '对比值',\n        value: Math.floor(Math.random() * 800) + 200,\n        change: Number((Math.random() * 30 - 15).toFixed(1)),\n        trend: Math.random() > 0.5 ? 'up' : 'down',\n        timestamp: new Date(Date.now() - 86400000 * 7) // 一周前\n      }\n    ];\n    \n    const recommendations: Recommendation[] = [\n      {\n        id: `rec-${i}-1`,\n        text: `建议优化${category}相关策略`,\n        priority: severity === 'critical' ? 'high' : severity === 'high' ? 'medium' : 'low',\n        estimatedImpact: `预计提升${(Math.random() * 20 + 5).toFixed(1)}%`,\n        actionUrl: `/dashboard/analytics?focus=${category}`,\n        actionText: '查看详情'\n      }\n    ];\n    \n    if (Math.random() > 0.5) {\n      recommendations.push({\n        id: `rec-${i}-2`,\n        text: `考虑调整${category}配置参数`,\n        priority: 'medium',\n        estimatedImpact: `预计改善${(Math.random() * 15 + 3).toFixed(1)}%`,\n        actionUrl: `/settings/${category.toLowerCase()}`,\n        actionText: '配置设置'\n      });\n    }\n    \n    insights.push({\n      id: `insight-${i}`,\n      type,\n      title: `${category} - ${type === 'trend' ? '趋势分析' : \n                           type === 'anomaly' ? '异常检测' :\n                           type === 'opportunity' ? '机会识别' :\n                           type === 'risk' ? '风险评估' : '成就达成'}`,\n      description: `在${category}方面发现${type === 'trend' ? '重要趋势' : \n                                      type === 'anomaly' ? '异常模式' :\n                                      type === 'opportunity' ? '优化机会' :\n                                      type === 'risk' ? '潜在风险' : '显著成就'}，需要关注`,\n      severity,\n      dataPoints,\n      recommendations,\n      timestamp: new Date(Date.now() - Math.random() * 86400000 * 7), // 最近一周\n      category,\n      tags: [category.toLowerCase(), type, severity],\n      confidence: Math.random() * 0.3 + 0.7, // 70-100%\n      autoActionable: Math.random() > 0.3\n    });\n  }\n  \n  return insights.sort((a, b) => {\n    const severityOrder = { critical: 4, high: 3, medium: 2, low: 1 };\n    return severityOrder[b.severity] - severityOrder[a.severity];\n  });\n}\n\n// 生成实时数据更新\nexport function generateRealtimeUpdate() {\n  const metrics = ['users', 'revenue', 'engagement', 'performance'];\n  const metric = metrics[Math.floor(Math.random() * metrics.length)];\n  \n  return {\n    type: 'update',\n    metric,\n    data: generateMetricData(metric as any),\n    timestamp: new Date()\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4174, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/ModularDashboardBuilder.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Plus, Settings, Save, Eye, EyeOff, Move, Trash2, Edit3 } from 'lucide-react';\nimport { DashboardWidget, DashboardLayout, WidgetConfig } from '../lib/dashboard/types';\nimport { SmartChartWidget } from '@/app/components/SmartChartWidget';\nimport { SmartMetricWidget } from '@/app/components/SmartMetricWidget';\nimport { SmartTableWidget } from '@/app/components/SmartTableWidget';\nimport { SmartInsightWidget } from '@/app/components/SmartInsightWidget';\nimport { cn } from '@/app/lib/utils';\n\nimport { \n  generateChartData, \n  generateMetricData, \n  generateTableData,\n  generateSmartInsights\n} from '@/app/lib/dashboard/data-generator';\n\ninterface ModularDashboardBuilderProps {\n  layout: DashboardLayout;\n  widgets: DashboardWidget[];\n  onLayoutChange: (layout: DashboardLayout) => void;\n  onWidgetAdd: (widget: DashboardWidget) => void;\n  onWidgetRemove: (widgetId: string) => void;\n  onWidgetUpdate: (widgetId: string, updates: Partial<DashboardWidget>) => void;\n  className?: string;\n}\n\nexport function ModularDashboardBuilder({\n  layout,\n  // 为 widgets 设置默认值，避免父组件未传时为 undefined\n  widgets = [],\n  onLayoutChange,\n  onWidgetAdd,\n  onWidgetRemove,\n  onWidgetUpdate,\n  className\n}: ModularDashboardBuilderProps) {\n  const [isEditMode, setIsEditMode] = useState(false);\n  const [draggedWidget, setDraggedWidget] = useState<string | null>(null);\n  const [showWidgetSelector, setShowWidgetSelector] = useState(false);\n\n  // 将组件映射类型限制到实际可用键，避免索引错误\n  type WidgetComponentMap = {\n    chart: typeof SmartChartWidget;\n    metric: typeof SmartMetricWidget;\n    table: typeof SmartTableWidget;\n    insight: typeof SmartInsightWidget;\n  };\n  const widgetComponents: WidgetComponentMap = useMemo(() => {\n    return {\n      chart: SmartChartWidget,\n      metric: SmartMetricWidget,\n      table: SmartTableWidget,\n      insight: SmartInsightWidget\n    };\n  }, []);\n\n  const availableWidgetTypes = useMemo(() => {\n    return [\n      { type: 'chart', name: '图表', description: '数据可视化图表' },\n      { type: 'metric', name: '指标', description: '关键业务指标' },\n      { type: 'table', name: '表格', description: '数据表格展示' }\n    ];\n  }, []);\n\n  const handleDragStart = useCallback((e: React.DragEvent, widgetId: string) => {\n    setDraggedWidget(widgetId);\n    e.dataTransfer.effectAllowed = 'move';\n  }, []);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent, targetIndex: number) => {\n    e.preventDefault();\n    if (!layout || !Array.isArray(layout.widgets)) {\n        // 没有可用的布局时不进行重排，直接退出\n        setDraggedWidget(null);\n        return;\n    }\n    if (draggedWidget) {\n      const currentIndex = layout.widgets.findIndex(w => w.id === draggedWidget);\n      if (currentIndex === -1) {\n          setDraggedWidget(null);\n          return;\n      }\n  \n      const reordered = [...layout.widgets];\n      const [moved] = reordered.splice(currentIndex, 1);\n      reordered.splice(targetIndex, 0, moved);\n  \n      const updatedWidgets = reordered.map((w, idx) => ({\n        ...w,\n        position: { ...w.position, y: idx }\n      }));\n  \n      onLayoutChange({ ...layout, widgets: updatedWidgets });\n      setDraggedWidget(null);\n    }\n  }, [draggedWidget, layout, onLayoutChange]);\n\n  const handleWidgetAdd = useCallback((type: string) => {\n    const newWidget: DashboardWidget = {\n      id: `widget-${Date.now()}`,\n      type: type as any,\n      title: `新${availableWidgetTypes.find(t => t.type === type)?.name}`,\n      description: availableWidgetTypes.find(t => t.type === type)?.description,\n      size: 'medium',\n      // 使用 widgets.length 作为默认顺序，确保不读 undefined.length\n      position: { x: 0, y: widgets.length, w: 1, h: 1 },\n      config: {} as WidgetConfig,\n      dataSource: 'demo'\n    };\n    onWidgetAdd(newWidget);\n    setShowWidgetSelector(false);\n  }, [availableWidgetTypes, widgets.length, onWidgetAdd]);\n\n  const handleWidgetRemove = useCallback((widgetId: string) => {\n    if (confirm('确定要删除这个组件吗？')) {\n      onWidgetRemove(widgetId);\n    }\n  }, [onWidgetRemove]);\n\n  const handleLayoutSave = useCallback(() => {\n    localStorage.setItem('dashboard-layout', JSON.stringify(layout));\n    alert('布局已保存！');\n  }, [layout]);\n\n  const handleLayoutReset = useCallback(() => {\n    if (confirm('确定要重置布局吗？')) {\n      localStorage.removeItem('dashboard-layout');\n      window.location.reload();\n    }\n  }, []);\n\n  const renderWidget = useCallback((widget: DashboardWidget, index: number) => {\n    const type = widget.type;\n\n    return (\n      <div\n        key={widget.id}\n        className={cn(\"relative group\", isEditMode && \"cursor-move\")}\n        draggable={isEditMode}\n        onDragStart={(e) => handleDragStart(e, widget.id)}\n        onDragOver={handleDragOver}\n        // 使用索引作为目标位置，避免把对象传入需要 number 的参数\n        onDrop={(e) => handleDrop(e, index)}\n      >\n        {isEditMode && (\n          <div className=\"absolute inset-0 bg-blue-500 bg-opacity-10 rounded-lg border-2 border-blue-500 border-dashed z-10 flex items-center justify-center\">\n            <div className=\"flex items-center gap-2 text-blue-600 font-medium\">\n              <Move className=\"h-4 w-4\" />\n              拖拽移动\n            </div>\n          </div>\n        )}\n\n        <div className=\"relative\">\n          {type === 'chart' && (\n            <SmartChartWidget\n              widget={widget}\n              data={generateChartData(\n                (() => {\n                  const ct = widget.config?.chartType;\n                  const safeCt: 'line' | 'bar' | 'pie' | 'area' =\n                    ct === 'line' || ct === 'bar' || ct === 'pie' || ct === 'area' ? ct : 'line';\n                  return safeCt;\n                })()\n              )}\n              loading={false}\n              error={null}\n              className=\"h-full\"\n            />\n          )}\n          {type === 'metric' && (\n            <SmartMetricWidget\n              widget={widget}\n              data={generateMetricData()}\n              loading={false}\n              error={null}\n              className=\"h-full\"\n            />\n          )}\n          {type === 'table' && (\n            <SmartTableWidget\n              widget={widget}\n              data={generateTableData()}\n              loading={false}\n              error={null}\n              className=\"h-full\"\n            />\n          )}\n          {/* 移除 insight 分支 */}\n          <SmartInsightWidget\n            widget={widget}\n            data={generateSmartInsights(5)}\n            loading={false}\n            error={null}\n            className=\"h-full\"\n          />\n\n          {isEditMode && (\n            <div className=\"absolute top-2 right-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n              <button\n                onClick={() => handleWidgetRemove(widget.id)}\n                className=\"p-1 bg-red-600 text-white rounded hover:bg-red-700\"\n                title=\"删除\"\n              >\n                <Trash2 className=\"h-3 w-3\" />\n              </button>\n              <button\n                onClick={() => {\n                  const newTitle = prompt('修改标题:', widget.title);\n                  if (newTitle) {\n                    onWidgetUpdate(widget.id, { title: newTitle });\n                  }\n                }}\n                className=\"p-1 bg-blue-600 text-white rounded hover:bg-blue-700\"\n                title=\"编辑\"\n              >\n                <Edit3 className=\"h-3 w-3\" />\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }, [isEditMode, handleDragStart, handleDragOver, handleDrop, handleWidgetRemove, onWidgetUpdate]);\n\n  const generateMockData = useCallback((type: string) => {\n    switch (type) {\n      case 'chart':\n        return {\n          labels: ['1月', '2月', '3月', '4月', '5月', '6月'],\n          datasets: [{\n            label: '销售额',\n            data: [12000, 19000, 15000, 25000, 22000, 30000],\n            borderColor: 'rgb(59, 130, 246)',\n            backgroundColor: 'rgba(59, 130, 246, 0.1)',\n          }]\n        };\n      \n      case 'metric':\n        return {\n          label: '本月销售额',\n          value: 125000,\n          format: 'currency',\n          unit: 'CNY',\n          change: 15.2,\n          trend: 'up' as const,\n          target: 150000\n        };\n      \n      case 'table':\n        return {\n          headers: [\n            { key: 'name', label: '姓名' },\n            { key: 'email', label: '邮箱' },\n            { key: 'status', label: '状态' },\n            { key: 'createdAt', label: '创建时间' }\n          ],\n          rows: [\n            { id: 1, name: '张三', email: 'zhang@example.com', status: '活跃', createdAt: '2024-01-15' },\n            { id: 2, name: '李四', email: 'li@example.com', status: '待激活', createdAt: '2024-01-14' },\n            { id: 3, name: '王五', email: 'wang@example.com', status: '活跃', createdAt: '2024-01-13' }\n          ],\n          actions: [\n            { id: 'view', label: '查看', variant: 'primary' },\n            { id: 'edit', label: '编辑', variant: 'secondary' }\n          ]\n        };\n      \n      case 'insight':\n        return [\n          {\n            id: '1',\n            title: '销售增长机会',\n            description: '本月销售额相比上月增长15.2%，建议加大营销投入以维持增长势头。',\n            type: 'opportunity',\n            priority: 'high',\n            category: '销售',\n            confidence: 85,\n            impact: '高',\n            recommendation: '建议增加营销预算20%，重点关注高转化率的渠道。'\n          },\n          {\n            id: '2',\n            title: '用户活跃度下降',\n            description: '最近7天用户活跃度下降8%，需要关注用户体验。',\n            type: 'warning',\n            priority: 'medium',\n            category: '用户',\n            confidence: 72,\n            impact: '中',\n            recommendation: '建议优化用户界面，增加互动功能。'\n          }\n        ];\n      \n      default:\n        return {};\n    }\n  }, []);\n\n  return (\n    <div className={cn(\"relative\", className)}>\n      {/* 工具栏 */}\n      <div className=\"flex items-center justify-between mb-6 p-4 bg-white rounded-lg shadow-sm border border-gray-200\">\n        <div className=\"flex items-center gap-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">模块化仪表板</h2>\n          <div className=\"text-sm text-gray-600\">\n            共 {widgets.length} 个组件\n          </div>\n        </div>\n        \n        <div className=\"flex items-center gap-2\">\n          {isEditMode && (\n            <>\n              <button\n                onClick={() => setShowWidgetSelector(true)}\n                className=\"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\n              >\n                <Plus className=\"h-4 w-4\" />\n                添加组件\n              </button>\n              \n              <button\n                onClick={handleLayoutSave}\n                className=\"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n              >\n                <Save className=\"h-4 w-4\" />\n                保存布局\n              </button>\n              \n              <button\n                onClick={handleLayoutReset}\n                className=\"px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\n              >\n                重置\n              </button>\n            </>\n          )}\n          \n          <button\n            onClick={() => setIsEditMode(!isEditMode)}\n            className={cn(\n              \"flex items-center gap-2 px-3 py-2 rounded-lg transition-colors\",\n              isEditMode\n                ? \"bg-red-600 text-white hover:bg-red-700\"\n                : \"bg-blue-600 text-white hover:bg-blue-700\"\n            )}\n          >\n            {isEditMode ? (\n              <>\n                <Eye className=\"h-4 w-4\" />\n                退出编辑\n              </>\n            ) : (\n              <>\n                <Settings className=\"h-4 w-4\" />\n                编辑模式\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* 组件选择器 */}\n      {showWidgetSelector && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">添加组件</h3>\n            <div className=\"space-y-2\">\n              {availableWidgetTypes.map(type => (\n                <button\n                  key={type.type}\n                  onClick={() => handleWidgetAdd(type.type)}\n                  className=\"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors\"\n                >\n                  <div className=\"font-medium text-gray-900\">{type.name}</div>\n                  <div className=\"text-sm text-gray-600\">{type.description}</div>\n                </button>\n              ))}\n            </div>\n            <div className=\"flex justify-end gap-2 mt-4\">\n              <button\n                onClick={() => setShowWidgetSelector(false)}\n                className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\n              >\n                取消\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* 仪表板网格 */}\n      <div className={cn(\n        \"grid gap-6\",\n        (layout?.gridConfig?.cols ?? 3) >= 4 && \"grid-cols-1 md:grid-cols-2 lg:grid-cols-4\",\n        (layout?.gridConfig?.cols ?? 3) === 3 && \"grid-cols-1 md:grid-cols-2 lg:grid-cols-3\",\n        (layout?.gridConfig?.cols ?? 3) <= 2 && \"grid-cols-1 md:grid-cols-2\"\n      )}>\n        {/* 统一使用 widgets 渲染，避免访问 layout.widgets */}\n        {widgets.map((widget, idx) => renderWidget(widget, idx))}\n      </div>\n\n      {/* 空状态 */}\n      {widgets.length === 0 && (\n        <div className=\"text-center py-12\">\n          <div className=\"text-gray-400 mb-4\">\n            <Settings className=\"h-16 w-16 mx-auto\" />\n          </div>\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">还没有组件</h3>\n          <p className=\"text-gray-600 mb-4\">点击编辑模式开始添加组件</p>\n          <button\n            onClick={() => setIsEditMode(true)}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n          >\n            开始编辑\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default ModularDashboardBuilder;\n\n\nfunction renderWidget(widget: DashboardWidget) {\n  if (widget.type === 'chart') {\n    const ct = widget.config?.chartType;\n    const safeCt: 'line' | 'bar' | 'pie' | 'area' =\n      ct === 'line' || ct === 'bar' || ct === 'pie' || ct === 'area' ? ct : 'line';\n    return (\n      <SmartChartWidget\n        widget={widget}\n        data={generateChartData(safeCt)}\n        loading={false}\n        error={null}\n        className=\"h-full\"\n      />\n    );\n  }\n\n  if (widget.type === 'metric') {\n    return (\n      <SmartMetricWidget\n        widget={widget}\n        data={generateMetricData()}\n        loading={false}\n        error={null}\n        className=\"h-full\"\n      />\n    );\n  }\n\n  if (widget.type === 'table') {\n    return (\n      <SmartTableWidget\n        widget={widget}\n        data={generateTableData()}\n        loading={false}\n        error={null}\n        className=\"h-full\"\n      />\n    );\n  }\n\n  if (widget.type === 'activity' || widget.type === 'calendar' || widget.type === 'progress') {\n    return <div className=\"rounded-md border p-4 text-gray-600\">Widget type: {widget.type}</div>;\n  }\n\n  return <div className=\"rounded-md border p-4 text-gray-600\">Unsupported widget type</div>;\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4984, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/components/AIInsightEngine.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Brain, TrendingUp, Users, DollarSign, Eye, Target, Clock, CheckCircle } from 'lucide-react';\nimport { SmartInsight } from '@/app/lib/dashboard/types';\nimport { cn } from '@/app/lib/utils';\n\ninterface AIInsightEngineProps {\n  className?: string;\n  onInsightGenerated?: (insights: SmartInsight[]) => void;\n}\n\nexport function AIInsightEngine({\n  className,\n  onInsightGenerated\n}: AIInsightEngineProps) {\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [selectedMetrics, setSelectedMetrics] = useState<string[]>([]);\n  const [analysisDepth, setAnalysisDepth] = useState<'basic' | 'advanced' | 'deep'>('advanced');\n  const [timeRange, setTimeRange] = useState<'7d' | '30d' | '90d' | '1y'>('30d');\n\n  const availableMetrics = useMemo(() => {\n    return [\n      { id: 'revenue', name: '收入', icon: DollarSign, category: '财务' },\n      { id: 'users', name: '用户', icon: Users, category: '用户' },\n      { id: 'engagement', name: '参与度', icon: Eye, category: '用户' },\n      { id: 'conversion', name: '转化率', icon: Target, category: '营销' },\n      { id: 'retention', name: '留存率', icon: CheckCircle, category: '用户' },\n      { id: 'performance', name: '性能', icon: Clock, category: '技术' }\n    ];\n  }, []);\n\n  const generateInsights = useCallback(async () => {\n    setIsAnalyzing(true);\n    \n    // 模拟AI分析过程\n    await new Promise(resolve => setTimeout(resolve, 2000));\n    \n    const confidence1 = Math.floor(Math.random() * 30 + 70);\n    const confidence2 = Math.floor(Math.random() * 25 + 65);\n    const confidence3 = Math.floor(Math.random() * 20 + 75);\n    const confidence4 = Math.floor(Math.random() * 15 + 80);\n\n    const mockInsights: SmartInsight[] = [\n      {\n        id: '1',\n        title: '收入趋势异常',\n        description: `过去${timeRange === '7d' ? '7天' : timeRange === '30d' ? '30天' : timeRange === '90d' ? '90天' : '1年'}收入增长率下降${Math.floor(Math.random() * 20 + 5)}%，需要立即关注。`,\n        type: 'anomaly',\n        severity: 'high',\n        category: '财务',\n        confidence: confidence1,\n        dataPoints: [\n          { label: 'income_change', value: confidence1, trend: 'down' }\n        ],\n        recommendations: [\n          { id: 'rec-1', text: '建议分析具体下降原因，调整营销策略，优化产品定价。', priority: 'high' }\n        ],\n        timestamp: new Date(),\n        tags: ['收入', '趋势'],\n        autoActionable: false\n      },\n      {\n        id: '2',\n        title: '用户增长机会',\n        description: '发现新的用户获取渠道，预计可提升用户增长15-20%。',\n        type: 'opportunity',\n        severity: 'medium',\n        category: '用户',\n        confidence: confidence2,\n        dataPoints: [\n          { label: 'user_growth_potential', value: confidence2, trend: 'up' }\n        ],\n        recommendations: [\n          { id: 'rec-2', text: '建议投入更多资源到新渠道测试，监控转化效果。', priority: 'medium' }\n        ],\n        timestamp: new Date(),\n        tags: ['用户', '渠道'],\n        autoActionable: false\n      },\n      {\n        id: '3',\n        title: '系统性能优化',\n        description: '检测到系统响应时间增加，可能影响用户体验。',\n        type: 'risk',\n        severity: 'medium',\n        category: '技术',\n        confidence: confidence3,\n        dataPoints: [\n          { label: 'latency_increase', value: confidence3, trend: 'up' }\n        ],\n        recommendations: [\n          { id: 'rec-3', text: '优化数据库查询，增加缓存机制，监控服务器资源。', priority: 'medium' }\n        ],\n        timestamp: new Date(),\n        tags: ['性能', '响应时间'],\n        autoActionable: false\n      },\n      {\n        id: '4',\n        title: '营销ROI提升',\n        description: '最近营销活动效果显著，ROI提升25%。',\n        type: 'achievement',\n        severity: 'low',\n        category: '营销',\n        confidence: confidence4,\n        dataPoints: [\n          { label: 'roi_increase', value: confidence4, trend: 'up' }\n        ],\n        recommendations: [\n          { id: 'rec-4', text: '复制成功营销策略，扩大投放规模。', priority: 'low' }\n        ],\n        timestamp: new Date(),\n        tags: ['营销', 'ROI'],\n        autoActionable: true\n      }\n    ];\n\n    setIsAnalyzing(false);\n    \n    if (onInsightGenerated) {\n      onInsightGenerated(mockInsights);\n    }\n  }, [timeRange, selectedMetrics, onInsightGenerated]);\n\n  const toggleMetric = useCallback((metricId: string) => {\n    setSelectedMetrics(prev => \n      prev.includes(metricId) \n        ? prev.filter(id => id !== metricId)\n        : [...prev, metricId]\n    );\n  }, []);\n\n  const getAnalysisDepthLabel = useCallback((depth: string) => {\n    switch (depth) {\n      case 'basic':\n        return '基础分析 - 快速概览';\n      case 'advanced':\n        return '高级分析 - 深度洞察';\n      case 'deep':\n        return '深度分析 - AI预测';\n      default:\n        return '高级分析';\n    }\n  }, []);\n\n  const getTimeRangeLabel = useCallback((range: string) => {\n    switch (range) {\n      case '7d':\n        return '最近7天';\n      case '30d':\n        return '最近30天';\n      case '90d':\n        return '最近90天';\n      case '1y':\n        return '最近1年';\n      default:\n        return '最近30天';\n    }\n  }, []);\n\n  return (\n    <div className={cn(\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\", className)}>\n      <div className=\"flex items-center gap-3 mb-6\">\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\n          <Brain className=\"h-6 w-6 text-blue-600\" />\n        </div>\n        <div>\n          <h2 className=\"text-xl font-semibold text-gray-900\">AI洞察引擎</h2>\n          <p className=\"text-sm text-gray-600\">智能分析数据，生成业务洞察</p>\n        </div>\n      </div>\n\n      {/* 分析配置 */}\n      <div className=\"space-y-6\">\n        {/* 时间范围选择 */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n            分析时间范围\n          </label>\n          <div className=\"grid grid-cols-4 gap-3\">\n            {(['7d', '30d', '90d', '1y'] as const).map(range => (\n              <button\n                key={range}\n                onClick={() => setTimeRange(range)}\n                className={cn(\n                  \"p-3 rounded-lg border text-sm font-medium transition-colors\",\n                  timeRange === range\n                    ? \"bg-blue-600 text-white border-blue-600\"\n                    : \"bg-white text-gray-700 border-gray-300 hover:bg-gray-50\"\n                )}\n              >\n                {getTimeRangeLabel(range)}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* 分析深度 */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n            分析深度\n          </label>\n          <div className=\"space-y-3\">\n            {(['basic', 'advanced', 'deep'] as const).map(depth => (\n              <label key={depth} className=\"flex items-center cursor-pointer\">\n                <input\n                  type=\"radio\"\n                  name=\"analysisDepth\"\n                  value={depth}\n                  checked={analysisDepth === depth}\n                  onChange={(e) => setAnalysisDepth(e.target.value as any)}\n                  className=\"mr-3 text-blue-600\"\n                />\n                <div>\n                  <div className=\"font-medium text-gray-900\">\n                    {getAnalysisDepthLabel(depth)}\n                  </div>\n                  <div className=\"text-sm text-gray-600\">\n                    {depth === 'basic' && '快速生成基础洞察'}\n                    {depth === 'advanced' && '深度分析数据模式和趋势'}\n                    {depth === 'deep' && 'AI预测和高级建模'}\n                  </div>\n                </div>\n              </label>\n            ))}\n          </div>\n        </div>\n\n        {/* 指标选择 */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n            选择分析指标（可选）\n          </label>\n          <div className=\"grid grid-cols-2 gap-3\">\n            {availableMetrics.map(metric => {\n              const Icon = metric.icon;\n              return (\n                <label\n                  key={metric.id}\n                  className={cn(\n                    \"flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors\",\n                    selectedMetrics.includes(metric.id)\n                      ? \"bg-blue-50 border-blue-300\"\n                      : \"bg-white border-gray-200 hover:bg-gray-50\"\n                  )}\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedMetrics.includes(metric.id)}\n                    onChange={() => toggleMetric(metric.id)}\n                    className=\"text-blue-600\"\n                  />\n                  <Icon className=\"h-5 w-5 text-gray-600\" />\n                  <div>\n                    <div className=\"font-medium text-gray-900\">{metric.name}</div>\n                    <div className=\"text-xs text-gray-500\">{metric.category}</div>\n                  </div>\n                </label>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* 分析按钮 */}\n        <div className=\"pt-4 border-t border-gray-200\">\n          <button\n            onClick={generateInsights}\n            disabled={isAnalyzing}\n            className={cn(\n              \"w-full flex items-center justify-center gap-3 px-6 py-3 rounded-lg font-medium transition-colors\",\n              isAnalyzing\n                ? \"bg-gray-400 text-white cursor-not-allowed\"\n                : \"bg-blue-600 text-white hover:bg-blue-700\"\n            )}\n          >\n            {isAnalyzing ? (\n              <>\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\n                AI分析中...\n              </>\n            ) : (\n              <>\n                <Brain className=\"h-5 w-5\" />\n                开始AI分析\n              </>\n            )}\n          </button>\n        </div>\n\n        {/* 分析状态 */}\n        {isAnalyzing && (\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n              <div>\n                <div className=\"font-medium text-blue-900\">正在分析数据...</div>\n                <div className=\"text-sm text-blue-700 mt-1\">\n                  AI正在处理您的数据，这可能需要几秒钟时间\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* 分析说明 */}\n      <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\n        <h4 className=\"font-medium text-gray-900 mb-2\">分析说明</h4>\n        <ul className=\"text-sm text-gray-600 space-y-1\">\n          <li>• 基础分析：提供数据概览和基础趋势分析</li>\n          <li>• 高级分析：深度挖掘数据模式，识别异常和机会</li>\n          <li>• 深度分析：使用AI模型进行预测和高级建模</li>\n          <li>• 选择特定指标可以获得更精准的分析结果</li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n\nexport default AIInsightEngine;"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;;;AALA;;;;AAYO,SAAS,gBAAgB,EAC9B,SAAS,EACT,kBAAkB,EACG;;IACrB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,mTAAQ,EAAC;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,mTAAQ,EAAW,EAAE;IACnE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,mTAAQ,EAAgC;IAClF,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,mTAAQ,EAA8B;IAExE,MAAM,mBAAmB,IAAA,kTAAO;qDAAC;YAC/B,OAAO;gBACL;oBAAE,IAAI;oBAAW,MAAM;oBAAM,MAAM,kUAAU;oBAAE,UAAU;gBAAK;gBAC9D;oBAAE,IAAI;oBAAS,MAAM;oBAAM,MAAM,+SAAK;oBAAE,UAAU;gBAAK;gBACvD;oBAAE,IAAI;oBAAc,MAAM;oBAAO,MAAM,ySAAG;oBAAE,UAAU;gBAAK;gBAC3D;oBAAE,IAAI;oBAAc,MAAM;oBAAO,MAAM,kTAAM;oBAAE,UAAU;gBAAK;gBAC9D;oBAAE,IAAI;oBAAa,MAAM;oBAAO,MAAM,4UAAW;oBAAE,UAAU;gBAAK;gBAClE;oBAAE,IAAI;oBAAe,MAAM;oBAAM,MAAM,+SAAK;oBAAE,UAAU;gBAAK;aAC9D;QACH;oDAAG,EAAE;IAEL,MAAM,mBAAmB,IAAA,sTAAW;yDAAC;YACnC,eAAe;YAEf,WAAW;YACX,MAAM,IAAI;iEAAQ,CAAA,UAAW,WAAW,SAAS;;YAEjD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;YACpD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;YACpD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;YACpD,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK;YAEpD,MAAM,eAA+B;gBACnC;oBACE,IAAI;oBACJ,OAAO;oBACP,aAAa,CAAC,EAAE,EAAE,cAAc,OAAO,OAAO,cAAc,QAAQ,QAAQ,cAAc,QAAQ,QAAQ,KAAK,OAAO,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,KAAK,GAAG,SAAS,CAAC;oBACrK,MAAM;oBACN,UAAU;oBACV,UAAU;oBACV,YAAY;oBACZ,YAAY;wBACV;4BAAE,OAAO;4BAAiB,OAAO;4BAAa,OAAO;wBAAO;qBAC7D;oBACD,iBAAiB;wBACf;4BAAE,IAAI;4BAAS,MAAM;4BAA6B,UAAU;wBAAO;qBACpE;oBACD,WAAW,IAAI;oBACf,MAAM;wBAAC;wBAAM;qBAAK;oBAClB,gBAAgB;gBAClB;gBACA;oBACE,IAAI;oBACJ,OAAO;oBACP,aAAa;oBACb,MAAM;oBACN,UAAU;oBACV,UAAU;oBACV,YAAY;oBACZ,YAAY;wBACV;4BAAE,OAAO;4BAAyB,OAAO;4BAAa,OAAO;wBAAK;qBACnE;oBACD,iBAAiB;wBACf;4BAAE,IAAI;4BAAS,MAAM;4BAA0B,UAAU;wBAAS;qBACnE;oBACD,WAAW,IAAI;oBACf,MAAM;wBAAC;wBAAM;qBAAK;oBAClB,gBAAgB;gBAClB;gBACA;oBACE,IAAI;oBACJ,OAAO;oBACP,aAAa;oBACb,MAAM;oBACN,UAAU;oBACV,UAAU;oBACV,YAAY;oBACZ,YAAY;wBACV;4BAAE,OAAO;4BAAoB,OAAO;4BAAa,OAAO;wBAAK;qBAC9D;oBACD,iBAAiB;wBACf;4BAAE,IAAI;4BAAS,MAAM;4BAA2B,UAAU;wBAAS;qBACpE;oBACD,WAAW,IAAI;oBACf,MAAM;wBAAC;wBAAM;qBAAO;oBACpB,gBAAgB;gBAClB;gBACA;oBACE,IAAI;oBACJ,OAAO;oBACP,aAAa;oBACb,MAAM;oBACN,UAAU;oBACV,UAAU;oBACV,YAAY;oBACZ,YAAY;wBACV;4BAAE,OAAO;4BAAgB,OAAO;4BAAa,OAAO;wBAAK;qBAC1D;oBACD,iBAAiB;wBACf;4BAAE,IAAI;4BAAS,MAAM;4BAAoB,UAAU;wBAAM;qBAC1D;oBACD,WAAW,IAAI;oBACf,MAAM;wBAAC;wBAAM;qBAAM;oBACnB,gBAAgB;gBAClB;aACD;YAED,eAAe;YAEf,IAAI,oBAAoB;gBACtB,mBAAmB;YACrB;QACF;wDAAG;QAAC;QAAW;QAAiB;KAAmB;IAEnD,MAAM,eAAe,IAAA,sTAAW;qDAAC,CAAC;YAChC;6DAAmB,CAAA,OACjB,KAAK,QAAQ,CAAC,YACV,KAAK,MAAM;qEAAC,CAAA,KAAM,OAAO;sEACzB;2BAAI;wBAAM;qBAAS;;QAE3B;oDAAG,EAAE;IAEL,MAAM,wBAAwB,IAAA,sTAAW;8DAAC,CAAC;YACzC,OAAQ;gBACN,KAAK;oBACH,OAAO;gBACT,KAAK;oBACH,OAAO;gBACT,KAAK;oBACH,OAAO;gBACT;oBACE,OAAO;YACX;QACF;6DAAG,EAAE;IAEL,MAAM,oBAAoB,IAAA,sTAAW;0DAAC,CAAC;YACrC,OAAQ;gBACN,KAAK;oBACH,OAAO;gBACT,KAAK;oBACH,OAAO;gBACT,KAAK;oBACH,OAAO;gBACT,KAAK;oBACH,OAAO;gBACT;oBACE,OAAO;YACX;QACF;yDAAG,EAAE;IAEL,qBACE,uUAAC;QAAI,WAAW,IAAA,uIAAE,EAAC,4DAA4D;;0BAC7E,uUAAC;gBAAI,WAAU;;kCACb,uUAAC;wBAAI,WAAU;kCACb,cAAA,uUAAC,+SAAK;4BAAC,WAAU;;;;;;;;;;;kCAEnB,uUAAC;;0CACC,uUAAC;gCAAG,WAAU;0CAAsC;;;;;;0CACpD,uUAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;;;;;;;0BAKzC,uUAAC;gBAAI,WAAU;;kCAEb,uUAAC;;0CACC,uUAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,uUAAC;gCAAI,WAAU;0CACZ,AAAC;oCAAC;oCAAM;oCAAO;oCAAO;iCAAK,CAAW,GAAG,CAAC,CAAA,sBACzC,uUAAC;wCAEC,SAAS,IAAM,aAAa;wCAC5B,WAAW,IAAA,uIAAE,EACX,+DACA,cAAc,QACV,2CACA;kDAGL,kBAAkB;uCATd;;;;;;;;;;;;;;;;kCAgBb,uUAAC;;0CACC,uUAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,uUAAC;gCAAI,WAAU;0CACZ,AAAC;oCAAC;oCAAS;oCAAY;iCAAO,CAAW,GAAG,CAAC,CAAA,sBAC5C,uUAAC;wCAAkB,WAAU;;0DAC3B,uUAAC;gDACC,MAAK;gDACL,MAAK;gDACL,OAAO;gDACP,SAAS,kBAAkB;gDAC3B,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;gDAChD,WAAU;;;;;;0DAEZ,uUAAC;;kEACC,uUAAC;wDAAI,WAAU;kEACZ,sBAAsB;;;;;;kEAEzB,uUAAC;wDAAI,WAAU;;4DACZ,UAAU,WAAW;4DACrB,UAAU,cAAc;4DACxB,UAAU,UAAU;;;;;;;;;;;;;;uCAhBf;;;;;;;;;;;;;;;;kCAyBlB,uUAAC;;0CACC,uUAAC;gCAAM,WAAU;0CAA+C;;;;;;0CAGhE,uUAAC;gCAAI,WAAU;0CACZ,iBAAiB,GAAG,CAAC,CAAA;oCACpB,MAAM,OAAO,OAAO,IAAI;oCACxB,qBACE,uUAAC;wCAEC,WAAW,IAAA,uIAAE,EACX,kFACA,gBAAgB,QAAQ,CAAC,OAAO,EAAE,IAC9B,+BACA;;0DAGN,uUAAC;gDACC,MAAK;gDACL,SAAS,gBAAgB,QAAQ,CAAC,OAAO,EAAE;gDAC3C,UAAU,IAAM,aAAa,OAAO,EAAE;gDACtC,WAAU;;;;;;0DAEZ,uUAAC;gDAAK,WAAU;;;;;;0DAChB,uUAAC;;kEACC,uUAAC;wDAAI,WAAU;kEAA6B,OAAO,IAAI;;;;;;kEACvD,uUAAC;wDAAI,WAAU;kEAAyB,OAAO,QAAQ;;;;;;;;;;;;;uCAjBpD,OAAO,EAAE;;;;;gCAqBpB;;;;;;;;;;;;kCAKJ,uUAAC;wBAAI,WAAU;kCACb,cAAA,uUAAC;4BACC,SAAS;4BACT,UAAU;4BACV,WAAW,IAAA,uIAAE,EACX,oGACA,cACI,8CACA;sCAGL,4BACC;;kDACE,uUAAC;wCAAI,WAAU;;;;;;oCAAkE;;6DAInF;;kDACE,uUAAC,+SAAK;wCAAC,WAAU;;;;;;oCAAY;;;;;;;;;;;;;oBAQpC,6BACC,uUAAC;wBAAI,WAAU;kCACb,cAAA,uUAAC;4BAAI,WAAU;;8CACb,uUAAC;oCAAI,WAAU;;;;;;8CACf,uUAAC;;sDACC,uUAAC;4CAAI,WAAU;sDAA4B;;;;;;sDAC3C,uUAAC;4CAAI,WAAU;sDAA6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAUtD,uUAAC;gBAAI,WAAU;;kCACb,uUAAC;wBAAG,WAAU;kCAAiC;;;;;;kCAC/C,uUAAC;wBAAG,WAAU;;0CACZ,uUAAC;0CAAG;;;;;;0CACJ,uUAAC;0CAAG;;;;;;0CACJ,uUAAC;0CAAG;;;;;;0CACJ,uUAAC;0CAAG;;;;;;;;;;;;;;;;;;;;;;;;AAKd;GAlTgB;KAAA;uCAoTD","debugId":null}},
    {"offset": {"line": 5642, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/hooks/useSmartDashboard.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { \n  DashboardWidget, \n  DashboardLayout, \n  DashboardData, \n  SmartInsight,\n  ChartData,\n  MetricData,\n  TableData \n} from '@/app/lib/dashboard/types';\nimport {\n  generateChartData,\n  generateMetricData,\n  generateTableData,\n  generateSmartInsights,\n  generateRealtimeUpdate\n} from '@/app/lib/dashboard/data-generator';\n\ninterface UseSmartDashboardProps {\n  layoutId?: string;\n  autoRefresh?: boolean;\n  refreshInterval?: number;\n  enableInsights?: boolean;\n  enableRealtime?: boolean;\n}\n\ninterface UseSmartDashboardReturn {\n  layout: DashboardLayout | null;\n  data: DashboardData;\n  insights: SmartInsight[];\n  loading: boolean;\n  error: string | null;\n  refresh: () => Promise<void>;\n  updateWidget: (widgetId: string, data: any) => void;\n  updateLayout: (layout: DashboardLayout) => void;\n  refreshWidget: (widgetId: string) => Promise<void>;\n  exportData: (format: 'json' | 'csv' | 'pdf') => void;\n}\n\nexport function useSmartDashboard({\n  layoutId = 'default',\n  autoRefresh = true,\n  refreshInterval = 30000, // 30秒\n  enableInsights = true,\n  enableRealtime = true\n}: UseSmartDashboardProps): UseSmartDashboardReturn {\n  const [layout, setLayout] = useState<DashboardLayout | null>(null);\n  const [data, setData] = useState<DashboardData>({\n    widgets: {},\n    metadata: {\n      lastUpdated: new Date(),\n      refreshStatus: {},\n      totalWidgets: 0,\n      activeWidgets: 0\n    }\n  });\n  const [insights, setInsights] = useState<SmartInsight[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const refreshIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const realtimeIntervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  // 生成默认布局\n  const generateDefaultLayout = useCallback((): DashboardLayout => {\n    return {\n      id: 'default',\n      name: '智能仪表板',\n      description: 'AI驱动的智能数据仪表板',\n      widgets: [\n        {\n          id: 'revenue-chart',\n          type: 'chart',\n          title: '收入趋势',\n          dataSource: 'revenue',\n          config: {\n            chartType: 'line',\n            colorScheme: ['#3B82F6', '#10B981'],\n            showLegend: true,\n            showGrid: true,\n            animation: true\n          },\n          size: 'large',\n          position: { x: 0, y: 0, w: 8, h: 4 },\n          refreshInterval: 30000,\n          interactive: true\n        },\n        {\n          id: 'active-users',\n          type: 'metric',\n          title: '活跃用户',\n          dataSource: 'users',\n          config: {\n            colorScheme: ['#3B82F6'],\n            customStyles: { format: 'number', showTrend: true }\n          },\n          size: 'small',\n          position: { x: 8, y: 0, w: 4, h: 2 },\n          refreshInterval: 15000\n        },\n        {\n          id: 'engagement-rate',\n          type: 'metric',\n          title: '学习参与度',\n          dataSource: 'engagement',\n          config: {\n            colorScheme: ['#10B981'],\n            customStyles: { format: 'percentage', showTrend: true }\n          },\n          size: 'small',\n          position: { x: 8, y: 2, w: 4, h: 2 },\n          refreshInterval: 15000\n        },\n        {\n          id: 'top-courses',\n          type: 'table',\n          title: '热门课程',\n          dataSource: 'courses',\n          config: {\n            customStyles: { showPagination: true, pageSize: 5, enableSorting: true }\n          },\n          size: 'medium',\n          position: { x: 0, y: 4, w: 6, h: 6 },\n          refreshInterval: 60000\n        },\n        {\n          id: 'learning-progress',\n          type: 'progress',\n          title: '学习进度',\n          dataSource: 'progress',\n          config: {\n            colorScheme: ['#F59E0B', '#10B981', '#3B82F6'],\n            customStyles: { showPercentage: true }\n          },\n          size: 'medium',\n          position: { x: 6, y: 4, w: 6, h: 6 },\n          refreshInterval: 30000\n        }\n      ],\n      gridConfig: {\n        cols: 12,\n        rowHeight: 80,\n        margin: [16, 16],\n        containerPadding: [0, 0]\n      },\n      theme: 'light',\n      breakpoints: {\n        lg: 1200,\n        md: 996,\n        sm: 768,\n        xs: 480,\n        xxs: 0\n      },\n      layouts: {\n        lg: [],\n        md: [],\n        sm: [],\n        xs: [],\n        xxs: []\n      }\n    };\n  }, []);\n\n  // 获取组件数据\n  const fetchWidgetData = useCallback(async (widget: DashboardWidget): Promise<any> => {\n    try {\n      switch (widget.type) {\n        case 'chart':\n          return generateChartData((() => {\n            const ct = widget.config?.chartType;\n            const safeCt: 'line' | 'bar' | 'pie' | 'area' =\n              ct === 'line' || ct === 'bar' || ct === 'pie' || ct === 'area' ? ct : 'line';\n            return safeCt;\n          })());\n        \n        case 'metric':\n          return generateMetricData(widget.dataSource as any);\n        \n        case 'table':\n          return generateTableData(widget.dataSource as any);\n        \n        case 'progress':\n          return {\n            total: 100,\n            completed: Math.floor(Math.random() * 100),\n            inProgress: Math.floor(Math.random() * 50),\n            notStarted: Math.floor(Math.random() * 30)\n          };\n        \n        case 'activity':\n          return Array.from({ length: 10 }, (_, i) => ({\n            id: `activity-${i}`,\n            user: `用户${Math.floor(Math.random() * 100) + 1}`,\n            action: ['开始学习', '完成课程', '发表评论', '获得证书'][Math.floor(Math.random() * 4)],\n            timestamp: new Date(Date.now() - Math.random() * 86400000)\n          }));\n        \n        case 'calendar':\n          return {\n            events: Array.from({ length: 20 }, (_, i) => ({\n              id: `event-${i}`,\n              title: `学习活动 ${i + 1}`,\n              date: new Date(Date.now() + Math.random() * 86400000 * 30),\n              type: ['课程', '考试', '讨论', '项目'][Math.floor(Math.random() * 4)]\n            }))\n          };\n        \n        default:\n          return {};\n      }\n    } catch (error) {\n      console.error(`Failed to fetch data for widget ${widget.id}:`, error);\n      throw error;\n    }\n  }, []);\n\n  // 刷新所有数据\n  const refreshData = useCallback(async () => {\n    if (!layout) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const widgetData: Record<string, any> = {};\n      const refreshStatus: Record<string, 'loading' | 'success' | 'error'> = {};\n\n      // 并行获取所有组件数据\n      const dataPromises = layout.widgets.map(async (widget) => {\n        refreshStatus[widget.id] = 'loading';\n        try {\n          const data = await fetchWidgetData(widget);\n          widgetData[widget.id] = data;\n          refreshStatus[widget.id] = 'success';\n        } catch (error) {\n          refreshStatus[widget.id] = 'error';\n          console.error(`Error refreshing widget ${widget.id}:`, error);\n        }\n      });\n\n      await Promise.all(dataPromises);\n\n      // 生成智能洞察\n      if (enableInsights) {\n        const newInsights = generateSmartInsights(5);\n        setInsights(newInsights);\n      }\n\n      setData({\n        widgets: widgetData,\n        metadata: {\n          lastUpdated: new Date(),\n          refreshStatus,\n          totalWidgets: layout.widgets.length,\n          activeWidgets: Object.values(refreshStatus).filter(status => status === 'success').length\n        }\n      });\n\n    } catch (error) {\n      setError(error instanceof Error ? error.message : '获取仪表板数据失败');\n      console.error('Failed to refresh dashboard data:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [layout, enableInsights, fetchWidgetData]);\n\n  // 刷新单个组件\n  const refreshWidget = useCallback(async (widgetId: string) => {\n    if (!layout) return;\n\n    const widget = layout.widgets.find(w => w.id === widgetId);\n    if (!widget) return;\n\n    try {\n      setData(prev => ({\n        ...prev,\n        metadata: {\n          ...prev.metadata,\n          refreshStatus: {\n            ...prev.metadata.refreshStatus,\n            [widgetId]: 'loading'\n          }\n        }\n      }));\n\n      const widgetData = await fetchWidgetData(widget);\n\n      setData(prev => ({\n        ...prev,\n        widgets: {\n          ...prev.widgets,\n          [widgetId]: widgetData\n        },\n        metadata: {\n          ...prev.metadata,\n          refreshStatus: {\n            ...prev.metadata.refreshStatus,\n            [widgetId]: 'success'\n          },\n          lastUpdated: new Date()\n        }\n      }));\n\n    } catch (error) {\n      setData(prev => ({\n        ...prev,\n        metadata: {\n          ...prev.metadata,\n          refreshStatus: {\n            ...prev.metadata.refreshStatus,\n            [widgetId]: 'error'\n          }\n        }\n      }));\n      console.error(`Failed to refresh widget ${widgetId}:`, error);\n    }\n  }, [layout, fetchWidgetData]);\n\n  // 更新组件数据\n  const updateWidget = useCallback((widgetId: string, newData: any) => {\n    setData(prev => ({\n      ...prev,\n      widgets: {\n        ...prev.widgets,\n        [widgetId]: newData\n      }\n    }));\n  }, []);\n\n  // 更新布局\n  const updateLayout = useCallback((newLayout: DashboardLayout) => {\n    setLayout(newLayout);\n  }, []);\n\n  // 导出数据\n  const exportData = useCallback((format: 'json' | 'csv' | 'pdf') => {\n    const dataToExport = {\n      layout,\n      data,\n      insights,\n      exportedAt: new Date()\n    };\n\n    switch (format) {\n      case 'json':\n        const jsonBlob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });\n        const jsonUrl = URL.createObjectURL(jsonBlob);\n        const jsonLink = document.createElement('a');\n        jsonLink.href = jsonUrl;\n        jsonLink.download = `dashboard-data-${new Date().toISOString()}.json`;\n        jsonLink.click();\n        break;\n      \n      case 'csv':\n        // 简化的CSV导出，实际项目中需要更复杂的逻辑\n        const csvData = Object.entries(data.widgets).map(([key, value]) => ({\n          widget: key,\n          data: JSON.stringify(value)\n        }));\n        const csvContent = \"data:text/csv;charset=utf-8,\" + \n          \"Widget,Data\\n\" + \n          csvData.map(row => `\"${row.widget}\",\"${row.data}\"`).join(\"\\n\");\n        const csvLink = document.createElement('a');\n        csvLink.href = encodeURI(csvContent);\n        csvLink.download = `dashboard-data-${new Date().toISOString()}.csv`;\n        csvLink.click();\n        break;\n      \n      case 'pdf':\n        // 这里需要集成PDF生成库，如jsPDF\n        console.log('PDF export would be implemented here');\n        break;\n    }\n  }, [layout, data, insights]);\n\n  // 初始化\n  useEffect(() => {\n    const initDashboard = async () => {\n      try {\n        setLoading(true);\n        \n        // 生成默认布局\n        const defaultLayout = generateDefaultLayout();\n        setLayout(defaultLayout);\n        \n        // 初始数据加载\n        await refreshData();\n        \n      } catch (error) {\n        setError(error instanceof Error ? error.message : '初始化仪表板失败');\n        console.error('Failed to initialize dashboard:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    initDashboard();\n  }, []);\n\n  // 自动刷新\n  useEffect(() => {\n    if (!autoRefresh) return;\n\n    // 清除现有定时器\n    if (refreshIntervalRef.current) {\n      clearInterval(refreshIntervalRef.current);\n    }\n\n    // 设置新的定时器\n    refreshIntervalRef.current = setInterval(() => {\n      refreshData();\n    }, refreshInterval);\n\n    return () => {\n      if (refreshIntervalRef.current) {\n        clearInterval(refreshIntervalRef.current);\n      }\n    };\n  }, [autoRefresh, refreshInterval, refreshData]);\n\n  // 实时更新\n  useEffect(() => {\n    if (!enableRealtime) return;\n\n    if (realtimeIntervalRef.current) {\n      clearInterval(realtimeIntervalRef.current);\n    }\n\n    realtimeIntervalRef.current = setInterval(() => {\n      const update = generateRealtimeUpdate();\n      \n      // 更新对应组件的数据\n      setData(prev => {\n        const currentWidgetData = prev.widgets[update.metric];\n        if (currentWidgetData) {\n          return {\n            ...prev,\n            widgets: {\n              ...prev.widgets,\n              [update.metric]: update.data\n            }\n          };\n        }\n        return prev;\n      });\n    }, 5000); // 5秒更新一次\n\n    return () => {\n      if (realtimeIntervalRef.current) {\n        clearInterval(realtimeIntervalRef.current);\n      }\n    };\n  }, [enableRealtime]);\n\n  return {\n    layout,\n    data,\n    insights,\n    loading,\n    error,\n    refresh: refreshData,\n    updateWidget,\n    updateLayout,\n    refreshWidget,\n    exportData\n  };\n}\n\n// 演示用的Hook\nexport function useDemoDashboard() {\n  return useSmartDashboard({\n    layoutId: 'demo',\n    autoRefresh: true,\n    refreshInterval: 30000,\n    enableInsights: true,\n    enableRealtime: true\n  });\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6198, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/dashboard/analytics/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { ModularDashboardBuilder } from '@/app/components/ModularDashboardBuilder';\nimport { AIInsightEngine } from '@/app/components/AIInsightEngine';\nimport { useSmartDashboard } from '@/app/hooks/useSmartDashboard';\n\nexport default function AnalyticsDashboard() {\n  const [activeTab, setActiveTab] = useState<'dashboard' | 'insights'>('dashboard');\n  const { layout, data, loading, error, refresh, updateLayout } = useSmartDashboard({\n    layoutId: 'demo',\n    autoRefresh: activeTab === 'dashboard',\n    refreshInterval: 30000,\n    enableInsights: true,\n    enableRealtime: activeTab === 'dashboard'\n  });\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">智能数据分析仪表板</h1>\n          <p className=\"text-gray-600\">实时监控学习进度，获取AI驱动的业务洞察</p>\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"mb-6\">\n          <nav className=\"flex space-x-1 bg-white rounded-lg p-1 shadow-sm\">\n            <button\n              onClick={() => setActiveTab('dashboard')}\n              className={`px-4 py-2 rounded-md font-medium transition-colors ${\n                activeTab === 'dashboard'\n                  ? 'bg-blue-500 text-white'\n                  : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'\n              }`}\n            >\n              仪表板\n            </button>\n            <button\n              onClick={() => setActiveTab('insights')}\n              className={`px-4 py-2 rounded-md font-medium transition-colors ${\n                activeTab === 'insights'\n                  ? 'bg-blue-500 text-white'\n                  : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'\n              }`}\n            >\n              AI洞察\n            </button>\n          </nav>\n        </div>\n\n        {/* Content */}\n        {activeTab === 'dashboard' && (\n          <div className=\"space-y-6\">\n            {/* Dashboard Stats */}\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">总访问量</div>\n                <div className=\"text-2xl font-bold text-gray-900\">12,543</div>\n                <div className=\"text-sm text-green-600\">+12.5%</div>\n              </div>\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">活跃用户</div>\n                <div className=\"text-2xl font-bold text-gray-900\">3,247</div>\n                <div className=\"text-sm text-green-600\">+8.2%</div>\n              </div>\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">课程完成率</div>\n                <div className=\"text-2xl font-bold text-gray-900\">78.3%</div>\n                <div className=\"text-sm text-blue-600\">+3.1%</div>\n              </div>\n              <div className=\"bg-white p-4 rounded-lg shadow-sm border\">\n                <div className=\"text-sm font-medium text-gray-500 mb-1\">平均学习时长</div>\n                <div className=\"text-2xl font-bold text-gray-900\">2.4h</div>\n                <div className=\"text-sm text-red-600\">-5.3%</div>\n              </div>\n            </div>\n\n            {/* Modular Dashboard Builder */}\n            {layout ? (\n              <ModularDashboardBuilder\n                layout={layout}\n                widgets={layout.widgets}\n                onLayoutChange={(newLayout) => updateLayout(newLayout)}\n                onWidgetAdd={(widget) => {\n                  const current = layout.widgets || [];\n                  updateLayout({ ...layout, widgets: [...current, widget] });\n                }}\n                onWidgetRemove={(widgetId) => {\n                  const current = layout.widgets || [];\n                  updateLayout({ ...layout, widgets: current.filter(w => w.id !== widgetId) });\n                }}\n                onWidgetUpdate={(widgetId, updates) => {\n                  const current = layout.widgets || [];\n                  updateLayout({ ...layout, widgets: current.map(w => w.id === widgetId ? { ...w, ...updates } : w) });\n                }}\n              />\n            ) : (\n              <div className=\"bg-white rounded-lg shadow-sm border p-6 text-center text-gray-600\">正在初始化仪表板...</div>\n            )}\n          </div>\n        )}\n\n        {activeTab === 'insights' && (\n          <div className=\"space-y-6\">\n            <AIInsightEngine />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}