{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/funds/%5Bcode%5D/page.tsx"],"sourcesContent":["async function fetchFund(code: string) {\n  try {\n    const res = await fetch(`/api/funds/${code}`, { cache: 'no-store' });\n    if (res?.ok) return res.json();\n  } catch {}\n  try {\n    const origin = process.env.NEXT_PUBLIC_BASE_URL ?? (process.env.VERCEL_URL ? `https://${process.env.VERCEL_URL}` : `http://localhost:${process.env.PORT ?? '3000'}`);\n    const res2 = await fetch(`${origin}/api/funds/${code}`, { cache: 'no-store' });\n    if (res2?.ok) return res2.json();\n  } catch {}\n  return null;\n}\n\nasync function fetchPingzhongSeries(code: string): Promise<Array<{ date: string; value: number }>> {\n  try {\n    const url = `http://fund.eastmoney.com/pingzhongdata/${code}.js`;\n    const res = await fetch(url, { cache: 'no-store' });\n    if (!res.ok) return [];\n    const js = await res.text();\n    const trendMatch = js.match(/var\\s+Data_netWorthTrend\\s*=\\s*(\\[[\\s\\S]*?\\]);/);\n    if (!trendMatch) return [];\n    const arr = JSON.parse(trendMatch[1]);\n    return arr\n      .map((p: any) => ({ date: p?.x ? new Date(p.x).toISOString().slice(0, 10) : '', value: typeof p?.y === 'number' ? p.y : null }))\n      .filter((d: any) => d.value != null && d.date);\n  } catch {\n    return [];\n  }\n}\n\nfunction buildLinePath(series: Array<{ date: string; value: number }>, width: number, height: number, padding: number) {\n  const n = series.length;\n  if (n === 0) return '';\n  const values = series.map((s) => s.value);\n  const min = Math.min(...values);\n  const max = Math.max(...values);\n  const w = width - padding * 2;\n  const h = height - padding * 2;\n  const norm = (v: number) => (max === min ? 0.5 : (v - min) / (max - min));\n  let d = '';\n  series.forEach((s, i) => {\n    const x = padding + (n === 1 ? w / 2 : (i / (n - 1)) * w);\n    const y = padding + (1 - norm(s.value)) * h;\n    d += `${i === 0 ? 'M' : 'L'}${x},${y} `;\n  });\n  return d.trim();\n}\n\nexport default async function FundDetailPage(props: { params: Promise<{ code: string }> }) {\n  const { code } = await props.params;\n  const data = await fetchFund(code);\n  const info = data?.data?.[0] ?? null;\n  let series: Array<{ date: string; value: number }> = Array.isArray(data?.series) ? data.series : [];\n  if (!series || series.length === 0) {\n    series = await fetchPingzhongSeries(code);\n  }\n  const trimmed = series.slice(Math.max(0, series.length - 180));\n  const path = buildLinePath(trimmed, 800, 240, 24);\n  const min = trimmed.length ? Math.min(...trimmed.map((s) => s.value)) : null;\n  const max = trimmed.length ? Math.max(...trimmed.map((s) => s.value)) : null;\n  const startDate = trimmed[0]?.date ?? null;\n  const endDate = trimmed[trimmed.length - 1]?.date ?? null;\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold mb-4\">基金详情</h1>\n      {!info ? (\n        <div className=\"text-gray-600\">暂无数据</div>\n      ) : (\n        <div className=\"bg-white border rounded-lg p-4 space-y-2\">\n          <div>代码：{info.code}</div>\n          <div>名称：{info.name}</div>\n          <div>类型：{info.type}</div>\n          <div>净值：{info.netWorth}（{info.netWorthDate}）</div>\n          <div>日涨跌：{info.dayGrowth}%</div>\n          <div>近一月：{info.lastMonthGrowth}%，近三月：{info.lastThreeMonthsGrowth}%，近一年：{info.lastYearGrowth}%</div>\n          <div>基金公司：{info.company}</div>\n        </div>\n      )}\n      <div className=\"bg-white border rounded-lg p-4 mt-6\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <div className=\"text-lg font-semibold\">净值走势</div>\n          <div className=\"text-xs text-gray-500\">{startDate ?? '-'} 至 {endDate ?? '-'}</div>\n        </div>\n        {trimmed.length === 0 ? (\n          <div className=\"text-gray-500\">暂无走势数据</div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <svg width=\"100%\" viewBox=\"0 0 800 240\" preserveAspectRatio=\"none\">\n              <defs>\n                <linearGradient id=\"areaFill\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"1\">\n                  <stop offset=\"0%\" stopColor=\"#60a5fa\" stopOpacity=\"0.25\" />\n                  <stop offset=\"100%\" stopColor=\"#60a5fa\" stopOpacity=\"0\" />\n                </linearGradient>\n              </defs>\n              <rect x=\"0\" y=\"0\" width=\"800\" height=\"240\" fill=\"white\" />\n              <path d={path} fill=\"none\" stroke=\"#2563eb\" strokeWidth=\"2\" />\n              {/* simple area fill */}\n              <path d={`${path} L 776,216 L 24,216 Z`} fill=\"url(#areaFill)\" />\n              {/* axes */}\n              <line x1=\"24\" y1=\"216\" x2=\"776\" y2=\"216\" stroke=\"#e5e7eb\" />\n              <line x1=\"24\" y1=\"24\" x2=\"24\" y2=\"216\" stroke=\"#e5e7eb\" />\n              {/* labels */}\n              <text x=\"28\" y=\"36\" fontSize=\"10\" fill=\"#6b7280\">高 {max ?? '-'} </text>\n              <text x=\"28\" y=\"212\" fontSize=\"10\" fill=\"#6b7280\">低 {min ?? '-'} </text>\n              <text x=\"24\" y=\"232\" fontSize=\"10\" fill=\"#6b7280\">{startDate ?? ''}</text>\n              <text x=\"736\" y=\"232\" fontSize=\"10\" fill=\"#6b7280\" textAnchor=\"end\">{endDate ?? ''}</text>\n            </svg>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}