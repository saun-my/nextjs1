{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/saunmy/Desktop/nextjs1/nextjs1/app/api/learning/courses/route.ts"],"sourcesContent":["'use server';\n\nimport postgres from 'postgres';\nimport { NextRequest } from 'next/server';\n\nconst sql = postgres(process.env.POSTGRES_URL || process.env.POSTGRES_URL_NON_POOLING!, {\n  ssl: process.env.POSTGRES_SSL === 'require' ? 'require' : undefined,\n});\n\nexport async function GET(req: NextRequest) {\n  try {\n    const { searchParams } = new URL(req.url);\n    const q = (searchParams.get('q') || '').toLowerCase();\n    const rows = await sql`\n      SELECT id, title, level, description, cover_url, lessons_count\n      FROM courses\n    `;\n    const filtered = rows.filter((c: any) => {\n      if (!q) return true;\n      return (\n        c.title.toLowerCase().includes(q) ||\n        c.level.toLowerCase().includes(q) ||\n        c.description.toLowerCase().includes(q)\n      );\n    });\n    return Response.json(filtered);\n  } catch (error) {\n    return Response.json({ error: (error as Error).message }, { status: 500 });\n  }\n}\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json();\n    const { id, title, level, description, cover_url, lessons_count, estimated_hours, difficulty_score, tags } = body;\n    if (!id || !title || !level || !description || !lessons_count || !estimated_hours || !difficulty_score) {\n      return Response.json({ error: 'missing fields' }, { status: 400 });\n    }\n    await sql`\n      INSERT INTO courses (id, title, level, description, cover_url, lessons_count, estimated_hours, difficulty_score, tags)\n      VALUES (${id}, ${title}, ${level}, ${description}, ${cover_url ?? null}, ${lessons_count}, ${estimated_hours}, ${difficulty_score}, ${sql.array(tags ?? [])})\n      ON CONFLICT (id) DO NOTHING\n    `;\n    return Response.json({ ok: true });\n  } catch (error) {\n    return Response.json({ error: (error as Error).message }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;;;;AAEA;;;;AAGA,MAAM,MAAM,IAAA,qNAAQ,EAAC,QAAQ,GAAG,CAAC,YAAY,IAAI,QAAQ,GAAG,CAAC,wBAAwB,EAAG;IACtF,KAAK,QAAQ,GAAG,CAAC,YAAY,KAAK,YAAY,YAAY;AAC5D;AAEO,eAAe,IAAI,GAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;QACxC,MAAM,IAAI,CAAC,aAAa,GAAG,CAAC,QAAQ,EAAE,EAAE,WAAW;QACnD,MAAM,OAAO,MAAM,GAAG,CAAC;;;IAGvB,CAAC;QACD,MAAM,WAAW,KAAK,MAAM,CAAC,CAAC;YAC5B,IAAI,CAAC,GAAG,OAAO;YACf,OACE,EAAE,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,MAC/B,EAAE,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,MAC/B,EAAE,WAAW,CAAC,WAAW,GAAG,QAAQ,CAAC;QAEzC;QACA,OAAO,SAAS,IAAI,CAAC;IACvB,EAAE,OAAO,OAAO;QACd,OAAO,SAAS,IAAI,CAAC;YAAE,OAAO,AAAC,MAAgB,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IAC1E;AACF;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,WAAW,EAAE,SAAS,EAAE,aAAa,EAAE,eAAe,EAAE,gBAAgB,EAAE,IAAI,EAAE,GAAG;QAC7G,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,eAAe,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,kBAAkB;YACtG,OAAO,SAAS,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QAClE;QACA,MAAM,GAAG,CAAC;;cAEA,EAAE,GAAG,EAAE,EAAE,MAAM,EAAE,EAAE,MAAM,EAAE,EAAE,YAAY,EAAE,EAAE,aAAa,KAAK,EAAE,EAAE,cAAc,EAAE,EAAE,gBAAgB,EAAE,EAAE,iBAAiB,EAAE,EAAE,IAAI,KAAK,CAAC,QAAQ,EAAE,EAAE;;IAE9J,CAAC;QACD,OAAO,SAAS,IAAI,CAAC;YAAE,IAAI;QAAK;IAClC,EAAE,OAAO,OAAO;QACd,OAAO,SAAS,IAAI,CAAC;YAAE,OAAO,AAAC,MAAgB,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IAC1E;AACF;;;IAtCsB;IAsBA;;AAtBA,2XAAA;AAsBA,2XAAA","debugId":null}}]
}